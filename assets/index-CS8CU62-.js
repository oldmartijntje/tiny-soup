var ea=Object.defineProperty;var Dn=s=>{throw TypeError(s)};var ta=(s,f,n)=>f in s?ea(s,f,{enumerable:!0,configurable:!0,writable:!0,value:n}):s[f]=n;var Te=(s,f,n)=>ta(s,typeof f!="symbol"?f+"":f,n),Gr=(s,f,n)=>f.has(s)||Dn("Cannot "+n);var O=(s,f,n)=>(Gr(s,f,"read from private field"),n?n.call(s):f.get(s)),Be=(s,f,n)=>f.has(s)?Dn("Cannot add the same private member more than once"):f instanceof WeakSet?f.add(s):f.set(s,n),Re=(s,f,n,a)=>(Gr(s,f,"write to private field"),a?a.call(s,n):f.set(s,n),n),Ie=(s,f,n)=>(Gr(s,f,"access private method"),n);var vr=(s,f,n,a)=>({set _(c){Re(s,f,c,n)},get _(){return O(s,f,a)}});(function(){const f=document.createElement("link").relList;if(f&&f.supports&&f.supports("modulepreload"))return;for(const c of document.querySelectorAll('link[rel="modulepreload"]'))a(c);new MutationObserver(c=>{for(const r of c)if(r.type==="childList")for(const e of r.addedNodes)e.tagName==="LINK"&&e.rel==="modulepreload"&&a(e)}).observe(document,{childList:!0,subtree:!0});function n(c){const r={};return c.integrity&&(r.integrity=c.integrity),c.referrerPolicy&&(r.referrerPolicy=c.referrerPolicy),c.crossOrigin==="use-credentials"?r.credentials="include":c.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function a(c){if(c.ep)return;c.ep=!0;const r=n(c);fetch(c.href,r)}})();var wr=(s=>(s[s.Production=0]="Production",s[s.Development=1]="Development",s))(wr||{});const it={gridSize:32,mqttConfig:{brokerUrl:"test.mosquitto.org",brokerPort:8081,topicBase:new Date().getUTCFullYear().toString()},usernameLength:{min:4,max:20},mode:0},ra=it.mode===wr.Development,ia=it.mode===wr.Development,na=it.mode===wr.Development;class oa{constructor(f,n){Te(this,"logger");Te(this,"stringified");this.logger=f,this.stringified=n}LogError(){return this.logger.LogError(this.stringified),this}LogDebug(){return this.logger.LogDebug(this.stringified),this}LogWarning(){return this.logger.LogWarning(this.stringified),this}LogInfo(){return this.logger.LogInfo(this.stringified),this}Log(){return this.logger.Log(this.stringified),this}PrependText(f="Hello World! "){return this.stringified=f+this.stringified,this}AppendText(f=" Hello World!"){return this.stringified=this.stringified+f,this}}class sa{constructor(f){Te(this,"context");this.context=f==null?void 0:f.constructor.name}OverrideName(f){return this.context=f.GetName(),this}StringifyObject(f){return new oa(this,JSON.stringify(f))}FormatMessage(f){return`[${new Date().toISOString()}] [${this.context}] ${f}`}LogMessage(f,n){const a=this.FormatMessage(f);switch(n){case 0:ia&&console.info(`[INFO] ${a}`);break;case 1:console.warn(`[WARNING] ${a}`);break;case 2:console.error(`[ERROR] ${a}`);break;case 3:ra&&console.log(`[LOG] ${a}`);break;case 4:na&&console.debug(`[DEBUG] ${a}`);break}}LogInfo(f="Hello World!"){this.LogMessage(f,0)}LogDebug(f="Hello World!"){this.LogMessage(f,4)}Log(f="Hello World!"){this.LogMessage(f,3)}LogWarning(f="Hello World!"){this.LogMessage(f,1)}LogError(f="Hello World!"){this.LogMessage(f,2)}}class ir{constructor(){Te(this,"_logger");Te(this,"hasBeenInitiated");this._logger=new sa(this),this.hasBeenInitiated=!1,queueMicrotask(()=>{this.onInit(),this.hasBeenInitiated=!0})}onInit(){this._logger.LogInfo("Running onInit()")}}class aa extends ir{constructor(n,a){super();Te(this,"lastFrameTime");Te(this,"accumulatedTime");Te(this,"timeStep");Te(this,"update");Te(this,"render");Te(this,"isRunning");Te(this,"rafId");Te(this,"mainLoop",n=>{if(!this.isRunning)return;let a=n-this.lastFrameTime;for(this.lastFrameTime=n,this.accumulatedTime+=a;this.accumulatedTime>=this.timeStep;)this.update(this.timeStep),this.accumulatedTime-=this.timeStep;this.render(),this.rafId=requestAnimationFrame(this.mainLoop)});this.lastFrameTime=0,this.accumulatedTime=0,this.timeStep=1e3/60,this.update=n,this.render=a,this.rafId=null,this.isRunning=!1}start(){this.isRunning||(this.isRunning=!0,this.rafId=requestAnimationFrame(this.mainLoop))}stop(){this.rafId!==null&&(cancelAnimationFrame(this.rafId),this.rafId=null),this.isRunning=!1}}var Lr=(s=>(s[s.Floor=0]="Floor",s[s.HUD=1]="HUD",s))(Lr||{}),ur=(s=>(s[s.UP=0]="UP",s[s.DOWN=1]="DOWN",s[s.LEFT=2]="LEFT",s[s.RIGHT=3]="RIGHT",s))(ur||{});class mr{constructor(f=0,n=0){Te(this,"_x");Te(this,"_y");this._x=f,this._y=n}get x(){return this._x}set x(f){this._x=f}get y(){return this._y}set y(f){this._y=f}duplicate(){return new mr(this.x,this.y)}matches(f){return this.x===f.x&&this.y===f.y}toString(){return`Vector2(${this.x}, ${this.y})`}toNeighbor(f){let n=this.x,a=this.y;switch(f){case ur.UP:a-=it.gridSize;break;case ur.DOWN:a+=it.gridSize;break;case ur.LEFT:n-=it.gridSize;break;case ur.RIGHT:n+=it.gridSize;break}if(n==this.x&&a==this.y)throw new Error("Invalid direction "+f+" for "+this.toString());return new mr(n,a)}}const Fn="0011101000110011";function Wn(s){return typeof s=="object"&&s!==null&&typeof s.text=="string"}class la extends ir{constructor(){super();Te(this,"_database",[]);Te(this,"_nextId",0);this._logger.LogInfo("Running EventHandler()")}advancedEventProtocol(n,a){return{protocol:n,text:a}}subscribe(n,a,c){return this.globalSubscribe(n,a,c,!1)}subscribeOnce(n,a,c){return this.globalSubscribe(n,a,c,!0)}globalSubscribe(n,a,c,r){let e="";Wn(n)?e=`${n.protocol}://${n.text}`:e=`${n}://${Fn}`;const i={eventProtocol:e,executeOnce:r,id:this._nextId};return this._logger.StringifyObject(i).PrependText("Subscription Added, receipt: ").Log(),this._database.push({id:this._nextId,protocol:e,caller:a,callback:c,executeOnce:r}),this._nextId++,i}unsubscribe(n){this._logger.Log(`${n.constructor.name} unsubscribed from all events.`),this._database=this._database.filter(a=>a.caller!==n)}cancel(n){this._logger.Log(`Removed subscription with the ID: ${n}`),this._database=this._database.filter(a=>a.id!==n)}emit(n,a=!1,c){let r="";Wn(n)?r=`${n.protocol}://${n.text}`:r=`${n}://${Fn}`,this._logger.StringifyObject(c).PrependText(`Emitted event '${r}', error == ${a}, with this data: `).Log(),this._database.forEach(e=>{e.protocol===r&&(e.callback({error:a,value:c}),e.executeOnce&&this.cancel(e.id))})}destroy(){}}const Qe=new la;class ua extends ir{constructor(n){super();Te(this,"position");Te(this,"children");Te(this,"parent");Te(this,"drawLayer");this.position=(n==null?void 0:n.position)??new mr(0,0),this.children=(n==null?void 0:n.children)??[],this.drawLayer=(n==null?void 0:n.drawLayer)??null,this.parent=(n==null?void 0:n.parent)??null}stepEntry(n,a){this.children.forEach(c=>c.stepEntry(n,a)),this.hasBeenInitiated||(this.hasBeenInitiated=!0,this.onInit()),this.step(n,a)}step(n,a){}draw(n,a,c){const r=a+this.position.x,e=c+this.position.y;this.drawImage(n,r,e),this.getDrawChildrenOrdered().forEach(i=>i.draw(n,r,e))}getDrawChildrenOrdered(){return[...this.children].sort((n,a)=>a.drawLayer===Lr.Floor||n.position.y>a.position.y?1:-1)}drawImage(n,a,c){}destroy(){this.children.forEach(n=>n.destroy()),this.parent&&this.parent.removeChild(this),Qe.unsubscribe(this)}addChild(n){n.parent=this,this.children.push(n)}removeChild(n){this.children=this.children.filter(a=>a!==n)}}function Ct(s,f,n){const a=s.getElementById(f);return a?(a.style.display=n,!0):!1}function Wt(s,f,n,a){const c=s.getElementById(n);return c?(c.addEventListener(f,a),!0):!1}function ha(s,f,n,a){const c=s.querySelectorAll(n);return c?(c.forEach(r=>{r.addEventListener(f,a)}),!0):!1}function ca(s,f,n){const a=s.getElementById(f);return a&&a instanceof HTMLInputElement?(a.value=n,!0):!1}var tt=(s=>(s[s.TEST=0]="TEST",s[s.ShowMobileOverlay=1]="ShowMobileOverlay",s[s.SelectedGamemode=2]="SelectedGamemode",s[s.ShowHomeMenu=3]="ShowHomeMenu",s[s.SelectMultiplayerModus=4]="SelectMultiplayerModus",s[s.MQTT_SubscribeToTopic=5]="MQTT_SubscribeToTopic",s[s.MQTT_UnSubscribe=6]="MQTT_UnSubscribe",s[s.MQTT_MESSAGE=7]="MQTT_MESSAGE",s[s.SetUsernameValue=8]="SetUsernameValue",s))(tt||{});function fa(){return(Math.floor(Math.random()*99999)+1).toString().padStart(5,"0")}class da extends ir{constructor(){super();Te(this,"_username");const n=localStorage.getItem("tiny-soup:username");this._username=n??"player"+fa()}get username(){return this._username}set username(n){this._logger.LogDebug(`Set username value to: "${n}"`),localStorage.setItem("tiny-soup:username",n),this._username=n}}const Qr=new da,$n=["constructionModal","homeModal","onlineMultiplayerSelectionModal","joinMultiplayerGameModal","hostMultiplayerGameModal"];class pa extends ir{constructor(n){super();Te(this,"_document");Te(this,"_modalMemory",{});this._document=n,$n.forEach(a=>{this._modalMemory[a]=!1})}onInit(){if(Qe.subscribe(tt.ShowMobileOverlay,this,n=>{typeof n.value=="boolean"?this.setMobileOverlay(n.value):this._logger.LogDebug(`Received Event with Protocol ${tt.ShowMobileOverlay} and the value is: ${n.value}`)}),Qe.subscribe(tt.SetUsernameValue,this,()=>{if(!ca(this._document,"usernameField",Qr.username))throw Error("Username Input field not defined.")}),!Wt(this._document,"click","gamemodeSelectButtonMultiplayerOnline",()=>{!this._modalMemory.homeMenu||!this._modalMemory.homeModal||(Qe.emit(Qe.advancedEventProtocol(tt.SelectedGamemode,"MultiplayerOnline"),!1,"MultiplayerOnline"),this.prepareShowingOfMenu(!0),this._modalMemory.onlineMultiplayerSelectionModal=!0,Ct(this._document,"onlineMultiplayerSelectionModal","block"))})||!Wt(this._document,"change","usernameField",n=>{if(!this._modalMemory.homeMenu||!this._modalMemory.onlineMultiplayerSelectionModal)return;let c=n.target.value;if(c.length>it.usernameLength.max&&(c=c.substring(0,it.usernameLength.max)),c.length<it.usernameLength.min){const r="0123456789";for(;c.length<it.usernameLength.min;)c+=r[Math.floor(Math.random()*r.length)]}Qr.username=c,Qe.emit(tt.SetUsernameValue,!1,c)})||!Wt(this._document,"click","onlineGameSelectHostMode",()=>{!this._modalMemory.homeMenu||!this._modalMemory.onlineMultiplayerSelectionModal||(Qe.emit(tt.SelectMultiplayerModus,!1,"Host"),this.prepareShowingOfMenu(!0),this._modalMemory.hostMultiplayerGameModal=!0,Ct(this._document,"hostMultiplayerGameModal","block"))})||!Wt(this._document,"click","onlineGameSelectJoinMode",()=>{!this._modalMemory.homeMenu||!this._modalMemory.onlineMultiplayerSelectionModal||(Qe.emit(tt.SelectMultiplayerModus,!1,"Join"),this.prepareShowingOfMenu(!0),this._modalMemory.joinMultiplayerGameModal=!0,Ct(this._document,"joinMultiplayerGameModal","block"))})||!Wt(this._document,"click","gamemodeSelectButtonCampaign",()=>{!this._modalMemory.homeMenu||!this._modalMemory.homeModal||Qe.emit(Qe.advancedEventProtocol(tt.SelectedGamemode,"Campaign"),!1,"Campaign")})||!Wt(this._document,"click","gamemodeSelectButtonMultiplayerOffline",()=>{!this._modalMemory.homeMenu||!this._modalMemory.homeModal||Qe.emit(Qe.advancedEventProtocol(tt.SelectedGamemode,"MultiplayerOffline"),!1,"MultiplayerOffline")})||!Wt(this._document,"click","gamemodeSelectButtonOriginal",()=>{!this._modalMemory.homeMenu||!this._modalMemory.homeModal||Qe.emit(Qe.advancedEventProtocol(tt.SelectedGamemode,"Original"),!1,"Original")}))throw Error("ID does not exist.");if(!ha(this._document,"click",".backButton",()=>{this._modalMemory.homeMenu&&(Qe.emit(tt.ShowHomeMenu,!1,!0),this.showHomeScreen(!0))}))throw Error("Unknown error, investigate me!");Qe.emit(tt.SetUsernameValue,!1,Qr.username)}setMobileOverlay(n=!0){Ct(this._document,"mobileOverlay",n?"flex":"none")}hideAllMenus(){$n.forEach(n=>{this._modalMemory[n]=!1,Ct(this._document,n,"none")})}prepareShowingOfMenu(n=!0){this.showAnyMenu(n),this.hideAllMenus()}showAnyMenu(n=!0){this._modalMemory.homeMenu=n,Ct(this._document,"homeMenu",n?"block":"none")}showHomeScreen(n=!0){this.prepareShowingOfMenu(n),this._modalMemory.homeModal=n,Ct(this._document,"homeModal",n?"block":"none")}showConstructionScreen(n=!0){this.prepareShowingOfMenu(n),this._modalMemory.constructionModal=n,Ct(this._document,"constructionModal",n?"block":"none")}}var Tn=Object.defineProperty,ga=Object.getOwnPropertyDescriptor,ma=Object.getOwnPropertyNames,ba=Object.prototype.hasOwnProperty,nt=(s,f)=>()=>(s&&(f=s(s=0)),f),be=(s,f)=>()=>(f||s((f={exports:{}}).exports,f),f.exports),nr=(s,f)=>{for(var n in f)Tn(s,n,{get:f[n],enumerable:!0})},ya=(s,f,n,a)=>{if(f&&typeof f=="object"||typeof f=="function")for(let c of ma(f))!ba.call(s,c)&&c!==n&&Tn(s,c,{get:()=>f[c],enumerable:!(a=ga(f,c))||a.enumerable});return s},Ne=s=>ya(Tn({},"__esModule",{value:!0}),s),ue=nt(()=>{}),Le={};nr(Le,{_debugEnd:()=>Ni,_debugProcess:()=>ji,_events:()=>Zi,_eventsCount:()=>en,_exiting:()=>Si,_fatalExceptions:()=>Bi,_getActiveHandles:()=>Io,_getActiveRequests:()=>Ao,_kill:()=>ki,_linkedBinding:()=>Eo,_maxListeners:()=>Xi,_preload_modules:()=>Yi,_rawDebug:()=>_i,_startProfilerIdleNotifier:()=>Di,_stopProfilerIdleNotifier:()=>Fi,_tickCallback:()=>Ui,abort:()=>Hi,addListener:()=>tn,allowedNodeEnvironmentFlags:()=>Mi,arch:()=>ai,argv:()=>hi,argv0:()=>Ki,assert:()=>ko,binding:()=>gi,chdir:()=>yi,config:()=>Ai,cpuUsage:()=>hr,cwd:()=>bi,debugPort:()=>Qi,default:()=>Rn,dlopen:()=>So,domain:()=>Ei,emit:()=>an,emitWarning:()=>pi,env:()=>ui,execArgv:()=>ci,execPath:()=>Gi,exit:()=>Pi,features:()=>xi,hasUncaughtExceptionCaptureCallback:()=>To,hrtime:()=>Tr,kill:()=>Ri,listeners:()=>Ro,memoryUsage:()=>Oi,moduleLoadList:()=>vi,nextTick:()=>_o,off:()=>nn,on:()=>_t,once:()=>rn,openStdin:()=>Ci,pid:()=>Vi,platform:()=>li,ppid:()=>zi,prependListener:()=>ln,prependOnceListener:()=>un,reallyExit:()=>Ii,release:()=>wi,removeAllListeners:()=>sn,removeListener:()=>on,resourceUsage:()=>Ti,setSourceMapsEnabled:()=>Ji,setUncaughtExceptionCaptureCallback:()=>Li,stderr:()=>$i,stdin:()=>qi,stdout:()=>Wi,title:()=>si,umask:()=>mi,uptime:()=>Oo,version:()=>fi,versions:()=>di});function On(s){throw new Error("Node.js process "+s+" is not supported by JSPM core outside of Node.js")}function wa(){!Kt||!Gt||(Kt=!1,Gt.length?mt=Gt.concat(mt):dr=-1,mt.length&&wo())}function wo(){if(!Kt){var s=setTimeout(wa,0);Kt=!0;for(var f=mt.length;f;){for(Gt=mt,mt=[];++dr<f;)Gt&&Gt[dr].run();dr=-1,f=mt.length}Gt=null,Kt=!1,clearTimeout(s)}}function _o(s){var f=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)f[n-1]=arguments[n];mt.push(new vo(s,f)),mt.length===1&&!Kt&&setTimeout(wo,0)}function vo(s,f){this.fun=s,this.array=f}function et(){}function Eo(s){On("_linkedBinding")}function So(s){On("dlopen")}function Ao(){return[]}function Io(){return[]}function ko(s,f){if(!s)throw new Error(f||"assertion error")}function To(){return!1}function Oo(){return At.now()/1e3}function Tr(s){var f=Math.floor((Date.now()-At.now())*.001),n=At.now()*.001,a=Math.floor(n)+f,c=Math.floor(n%1*1e9);return s&&(a=a-s[0],c=c-s[1],c<0&&(a--,c+=Or)),[a,c]}function _t(){return Rn}function Ro(s){return[]}var mt,Kt,Gt,dr,si,ai,li,ui,hi,ci,fi,di,pi,gi,mi,bi,yi,wi,_i,vi,Ei,Si,Ai,Ii,ki,hr,Ti,Oi,Ri,Pi,Ci,Mi,xi,Bi,Li,Ui,ji,Ni,Di,Fi,Wi,$i,qi,Hi,Vi,zi,Gi,Qi,Ki,Yi,Ji,At,Kr,Or,Xi,Zi,en,tn,rn,nn,on,sn,an,ln,un,Rn,_a=nt(()=>{ue(),ce(),he(),mt=[],Kt=!1,dr=-1,vo.prototype.run=function(){this.fun.apply(null,this.array)},si="browser",ai="x64",li="browser",ui={PATH:"/usr/bin",LANG:navigator.language+".UTF-8",PWD:"/",HOME:"/home",TMP:"/tmp"},hi=["/usr/bin/node"],ci=[],fi="v16.8.0",di={},pi=function(s,f){console.warn((f?f+": ":"")+s)},gi=function(s){On("binding")},mi=function(s){return 0},bi=function(){return"/"},yi=function(s){},wi={name:"node",sourceUrl:"",headersUrl:"",libUrl:""},_i=et,vi=[],Ei={},Si=!1,Ai={},Ii=et,ki=et,hr=function(){return{}},Ti=hr,Oi=hr,Ri=et,Pi=et,Ci=et,Mi={},xi={inspector:!1,debug:!1,uv:!1,ipv6:!1,tls_alpn:!1,tls_sni:!1,tls_ocsp:!1,tls:!1,cached_builtins:!0},Bi=et,Li=et,Ui=et,ji=et,Ni=et,Di=et,Fi=et,Wi=void 0,$i=void 0,qi=void 0,Hi=et,Vi=2,zi=1,Gi="/bin/usr/node",Qi=9229,Ki="node",Yi=[],Ji=et,At={now:typeof performance<"u"?performance.now.bind(performance):void 0,timing:typeof performance<"u"?performance.timing:void 0},At.now===void 0&&(Kr=Date.now(),At.timing&&At.timing.navigationStart&&(Kr=At.timing.navigationStart),At.now=()=>Date.now()-Kr),Or=1e9,Tr.bigint=function(s){var f=Tr(s);return typeof BigInt>"u"?f[0]*Or+f[1]:BigInt(f[0]*Or)+BigInt(f[1])},Xi=10,Zi={},en=0,tn=_t,rn=_t,nn=_t,on=_t,sn=_t,an=et,ln=_t,un=_t,Rn={version:fi,versions:di,arch:ai,platform:li,release:wi,_rawDebug:_i,moduleLoadList:vi,binding:gi,_linkedBinding:Eo,_events:Zi,_eventsCount:en,_maxListeners:Xi,on:_t,addListener:tn,once:rn,off:nn,removeListener:on,removeAllListeners:sn,emit:an,prependListener:ln,prependOnceListener:un,listeners:Ro,domain:Ei,_exiting:Si,config:Ai,dlopen:So,uptime:Oo,_getActiveRequests:Ao,_getActiveHandles:Io,reallyExit:Ii,_kill:ki,cpuUsage:hr,resourceUsage:Ti,memoryUsage:Oi,kill:Ri,exit:Pi,openStdin:Ci,allowedNodeEnvironmentFlags:Mi,assert:ko,features:xi,_fatalExceptions:Bi,setUncaughtExceptionCaptureCallback:Li,hasUncaughtExceptionCaptureCallback:To,emitWarning:pi,nextTick:_o,_tickCallback:Ui,_debugProcess:ji,_debugEnd:Ni,_startProfilerIdleNotifier:Di,_stopProfilerIdleNotifier:Fi,stdout:Wi,stdin:qi,stderr:$i,abort:Hi,umask:mi,chdir:yi,cwd:bi,env:ui,title:si,argv:hi,execArgv:ci,pid:Vi,ppid:zi,execPath:Gi,debugPort:Qi,hrtime:Tr,argv0:Ki,_preload_modules:Yi,setSourceMapsEnabled:Ji}}),he=nt(()=>{_a()}),Ye={};nr(Ye,{Buffer:()=>Ur,INSPECT_MAX_BYTES:()=>Po,default:()=>vt,kMaxLength:()=>Co});function va(){if(hn)return rr;hn=!0,rr.byteLength=i,rr.toByteArray=o,rr.fromByteArray=p;for(var s=[],f=[],n=typeof Uint8Array<"u"?Uint8Array:Array,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",c=0,r=a.length;c<r;++c)s[c]=a[c],f[a.charCodeAt(c)]=c;f[45]=62,f[95]=63;function e(m){var b=m.length;if(b%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var _=m.indexOf("=");_===-1&&(_=b);var E=_===b?0:4-_%4;return[_,E]}function i(m){var b=e(m),_=b[0],E=b[1];return(_+E)*3/4-E}function t(m,b,_){return(b+_)*3/4-_}function o(m){var b,_=e(m),E=_[0],I=_[1],y=new n(t(m,E,I)),v=0,j=I>0?E-4:E,x;for(x=0;x<j;x+=4)b=f[m.charCodeAt(x)]<<18|f[m.charCodeAt(x+1)]<<12|f[m.charCodeAt(x+2)]<<6|f[m.charCodeAt(x+3)],y[v++]=b>>16&255,y[v++]=b>>8&255,y[v++]=b&255;return I===2&&(b=f[m.charCodeAt(x)]<<2|f[m.charCodeAt(x+1)]>>4,y[v++]=b&255),I===1&&(b=f[m.charCodeAt(x)]<<10|f[m.charCodeAt(x+1)]<<4|f[m.charCodeAt(x+2)]>>2,y[v++]=b>>8&255,y[v++]=b&255),y}function u(m){return s[m>>18&63]+s[m>>12&63]+s[m>>6&63]+s[m&63]}function d(m,b,_){for(var E,I=[],y=b;y<_;y+=3)E=(m[y]<<16&16711680)+(m[y+1]<<8&65280)+(m[y+2]&255),I.push(u(E));return I.join("")}function p(m){for(var b,_=m.length,E=_%3,I=[],y=16383,v=0,j=_-E;v<j;v+=y)I.push(d(m,v,v+y>j?j:v+y));return E===1?(b=m[_-1],I.push(s[b>>2]+s[b<<4&63]+"==")):E===2&&(b=(m[_-2]<<8)+m[_-1],I.push(s[b>>10]+s[b>>4&63]+s[b<<2&63]+"=")),I.join("")}return rr}function Ea(){return cn?cr:(cn=!0,cr.read=function(s,f,n,a,c){var r,e,i=c*8-a-1,t=(1<<i)-1,o=t>>1,u=-7,d=n?c-1:0,p=n?-1:1,m=s[f+d];for(d+=p,r=m&(1<<-u)-1,m>>=-u,u+=i;u>0;r=r*256+s[f+d],d+=p,u-=8);for(e=r&(1<<-u)-1,r>>=-u,u+=a;u>0;e=e*256+s[f+d],d+=p,u-=8);if(r===0)r=1-o;else{if(r===t)return e?NaN:(m?-1:1)*(1/0);e=e+Math.pow(2,a),r=r-o}return(m?-1:1)*e*Math.pow(2,r-a)},cr.write=function(s,f,n,a,c,r){var e,i,t,o=r*8-c-1,u=(1<<o)-1,d=u>>1,p=c===23?Math.pow(2,-24)-Math.pow(2,-77):0,m=a?0:r-1,b=a?1:-1,_=f<0||f===0&&1/f<0?1:0;for(f=Math.abs(f),isNaN(f)||f===1/0?(i=isNaN(f)?1:0,e=u):(e=Math.floor(Math.log(f)/Math.LN2),f*(t=Math.pow(2,-e))<1&&(e--,t*=2),e+d>=1?f+=p/t:f+=p*Math.pow(2,1-d),f*t>=2&&(e++,t/=2),e+d>=u?(i=0,e=u):e+d>=1?(i=(f*t-1)*Math.pow(2,c),e=e+d):(i=f*Math.pow(2,d-1)*Math.pow(2,c),e=0));c>=8;s[n+m]=i&255,m+=b,i/=256,c-=8);for(e=e<<c|i,o+=c;o>0;s[n+m]=e&255,m+=b,e/=256,o-=8);s[n+m-b]|=_*128},cr)}function Sa(){if(fn)return Mt;fn=!0;let s=va(),f=Ea(),n=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;Mt.Buffer=e,Mt.SlowBuffer=I,Mt.INSPECT_MAX_BYTES=50;let a=2147483647;Mt.kMaxLength=a,e.TYPED_ARRAY_SUPPORT=c(),!e.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function c(){try{let l=new Uint8Array(1),h={foo:function(){return 42}};return Object.setPrototypeOf(h,Uint8Array.prototype),Object.setPrototypeOf(l,h),l.foo()===42}catch{return!1}}Object.defineProperty(e.prototype,"parent",{enumerable:!0,get:function(){if(e.isBuffer(this))return this.buffer}}),Object.defineProperty(e.prototype,"offset",{enumerable:!0,get:function(){if(e.isBuffer(this))return this.byteOffset}});function r(l){if(l>a)throw new RangeError('The value "'+l+'" is invalid for option "size"');let h=new Uint8Array(l);return Object.setPrototypeOf(h,e.prototype),h}function e(l,h,g){if(typeof l=="number"){if(typeof h=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return u(l)}return i(l,h,g)}e.poolSize=8192;function i(l,h,g){if(typeof l=="string")return d(l,h);if(ArrayBuffer.isView(l))return m(l);if(l==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof l);if(F(l,ArrayBuffer)||l&&F(l.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(F(l,SharedArrayBuffer)||l&&F(l.buffer,SharedArrayBuffer)))return b(l,h,g);if(typeof l=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');let w=l.valueOf&&l.valueOf();if(w!=null&&w!==l)return e.from(w,h,g);let k=_(l);if(k)return k;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof l[Symbol.toPrimitive]=="function")return e.from(l[Symbol.toPrimitive]("string"),h,g);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof l)}e.from=function(l,h,g){return i(l,h,g)},Object.setPrototypeOf(e.prototype,Uint8Array.prototype),Object.setPrototypeOf(e,Uint8Array);function t(l){if(typeof l!="number")throw new TypeError('"size" argument must be of type number');if(l<0)throw new RangeError('The value "'+l+'" is invalid for option "size"')}function o(l,h,g){return t(l),l<=0?r(l):h!==void 0?typeof g=="string"?r(l).fill(h,g):r(l).fill(h):r(l)}e.alloc=function(l,h,g){return o(l,h,g)};function u(l){return t(l),r(l<0?0:E(l)|0)}e.allocUnsafe=function(l){return u(l)},e.allocUnsafeSlow=function(l){return u(l)};function d(l,h){if((typeof h!="string"||h==="")&&(h="utf8"),!e.isEncoding(h))throw new TypeError("Unknown encoding: "+h);let g=y(l,h)|0,w=r(g),k=w.write(l,h);return k!==g&&(w=w.slice(0,k)),w}function p(l){let h=l.length<0?0:E(l.length)|0,g=r(h);for(let w=0;w<h;w+=1)g[w]=l[w]&255;return g}function m(l){if(F(l,Uint8Array)){let h=new Uint8Array(l);return b(h.buffer,h.byteOffset,h.byteLength)}return p(l)}function b(l,h,g){if(h<0||l.byteLength<h)throw new RangeError('"offset" is outside of buffer bounds');if(l.byteLength<h+(g||0))throw new RangeError('"length" is outside of buffer bounds');let w;return h===void 0&&g===void 0?w=new Uint8Array(l):g===void 0?w=new Uint8Array(l,h):w=new Uint8Array(l,h,g),Object.setPrototypeOf(w,e.prototype),w}function _(l){if(e.isBuffer(l)){let h=E(l.length)|0,g=r(h);return g.length===0||l.copy(g,0,0,h),g}if(l.length!==void 0)return typeof l.length!="number"||oe(l.length)?r(0):p(l);if(l.type==="Buffer"&&Array.isArray(l.data))return p(l.data)}function E(l){if(l>=a)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+a.toString(16)+" bytes");return l|0}function I(l){return+l!=l&&(l=0),e.alloc(+l)}e.isBuffer=function(l){return l!=null&&l._isBuffer===!0&&l!==e.prototype},e.compare=function(l,h){if(F(l,Uint8Array)&&(l=e.from(l,l.offset,l.byteLength)),F(h,Uint8Array)&&(h=e.from(h,h.offset,h.byteLength)),!e.isBuffer(l)||!e.isBuffer(h))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(l===h)return 0;let g=l.length,w=h.length;for(let k=0,U=Math.min(g,w);k<U;++k)if(l[k]!==h[k]){g=l[k],w=h[k];break}return g<w?-1:w<g?1:0},e.isEncoding=function(l){switch(String(l).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},e.concat=function(l,h){if(!Array.isArray(l))throw new TypeError('"list" argument must be an Array of Buffers');if(l.length===0)return e.alloc(0);let g;if(h===void 0)for(h=0,g=0;g<l.length;++g)h+=l[g].length;let w=e.allocUnsafe(h),k=0;for(g=0;g<l.length;++g){let U=l[g];if(F(U,Uint8Array))k+U.length>w.length?(e.isBuffer(U)||(U=e.from(U)),U.copy(w,k)):Uint8Array.prototype.set.call(w,U,k);else if(e.isBuffer(U))U.copy(w,k);else throw new TypeError('"list" argument must be an Array of Buffers');k+=U.length}return w};function y(l,h){if(e.isBuffer(l))return l.length;if(ArrayBuffer.isView(l)||F(l,ArrayBuffer))return l.byteLength;if(typeof l!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof l);let g=l.length,w=arguments.length>2&&arguments[2]===!0;if(!w&&g===0)return 0;let k=!1;for(;;)switch(h){case"ascii":case"latin1":case"binary":return g;case"utf8":case"utf-8":return D(l).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return g*2;case"hex":return g>>>1;case"base64":return te(l).length;default:if(k)return w?-1:D(l).length;h=(""+h).toLowerCase(),k=!0}}e.byteLength=y;function v(l,h,g){let w=!1;if((h===void 0||h<0)&&(h=0),h>this.length||((g===void 0||g>this.length)&&(g=this.length),g<=0)||(g>>>=0,h>>>=0,g<=h))return"";for(l||(l="utf8");;)switch(l){case"hex":return ge(this,h,g);case"utf8":case"utf-8":return Q(this,h,g);case"ascii":return me(this,h,g);case"latin1":case"binary":return de(this,h,g);case"base64":return P(this,h,g);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return _e(this,h,g);default:if(w)throw new TypeError("Unknown encoding: "+l);l=(l+"").toLowerCase(),w=!0}}e.prototype._isBuffer=!0;function j(l,h,g){let w=l[h];l[h]=l[g],l[g]=w}e.prototype.swap16=function(){let l=this.length;if(l%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let h=0;h<l;h+=2)j(this,h,h+1);return this},e.prototype.swap32=function(){let l=this.length;if(l%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let h=0;h<l;h+=4)j(this,h,h+3),j(this,h+1,h+2);return this},e.prototype.swap64=function(){let l=this.length;if(l%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let h=0;h<l;h+=8)j(this,h,h+7),j(this,h+1,h+6),j(this,h+2,h+5),j(this,h+3,h+4);return this},e.prototype.toString=function(){let l=this.length;return l===0?"":arguments.length===0?Q(this,0,l):v.apply(this,arguments)},e.prototype.toLocaleString=e.prototype.toString,e.prototype.equals=function(l){if(!e.isBuffer(l))throw new TypeError("Argument must be a Buffer");return this===l?!0:e.compare(this,l)===0},e.prototype.inspect=function(){let l="",h=Mt.INSPECT_MAX_BYTES;return l=this.toString("hex",0,h).replace(/(.{2})/g,"$1 ").trim(),this.length>h&&(l+=" ... "),"<Buffer "+l+">"},n&&(e.prototype[n]=e.prototype.inspect),e.prototype.compare=function(l,h,g,w,k){if(F(l,Uint8Array)&&(l=e.from(l,l.offset,l.byteLength)),!e.isBuffer(l))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof l);if(h===void 0&&(h=0),g===void 0&&(g=l?l.length:0),w===void 0&&(w=0),k===void 0&&(k=this.length),h<0||g>l.length||w<0||k>this.length)throw new RangeError("out of range index");if(w>=k&&h>=g)return 0;if(w>=k)return-1;if(h>=g)return 1;if(h>>>=0,g>>>=0,w>>>=0,k>>>=0,this===l)return 0;let U=k-w,z=g-h,ve=Math.min(U,z),Ee=this.slice(w,k),Oe=l.slice(h,g);for(let xe=0;xe<ve;++xe)if(Ee[xe]!==Oe[xe]){U=Ee[xe],z=Oe[xe];break}return U<z?-1:z<U?1:0};function x(l,h,g,w,k){if(l.length===0)return-1;if(typeof g=="string"?(w=g,g=0):g>2147483647?g=2147483647:g<-2147483648&&(g=-2147483648),g=+g,oe(g)&&(g=k?0:l.length-1),g<0&&(g=l.length+g),g>=l.length){if(k)return-1;g=l.length-1}else if(g<0)if(k)g=0;else return-1;if(typeof h=="string"&&(h=e.from(h,w)),e.isBuffer(h))return h.length===0?-1:A(l,h,g,w,k);if(typeof h=="number")return h=h&255,typeof Uint8Array.prototype.indexOf=="function"?k?Uint8Array.prototype.indexOf.call(l,h,g):Uint8Array.prototype.lastIndexOf.call(l,h,g):A(l,[h],g,w,k);throw new TypeError("val must be string, number or Buffer")}function A(l,h,g,w,k){let U=1,z=l.length,ve=h.length;if(w!==void 0&&(w=String(w).toLowerCase(),w==="ucs2"||w==="ucs-2"||w==="utf16le"||w==="utf-16le")){if(l.length<2||h.length<2)return-1;U=2,z/=2,ve/=2,g/=2}function Ee(xe,Ce){return U===1?xe[Ce]:xe.readUInt16BE(Ce*U)}let Oe;if(k){let xe=-1;for(Oe=g;Oe<z;Oe++)if(Ee(l,Oe)===Ee(h,xe===-1?0:Oe-xe)){if(xe===-1&&(xe=Oe),Oe-xe+1===ve)return xe*U}else xe!==-1&&(Oe-=Oe-xe),xe=-1}else for(g+ve>z&&(g=z-ve),Oe=g;Oe>=0;Oe--){let xe=!0;for(let Ce=0;Ce<ve;Ce++)if(Ee(l,Oe+Ce)!==Ee(h,Ce)){xe=!1;break}if(xe)return Oe}return-1}e.prototype.includes=function(l,h,g){return this.indexOf(l,h,g)!==-1},e.prototype.indexOf=function(l,h,g){return x(this,l,h,g,!0)},e.prototype.lastIndexOf=function(l,h,g){return x(this,l,h,g,!1)};function T(l,h,g,w){g=Number(g)||0;let k=l.length-g;w?(w=Number(w),w>k&&(w=k)):w=k;let U=h.length;w>U/2&&(w=U/2);let z;for(z=0;z<w;++z){let ve=parseInt(h.substr(z*2,2),16);if(oe(ve))return z;l[g+z]=ve}return z}function B(l,h,g,w){return le(D(h,l.length-g),l,g,w)}function Y(l,h,g,w){return le(K(h),l,g,w)}function X(l,h,g,w){return le(te(h),l,g,w)}function ae(l,h,g,w){return le(ne(h,l.length-g),l,g,w)}e.prototype.write=function(l,h,g,w){if(h===void 0)w="utf8",g=this.length,h=0;else if(g===void 0&&typeof h=="string")w=h,g=this.length,h=0;else if(isFinite(h))h=h>>>0,isFinite(g)?(g=g>>>0,w===void 0&&(w="utf8")):(w=g,g=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");let k=this.length-h;if((g===void 0||g>k)&&(g=k),l.length>0&&(g<0||h<0)||h>this.length)throw new RangeError("Attempt to write outside buffer bounds");w||(w="utf8");let U=!1;for(;;)switch(w){case"hex":return T(this,l,h,g);case"utf8":case"utf-8":return B(this,l,h,g);case"ascii":case"latin1":case"binary":return Y(this,l,h,g);case"base64":return X(this,l,h,g);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ae(this,l,h,g);default:if(U)throw new TypeError("Unknown encoding: "+w);w=(""+w).toLowerCase(),U=!0}},e.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function P(l,h,g){return h===0&&g===l.length?s.fromByteArray(l):s.fromByteArray(l.slice(h,g))}function Q(l,h,g){g=Math.min(l.length,g);let w=[],k=h;for(;k<g;){let U=l[k],z=null,ve=U>239?4:U>223?3:U>191?2:1;if(k+ve<=g){let Ee,Oe,xe,Ce;switch(ve){case 1:U<128&&(z=U);break;case 2:Ee=l[k+1],(Ee&192)===128&&(Ce=(U&31)<<6|Ee&63,Ce>127&&(z=Ce));break;case 3:Ee=l[k+1],Oe=l[k+2],(Ee&192)===128&&(Oe&192)===128&&(Ce=(U&15)<<12|(Ee&63)<<6|Oe&63,Ce>2047&&(Ce<55296||Ce>57343)&&(z=Ce));break;case 4:Ee=l[k+1],Oe=l[k+2],xe=l[k+3],(Ee&192)===128&&(Oe&192)===128&&(xe&192)===128&&(Ce=(U&15)<<18|(Ee&63)<<12|(Oe&63)<<6|xe&63,Ce>65535&&Ce<1114112&&(z=Ce))}}z===null?(z=65533,ve=1):z>65535&&(z-=65536,w.push(z>>>10&1023|55296),z=56320|z&1023),w.push(z),k+=ve}return W(w)}let J=4096;function W(l){let h=l.length;if(h<=J)return String.fromCharCode.apply(String,l);let g="",w=0;for(;w<h;)g+=String.fromCharCode.apply(String,l.slice(w,w+=J));return g}function me(l,h,g){let w="";g=Math.min(l.length,g);for(let k=h;k<g;++k)w+=String.fromCharCode(l[k]&127);return w}function de(l,h,g){let w="";g=Math.min(l.length,g);for(let k=h;k<g;++k)w+=String.fromCharCode(l[k]);return w}function ge(l,h,g){let w=l.length;(!h||h<0)&&(h=0),(!g||g<0||g>w)&&(g=w);let k="";for(let U=h;U<g;++U)k+=ye[l[U]];return k}function _e(l,h,g){let w=l.slice(h,g),k="";for(let U=0;U<w.length-1;U+=2)k+=String.fromCharCode(w[U]+w[U+1]*256);return k}e.prototype.slice=function(l,h){let g=this.length;l=~~l,h=h===void 0?g:~~h,l<0?(l+=g,l<0&&(l=0)):l>g&&(l=g),h<0?(h+=g,h<0&&(h=0)):h>g&&(h=g),h<l&&(h=l);let w=this.subarray(l,h);return Object.setPrototypeOf(w,e.prototype),w};function G(l,h,g){if(l%1!==0||l<0)throw new RangeError("offset is not uint");if(l+h>g)throw new RangeError("Trying to access beyond buffer length")}e.prototype.readUintLE=e.prototype.readUIntLE=function(l,h,g){l=l>>>0,h=h>>>0,g||G(l,h,this.length);let w=this[l],k=1,U=0;for(;++U<h&&(k*=256);)w+=this[l+U]*k;return w},e.prototype.readUintBE=e.prototype.readUIntBE=function(l,h,g){l=l>>>0,h=h>>>0,g||G(l,h,this.length);let w=this[l+--h],k=1;for(;h>0&&(k*=256);)w+=this[l+--h]*k;return w},e.prototype.readUint8=e.prototype.readUInt8=function(l,h){return l=l>>>0,h||G(l,1,this.length),this[l]},e.prototype.readUint16LE=e.prototype.readUInt16LE=function(l,h){return l=l>>>0,h||G(l,2,this.length),this[l]|this[l+1]<<8},e.prototype.readUint16BE=e.prototype.readUInt16BE=function(l,h){return l=l>>>0,h||G(l,2,this.length),this[l]<<8|this[l+1]},e.prototype.readUint32LE=e.prototype.readUInt32LE=function(l,h){return l=l>>>0,h||G(l,4,this.length),(this[l]|this[l+1]<<8|this[l+2]<<16)+this[l+3]*16777216},e.prototype.readUint32BE=e.prototype.readUInt32BE=function(l,h){return l=l>>>0,h||G(l,4,this.length),this[l]*16777216+(this[l+1]<<16|this[l+2]<<8|this[l+3])},e.prototype.readBigUInt64LE=ee(function(l){l=l>>>0,H(l,"offset");let h=this[l],g=this[l+7];(h===void 0||g===void 0)&&se(l,this.length-8);let w=h+this[++l]*2**8+this[++l]*2**16+this[++l]*2**24,k=this[++l]+this[++l]*2**8+this[++l]*2**16+g*2**24;return BigInt(w)+(BigInt(k)<<BigInt(32))}),e.prototype.readBigUInt64BE=ee(function(l){l=l>>>0,H(l,"offset");let h=this[l],g=this[l+7];(h===void 0||g===void 0)&&se(l,this.length-8);let w=h*2**24+this[++l]*2**16+this[++l]*2**8+this[++l],k=this[++l]*2**24+this[++l]*2**16+this[++l]*2**8+g;return(BigInt(w)<<BigInt(32))+BigInt(k)}),e.prototype.readIntLE=function(l,h,g){l=l>>>0,h=h>>>0,g||G(l,h,this.length);let w=this[l],k=1,U=0;for(;++U<h&&(k*=256);)w+=this[l+U]*k;return k*=128,w>=k&&(w-=Math.pow(2,8*h)),w},e.prototype.readIntBE=function(l,h,g){l=l>>>0,h=h>>>0,g||G(l,h,this.length);let w=h,k=1,U=this[l+--w];for(;w>0&&(k*=256);)U+=this[l+--w]*k;return k*=128,U>=k&&(U-=Math.pow(2,8*h)),U},e.prototype.readInt8=function(l,h){return l=l>>>0,h||G(l,1,this.length),this[l]&128?(255-this[l]+1)*-1:this[l]},e.prototype.readInt16LE=function(l,h){l=l>>>0,h||G(l,2,this.length);let g=this[l]|this[l+1]<<8;return g&32768?g|4294901760:g},e.prototype.readInt16BE=function(l,h){l=l>>>0,h||G(l,2,this.length);let g=this[l+1]|this[l]<<8;return g&32768?g|4294901760:g},e.prototype.readInt32LE=function(l,h){return l=l>>>0,h||G(l,4,this.length),this[l]|this[l+1]<<8|this[l+2]<<16|this[l+3]<<24},e.prototype.readInt32BE=function(l,h){return l=l>>>0,h||G(l,4,this.length),this[l]<<24|this[l+1]<<16|this[l+2]<<8|this[l+3]},e.prototype.readBigInt64LE=ee(function(l){l=l>>>0,H(l,"offset");let h=this[l],g=this[l+7];(h===void 0||g===void 0)&&se(l,this.length-8);let w=this[l+4]+this[l+5]*2**8+this[l+6]*2**16+(g<<24);return(BigInt(w)<<BigInt(32))+BigInt(h+this[++l]*2**8+this[++l]*2**16+this[++l]*2**24)}),e.prototype.readBigInt64BE=ee(function(l){l=l>>>0,H(l,"offset");let h=this[l],g=this[l+7];(h===void 0||g===void 0)&&se(l,this.length-8);let w=(h<<24)+this[++l]*2**16+this[++l]*2**8+this[++l];return(BigInt(w)<<BigInt(32))+BigInt(this[++l]*2**24+this[++l]*2**16+this[++l]*2**8+g)}),e.prototype.readFloatLE=function(l,h){return l=l>>>0,h||G(l,4,this.length),f.read(this,l,!0,23,4)},e.prototype.readFloatBE=function(l,h){return l=l>>>0,h||G(l,4,this.length),f.read(this,l,!1,23,4)},e.prototype.readDoubleLE=function(l,h){return l=l>>>0,h||G(l,8,this.length),f.read(this,l,!0,52,8)},e.prototype.readDoubleBE=function(l,h){return l=l>>>0,h||G(l,8,this.length),f.read(this,l,!1,52,8)};function fe(l,h,g,w,k,U){if(!e.isBuffer(l))throw new TypeError('"buffer" argument must be a Buffer instance');if(h>k||h<U)throw new RangeError('"value" argument is out of bounds');if(g+w>l.length)throw new RangeError("Index out of range")}e.prototype.writeUintLE=e.prototype.writeUIntLE=function(l,h,g,w){if(l=+l,h=h>>>0,g=g>>>0,!w){let z=Math.pow(2,8*g)-1;fe(this,l,h,g,z,0)}let k=1,U=0;for(this[h]=l&255;++U<g&&(k*=256);)this[h+U]=l/k&255;return h+g},e.prototype.writeUintBE=e.prototype.writeUIntBE=function(l,h,g,w){if(l=+l,h=h>>>0,g=g>>>0,!w){let z=Math.pow(2,8*g)-1;fe(this,l,h,g,z,0)}let k=g-1,U=1;for(this[h+k]=l&255;--k>=0&&(U*=256);)this[h+k]=l/U&255;return h+g},e.prototype.writeUint8=e.prototype.writeUInt8=function(l,h,g){return l=+l,h=h>>>0,g||fe(this,l,h,1,255,0),this[h]=l&255,h+1},e.prototype.writeUint16LE=e.prototype.writeUInt16LE=function(l,h,g){return l=+l,h=h>>>0,g||fe(this,l,h,2,65535,0),this[h]=l&255,this[h+1]=l>>>8,h+2},e.prototype.writeUint16BE=e.prototype.writeUInt16BE=function(l,h,g){return l=+l,h=h>>>0,g||fe(this,l,h,2,65535,0),this[h]=l>>>8,this[h+1]=l&255,h+2},e.prototype.writeUint32LE=e.prototype.writeUInt32LE=function(l,h,g){return l=+l,h=h>>>0,g||fe(this,l,h,4,4294967295,0),this[h+3]=l>>>24,this[h+2]=l>>>16,this[h+1]=l>>>8,this[h]=l&255,h+4},e.prototype.writeUint32BE=e.prototype.writeUInt32BE=function(l,h,g){return l=+l,h=h>>>0,g||fe(this,l,h,4,4294967295,0),this[h]=l>>>24,this[h+1]=l>>>16,this[h+2]=l>>>8,this[h+3]=l&255,h+4};function C(l,h,g,w,k){q(h,w,k,l,g,7);let U=Number(h&BigInt(4294967295));l[g++]=U,U=U>>8,l[g++]=U,U=U>>8,l[g++]=U,U=U>>8,l[g++]=U;let z=Number(h>>BigInt(32)&BigInt(4294967295));return l[g++]=z,z=z>>8,l[g++]=z,z=z>>8,l[g++]=z,z=z>>8,l[g++]=z,g}function re(l,h,g,w,k){q(h,w,k,l,g,7);let U=Number(h&BigInt(4294967295));l[g+7]=U,U=U>>8,l[g+6]=U,U=U>>8,l[g+5]=U,U=U>>8,l[g+4]=U;let z=Number(h>>BigInt(32)&BigInt(4294967295));return l[g+3]=z,z=z>>8,l[g+2]=z,z=z>>8,l[g+1]=z,z=z>>8,l[g]=z,g+8}e.prototype.writeBigUInt64LE=ee(function(l,h=0){return C(this,l,h,BigInt(0),BigInt("0xffffffffffffffff"))}),e.prototype.writeBigUInt64BE=ee(function(l,h=0){return re(this,l,h,BigInt(0),BigInt("0xffffffffffffffff"))}),e.prototype.writeIntLE=function(l,h,g,w){if(l=+l,h=h>>>0,!w){let ve=Math.pow(2,8*g-1);fe(this,l,h,g,ve-1,-ve)}let k=0,U=1,z=0;for(this[h]=l&255;++k<g&&(U*=256);)l<0&&z===0&&this[h+k-1]!==0&&(z=1),this[h+k]=(l/U>>0)-z&255;return h+g},e.prototype.writeIntBE=function(l,h,g,w){if(l=+l,h=h>>>0,!w){let ve=Math.pow(2,8*g-1);fe(this,l,h,g,ve-1,-ve)}let k=g-1,U=1,z=0;for(this[h+k]=l&255;--k>=0&&(U*=256);)l<0&&z===0&&this[h+k+1]!==0&&(z=1),this[h+k]=(l/U>>0)-z&255;return h+g},e.prototype.writeInt8=function(l,h,g){return l=+l,h=h>>>0,g||fe(this,l,h,1,127,-128),l<0&&(l=255+l+1),this[h]=l&255,h+1},e.prototype.writeInt16LE=function(l,h,g){return l=+l,h=h>>>0,g||fe(this,l,h,2,32767,-32768),this[h]=l&255,this[h+1]=l>>>8,h+2},e.prototype.writeInt16BE=function(l,h,g){return l=+l,h=h>>>0,g||fe(this,l,h,2,32767,-32768),this[h]=l>>>8,this[h+1]=l&255,h+2},e.prototype.writeInt32LE=function(l,h,g){return l=+l,h=h>>>0,g||fe(this,l,h,4,2147483647,-2147483648),this[h]=l&255,this[h+1]=l>>>8,this[h+2]=l>>>16,this[h+3]=l>>>24,h+4},e.prototype.writeInt32BE=function(l,h,g){return l=+l,h=h>>>0,g||fe(this,l,h,4,2147483647,-2147483648),l<0&&(l=4294967295+l+1),this[h]=l>>>24,this[h+1]=l>>>16,this[h+2]=l>>>8,this[h+3]=l&255,h+4},e.prototype.writeBigInt64LE=ee(function(l,h=0){return C(this,l,h,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),e.prototype.writeBigInt64BE=ee(function(l,h=0){return re(this,l,h,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function pe(l,h,g,w,k,U){if(g+w>l.length)throw new RangeError("Index out of range");if(g<0)throw new RangeError("Index out of range")}function N(l,h,g,w,k){return h=+h,g=g>>>0,k||pe(l,h,g,4),f.write(l,h,g,w,23,4),g+4}e.prototype.writeFloatLE=function(l,h,g){return N(this,l,h,!0,g)},e.prototype.writeFloatBE=function(l,h,g){return N(this,l,h,!1,g)};function Ae(l,h,g,w,k){return h=+h,g=g>>>0,k||pe(l,h,g,8),f.write(l,h,g,w,52,8),g+8}e.prototype.writeDoubleLE=function(l,h,g){return Ae(this,l,h,!0,g)},e.prototype.writeDoubleBE=function(l,h,g){return Ae(this,l,h,!1,g)},e.prototype.copy=function(l,h,g,w){if(!e.isBuffer(l))throw new TypeError("argument should be a Buffer");if(g||(g=0),!w&&w!==0&&(w=this.length),h>=l.length&&(h=l.length),h||(h=0),w>0&&w<g&&(w=g),w===g||l.length===0||this.length===0)return 0;if(h<0)throw new RangeError("targetStart out of bounds");if(g<0||g>=this.length)throw new RangeError("Index out of range");if(w<0)throw new RangeError("sourceEnd out of bounds");w>this.length&&(w=this.length),l.length-h<w-g&&(w=l.length-h+g);let k=w-g;return this===l&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(h,g,w):Uint8Array.prototype.set.call(l,this.subarray(g,w),h),k},e.prototype.fill=function(l,h,g,w){if(typeof l=="string"){if(typeof h=="string"?(w=h,h=0,g=this.length):typeof g=="string"&&(w=g,g=this.length),w!==void 0&&typeof w!="string")throw new TypeError("encoding must be a string");if(typeof w=="string"&&!e.isEncoding(w))throw new TypeError("Unknown encoding: "+w);if(l.length===1){let U=l.charCodeAt(0);(w==="utf8"&&U<128||w==="latin1")&&(l=U)}}else typeof l=="number"?l=l&255:typeof l=="boolean"&&(l=Number(l));if(h<0||this.length<h||this.length<g)throw new RangeError("Out of range index");if(g<=h)return this;h=h>>>0,g=g===void 0?this.length:g>>>0,l||(l=0);let k;if(typeof l=="number")for(k=h;k<g;++k)this[k]=l;else{let U=e.isBuffer(l)?l:e.from(l,w),z=U.length;if(z===0)throw new TypeError('The value "'+l+'" is invalid for argument "value"');for(k=0;k<g-h;++k)this[k+h]=U[k%z]}return this};let V={};function L(l,h,g){V[l]=class extends g{constructor(){super(),Object.defineProperty(this,"message",{value:h.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${l}]`,this.stack,delete this.name}get code(){return l}set code(w){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:w,writable:!0})}toString(){return`${this.name} [${l}]: ${this.message}`}}}L("ERR_BUFFER_OUT_OF_BOUNDS",function(l){return l?`${l} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),L("ERR_INVALID_ARG_TYPE",function(l,h){return`The "${l}" argument must be of type number. Received type ${typeof h}`},TypeError),L("ERR_OUT_OF_RANGE",function(l,h,g){let w=`The value of "${l}" is out of range.`,k=g;return Number.isInteger(g)&&Math.abs(g)>2**32?k=Z(String(g)):typeof g=="bigint"&&(k=String(g),(g>BigInt(2)**BigInt(32)||g<-(BigInt(2)**BigInt(32)))&&(k=Z(k)),k+="n"),w+=` It must be ${h}. Received ${k}`,w},RangeError);function Z(l){let h="",g=l.length,w=l[0]==="-"?1:0;for(;g>=w+4;g-=3)h=`_${l.slice(g-3,g)}${h}`;return`${l.slice(0,g)}${h}`}function $(l,h,g){H(h,"offset"),(l[h]===void 0||l[h+g]===void 0)&&se(h,l.length-(g+1))}function q(l,h,g,w,k,U){if(l>g||l<h){let z=typeof h=="bigint"?"n":"",ve;throw h===0||h===BigInt(0)?ve=`>= 0${z} and < 2${z} ** ${(U+1)*8}${z}`:ve=`>= -(2${z} ** ${(U+1)*8-1}${z}) and < 2 ** ${(U+1)*8-1}${z}`,new V.ERR_OUT_OF_RANGE("value",ve,l)}$(w,k,U)}function H(l,h){if(typeof l!="number")throw new V.ERR_INVALID_ARG_TYPE(h,"number",l)}function se(l,h,g){throw Math.floor(l)!==l?(H(l,g),new V.ERR_OUT_OF_RANGE("offset","an integer",l)):h<0?new V.ERR_BUFFER_OUT_OF_BOUNDS:new V.ERR_OUT_OF_RANGE("offset",`>= 0 and <= ${h}`,l)}let ie=/[^+/0-9A-Za-z-_]/g;function M(l){if(l=l.split("=")[0],l=l.trim().replace(ie,""),l.length<2)return"";for(;l.length%4!==0;)l=l+"=";return l}function D(l,h){h=h||1/0;let g,w=l.length,k=null,U=[];for(let z=0;z<w;++z){if(g=l.charCodeAt(z),g>55295&&g<57344){if(!k){if(g>56319){(h-=3)>-1&&U.push(239,191,189);continue}else if(z+1===w){(h-=3)>-1&&U.push(239,191,189);continue}k=g;continue}if(g<56320){(h-=3)>-1&&U.push(239,191,189),k=g;continue}g=(k-55296<<10|g-56320)+65536}else k&&(h-=3)>-1&&U.push(239,191,189);if(k=null,g<128){if((h-=1)<0)break;U.push(g)}else if(g<2048){if((h-=2)<0)break;U.push(g>>6|192,g&63|128)}else if(g<65536){if((h-=3)<0)break;U.push(g>>12|224,g>>6&63|128,g&63|128)}else if(g<1114112){if((h-=4)<0)break;U.push(g>>18|240,g>>12&63|128,g>>6&63|128,g&63|128)}else throw new Error("Invalid code point")}return U}function K(l){let h=[];for(let g=0;g<l.length;++g)h.push(l.charCodeAt(g)&255);return h}function ne(l,h){let g,w,k,U=[];for(let z=0;z<l.length&&!((h-=2)<0);++z)g=l.charCodeAt(z),w=g>>8,k=g%256,U.push(k),U.push(w);return U}function te(l){return s.toByteArray(M(l))}function le(l,h,g,w){let k;for(k=0;k<w&&!(k+g>=h.length||k>=l.length);++k)h[k+g]=l[k];return k}function F(l,h){return l instanceof h||l!=null&&l.constructor!=null&&l.constructor.name!=null&&l.constructor.name===h.name}function oe(l){return l!==l}let ye=function(){let l="0123456789abcdef",h=new Array(256);for(let g=0;g<16;++g){let w=g*16;for(let k=0;k<16;++k)h[w+k]=l[g]+l[k]}return h}();function ee(l){return typeof BigInt>"u"?Pe:l}function Pe(){throw new Error("BigInt not supported")}return Mt}var rr,hn,cr,cn,Mt,fn,vt,Ur,Po,Co,Je=nt(()=>{ue(),ce(),he(),rr={},hn=!1,cr={},cn=!1,Mt={},fn=!1,vt=Sa(),vt.Buffer,vt.SlowBuffer,vt.INSPECT_MAX_BYTES,vt.kMaxLength,Ur=vt.Buffer,Po=vt.INSPECT_MAX_BYTES,Co=vt.kMaxLength}),ce=nt(()=>{Je()}),Aa=be(s=>{ue(),ce(),he(),Object.defineProperty(s,"__esModule",{value:!0});var f=class{constructor(n){this.aliasToTopic={},this.max=n}put(n,a){return a===0||a>this.max?!1:(this.aliasToTopic[a]=n,this.length=Object.keys(this.aliasToTopic).length,!0)}getTopicByAlias(n){return this.aliasToTopic[n]}clear(){this.aliasToTopic={}}};s.default=f}),Ve=be((s,f)=>{ue(),ce(),he();var n=class extends Error{constructor(a){if(!Array.isArray(a))throw new TypeError(`Expected input to be an Array, got ${typeof a}`);let c="";for(let r=0;r<a.length;r++)c+=`    ${a[r].stack}
`;super(c),this.name="AggregateError",this.errors=a}};f.exports={AggregateError:n,ArrayIsArray(a){return Array.isArray(a)},ArrayPrototypeIncludes(a,c){return a.includes(c)},ArrayPrototypeIndexOf(a,c){return a.indexOf(c)},ArrayPrototypeJoin(a,c){return a.join(c)},ArrayPrototypeMap(a,c){return a.map(c)},ArrayPrototypePop(a,c){return a.pop(c)},ArrayPrototypePush(a,c){return a.push(c)},ArrayPrototypeSlice(a,c,r){return a.slice(c,r)},Error,FunctionPrototypeCall(a,c,...r){return a.call(c,...r)},FunctionPrototypeSymbolHasInstance(a,c){return Function.prototype[Symbol.hasInstance].call(a,c)},MathFloor:Math.floor,Number,NumberIsInteger:Number.isInteger,NumberIsNaN:Number.isNaN,NumberMAX_SAFE_INTEGER:Number.MAX_SAFE_INTEGER,NumberMIN_SAFE_INTEGER:Number.MIN_SAFE_INTEGER,NumberParseInt:Number.parseInt,ObjectDefineProperties(a,c){return Object.defineProperties(a,c)},ObjectDefineProperty(a,c,r){return Object.defineProperty(a,c,r)},ObjectGetOwnPropertyDescriptor(a,c){return Object.getOwnPropertyDescriptor(a,c)},ObjectKeys(a){return Object.keys(a)},ObjectSetPrototypeOf(a,c){return Object.setPrototypeOf(a,c)},Promise,PromisePrototypeCatch(a,c){return a.catch(c)},PromisePrototypeThen(a,c,r){return a.then(c,r)},PromiseReject(a){return Promise.reject(a)},PromiseResolve(a){return Promise.resolve(a)},ReflectApply:Reflect.apply,RegExpPrototypeTest(a,c){return a.test(c)},SafeSet:Set,String,StringPrototypeSlice(a,c,r){return a.slice(c,r)},StringPrototypeToLowerCase(a){return a.toLowerCase()},StringPrototypeToUpperCase(a){return a.toUpperCase()},StringPrototypeTrim(a){return a.trim()},Symbol,SymbolFor:Symbol.for,SymbolAsyncIterator:Symbol.asyncIterator,SymbolHasInstance:Symbol.hasInstance,SymbolIterator:Symbol.iterator,SymbolDispose:Symbol.dispose||Symbol("Symbol.dispose"),SymbolAsyncDispose:Symbol.asyncDispose||Symbol("Symbol.asyncDispose"),TypedArrayPrototypeSet(a,c,r){return a.set(c,r)},Boolean,Uint8Array}}),Mo=be((s,f)=>{ue(),ce(),he(),f.exports={format(n,...a){return n.replace(/%([sdifj])/g,function(...[c,r]){let e=a.shift();return r==="f"?e.toFixed(6):r==="j"?JSON.stringify(e):r==="s"&&typeof e=="object"?`${e.constructor!==Object?e.constructor.name:""} {}`.trim():e.toString()})},inspect(n){switch(typeof n){case"string":if(n.includes("'"))if(n.includes('"')){if(!n.includes("`")&&!n.includes("${"))return`\`${n}\``}else return`"${n}"`;return`'${n}'`;case"number":return isNaN(n)?"NaN":Object.is(n,-0)?String(n):n;case"bigint":return`${String(n)}n`;case"boolean":case"undefined":return String(n);case"object":return"{}"}}}}),ot=be((s,f)=>{ue(),ce(),he();var{format:n,inspect:a}=Mo(),{AggregateError:c}=Ve(),r=globalThis.AggregateError||c,e=Symbol("kIsNodeError"),i=["string","function","number","object","Function","Object","boolean","bigint","symbol"],t=/^([A-Z][a-z0-9]*)+$/,o="__node_internal_",u={};function d(y,v){if(!y)throw new u.ERR_INTERNAL_ASSERTION(v)}function p(y){let v="",j=y.length,x=y[0]==="-"?1:0;for(;j>=x+4;j-=3)v=`_${y.slice(j-3,j)}${v}`;return`${y.slice(0,j)}${v}`}function m(y,v,j){if(typeof v=="function")return d(v.length<=j.length,`Code: ${y}; The provided arguments length (${j.length}) does not match the required ones (${v.length}).`),v(...j);let x=(v.match(/%[dfijoOs]/g)||[]).length;return d(x===j.length,`Code: ${y}; The provided arguments length (${j.length}) does not match the required ones (${x}).`),j.length===0?v:n(v,...j)}function b(y,v,j){j||(j=Error);class x extends j{constructor(...T){super(m(y,v,T))}toString(){return`${this.name} [${y}]: ${this.message}`}}Object.defineProperties(x.prototype,{name:{value:j.name,writable:!0,enumerable:!1,configurable:!0},toString:{value(){return`${this.name} [${y}]: ${this.message}`},writable:!0,enumerable:!1,configurable:!0}}),x.prototype.code=y,x.prototype[e]=!0,u[y]=x}function _(y){let v=o+y.name;return Object.defineProperty(y,"name",{value:v}),y}function E(y,v){if(y&&v&&y!==v){if(Array.isArray(v.errors))return v.errors.push(y),v;let j=new r([v,y],v.message);return j.code=v.code,j}return y||v}var I=class extends Error{constructor(y="The operation was aborted",v=void 0){if(v!==void 0&&typeof v!="object")throw new u.ERR_INVALID_ARG_TYPE("options","Object",v);super(y,v),this.code="ABORT_ERR",this.name="AbortError"}};b("ERR_ASSERTION","%s",Error),b("ERR_INVALID_ARG_TYPE",(y,v,j)=>{d(typeof y=="string","'name' must be a string"),Array.isArray(v)||(v=[v]);let x="The ";y.endsWith(" argument")?x+=`${y} `:x+=`"${y}" ${y.includes(".")?"property":"argument"} `,x+="must be ";let A=[],T=[],B=[];for(let X of v)d(typeof X=="string","All expected entries have to be of type string"),i.includes(X)?A.push(X.toLowerCase()):t.test(X)?T.push(X):(d(X!=="object",'The value "object" should be written as "Object"'),B.push(X));if(T.length>0){let X=A.indexOf("object");X!==-1&&(A.splice(A,X,1),T.push("Object"))}if(A.length>0){switch(A.length){case 1:x+=`of type ${A[0]}`;break;case 2:x+=`one of type ${A[0]} or ${A[1]}`;break;default:{let X=A.pop();x+=`one of type ${A.join(", ")}, or ${X}`}}(T.length>0||B.length>0)&&(x+=" or ")}if(T.length>0){switch(T.length){case 1:x+=`an instance of ${T[0]}`;break;case 2:x+=`an instance of ${T[0]} or ${T[1]}`;break;default:{let X=T.pop();x+=`an instance of ${T.join(", ")}, or ${X}`}}B.length>0&&(x+=" or ")}switch(B.length){case 0:break;case 1:B[0].toLowerCase()!==B[0]&&(x+="an "),x+=`${B[0]}`;break;case 2:x+=`one of ${B[0]} or ${B[1]}`;break;default:{let X=B.pop();x+=`one of ${B.join(", ")}, or ${X}`}}if(j==null)x+=`. Received ${j}`;else if(typeof j=="function"&&j.name)x+=`. Received function ${j.name}`;else if(typeof j=="object"){var Y;if((Y=j.constructor)!==null&&Y!==void 0&&Y.name)x+=`. Received an instance of ${j.constructor.name}`;else{let X=a(j,{depth:-1});x+=`. Received ${X}`}}else{let X=a(j,{colors:!1});X.length>25&&(X=`${X.slice(0,25)}...`),x+=`. Received type ${typeof j} (${X})`}return x},TypeError),b("ERR_INVALID_ARG_VALUE",(y,v,j="is invalid")=>{let x=a(v);return x.length>128&&(x=x.slice(0,128)+"..."),`The ${y.includes(".")?"property":"argument"} '${y}' ${j}. Received ${x}`},TypeError),b("ERR_INVALID_RETURN_VALUE",(y,v,j)=>{var x;let A=j!=null&&(x=j.constructor)!==null&&x!==void 0&&x.name?`instance of ${j.constructor.name}`:`type ${typeof j}`;return`Expected ${y} to be returned from the "${v}" function but got ${A}.`},TypeError),b("ERR_MISSING_ARGS",(...y)=>{d(y.length>0,"At least one arg needs to be specified");let v,j=y.length;switch(y=(Array.isArray(y)?y:[y]).map(x=>`"${x}"`).join(" or "),j){case 1:v+=`The ${y[0]} argument`;break;case 2:v+=`The ${y[0]} and ${y[1]} arguments`;break;default:{let x=y.pop();v+=`The ${y.join(", ")}, and ${x} arguments`}break}return`${v} must be specified`},TypeError),b("ERR_OUT_OF_RANGE",(y,v,j)=>{d(v,'Missing "range" argument');let x;if(Number.isInteger(j)&&Math.abs(j)>2**32)x=p(String(j));else if(typeof j=="bigint"){x=String(j);let A=BigInt(2)**BigInt(32);(j>A||j<-A)&&(x=p(x)),x+="n"}else x=a(j);return`The value of "${y}" is out of range. It must be ${v}. Received ${x}`},RangeError),b("ERR_MULTIPLE_CALLBACK","Callback called multiple times",Error),b("ERR_METHOD_NOT_IMPLEMENTED","The %s method is not implemented",Error),b("ERR_STREAM_ALREADY_FINISHED","Cannot call %s after a stream was finished",Error),b("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable",Error),b("ERR_STREAM_DESTROYED","Cannot call %s after a stream was destroyed",Error),b("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),b("ERR_STREAM_PREMATURE_CLOSE","Premature close",Error),b("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF",Error),b("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event",Error),b("ERR_STREAM_WRITE_AFTER_END","write after end",Error),b("ERR_UNKNOWN_ENCODING","Unknown encoding: %s",TypeError),f.exports={AbortError:I,aggregateTwoErrors:_(E),hideStackFrames:_,codes:u}}),br=be((s,f)=>{ue(),ce(),he();var{AbortController:n,AbortSignal:a}=typeof self<"u"?self:typeof window<"u"?window:void 0;f.exports=n,f.exports.AbortSignal=a,f.exports.default=n});function je(){je.init.call(this)}function Rr(s){if(typeof s!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof s)}function xo(s){return s._maxListeners===void 0?je.defaultMaxListeners:s._maxListeners}function qn(s,f,n,a){var c,r,e,i;if(Rr(n),(r=s._events)===void 0?(r=s._events=Object.create(null),s._eventsCount=0):(r.newListener!==void 0&&(s.emit("newListener",f,n.listener?n.listener:n),r=s._events),e=r[f]),e===void 0)e=r[f]=n,++s._eventsCount;else if(typeof e=="function"?e=r[f]=a?[n,e]:[e,n]:a?e.unshift(n):e.push(n),(c=xo(s))>0&&e.length>c&&!e.warned){e.warned=!0;var t=new Error("Possible EventEmitter memory leak detected. "+e.length+" "+String(f)+" listeners added. Use emitter.setMaxListeners() to increase limit");t.name="MaxListenersExceededWarning",t.emitter=s,t.type=f,t.count=e.length,i=t,console&&console.warn&&console.warn(i)}return s}function Ia(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function Hn(s,f,n){var a={fired:!1,wrapFn:void 0,target:s,type:f,listener:n},c=Ia.bind(a);return c.listener=n,a.wrapFn=c,c}function Vn(s,f,n){var a=s._events;if(a===void 0)return[];var c=a[f];return c===void 0?[]:typeof c=="function"?n?[c.listener||c]:[c]:n?function(r){for(var e=new Array(r.length),i=0;i<e.length;++i)e[i]=r[i].listener||r[i];return e}(c):Bo(c,c.length)}function zn(s){var f=this._events;if(f!==void 0){var n=f[s];if(typeof n=="function")return 1;if(n!==void 0)return n.length}return 0}function Bo(s,f){for(var n=new Array(f),a=0;a<f;++a)n[a]=s[a];return n}var Gn,Qn,$t,Yr,Jr,Xr,ut,Kn=nt(()=>{ue(),ce(),he(),$t=typeof Reflect=="object"?Reflect:null,Yr=$t&&typeof $t.apply=="function"?$t.apply:function(s,f,n){return Function.prototype.apply.call(s,f,n)},Qn=$t&&typeof $t.ownKeys=="function"?$t.ownKeys:Object.getOwnPropertySymbols?function(s){return Object.getOwnPropertyNames(s).concat(Object.getOwnPropertySymbols(s))}:function(s){return Object.getOwnPropertyNames(s)},Jr=Number.isNaN||function(s){return s!=s},Gn=je,je.EventEmitter=je,je.prototype._events=void 0,je.prototype._eventsCount=0,je.prototype._maxListeners=void 0,Xr=10,Object.defineProperty(je,"defaultMaxListeners",{enumerable:!0,get:function(){return Xr},set:function(s){if(typeof s!="number"||s<0||Jr(s))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+s+".");Xr=s}}),je.init=function(){this._events!==void 0&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},je.prototype.setMaxListeners=function(s){if(typeof s!="number"||s<0||Jr(s))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+s+".");return this._maxListeners=s,this},je.prototype.getMaxListeners=function(){return xo(this)},je.prototype.emit=function(s){for(var f=[],n=1;n<arguments.length;n++)f.push(arguments[n]);var a=s==="error",c=this._events;if(c!==void 0)a=a&&c.error===void 0;else if(!a)return!1;if(a){var r;if(f.length>0&&(r=f[0]),r instanceof Error)throw r;var e=new Error("Unhandled error."+(r?" ("+r.message+")":""));throw e.context=r,e}var i=c[s];if(i===void 0)return!1;if(typeof i=="function")Yr(i,this,f);else{var t=i.length,o=Bo(i,t);for(n=0;n<t;++n)Yr(o[n],this,f)}return!0},je.prototype.addListener=function(s,f){return qn(this,s,f,!1)},je.prototype.on=je.prototype.addListener,je.prototype.prependListener=function(s,f){return qn(this,s,f,!0)},je.prototype.once=function(s,f){return Rr(f),this.on(s,Hn(this,s,f)),this},je.prototype.prependOnceListener=function(s,f){return Rr(f),this.prependListener(s,Hn(this,s,f)),this},je.prototype.removeListener=function(s,f){var n,a,c,r,e;if(Rr(f),(a=this._events)===void 0)return this;if((n=a[s])===void 0)return this;if(n===f||n.listener===f)--this._eventsCount==0?this._events=Object.create(null):(delete a[s],a.removeListener&&this.emit("removeListener",s,n.listener||f));else if(typeof n!="function"){for(c=-1,r=n.length-1;r>=0;r--)if(n[r]===f||n[r].listener===f){e=n[r].listener,c=r;break}if(c<0)return this;c===0?n.shift():function(i,t){for(;t+1<i.length;t++)i[t]=i[t+1];i.pop()}(n,c),n.length===1&&(a[s]=n[0]),a.removeListener!==void 0&&this.emit("removeListener",s,e||f)}return this},je.prototype.off=je.prototype.removeListener,je.prototype.removeAllListeners=function(s){var f,n,a;if((n=this._events)===void 0)return this;if(n.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):n[s]!==void 0&&(--this._eventsCount==0?this._events=Object.create(null):delete n[s]),this;if(arguments.length===0){var c,r=Object.keys(n);for(a=0;a<r.length;++a)(c=r[a])!=="removeListener"&&this.removeAllListeners(c);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(typeof(f=n[s])=="function")this.removeListener(s,f);else if(f!==void 0)for(a=f.length-1;a>=0;a--)this.removeListener(s,f[a]);return this},je.prototype.listeners=function(s){return Vn(this,s,!0)},je.prototype.rawListeners=function(s){return Vn(this,s,!1)},je.listenerCount=function(s,f){return typeof s.listenerCount=="function"?s.listenerCount(f):zn.call(s,f)},je.prototype.listenerCount=zn,je.prototype.eventNames=function(){return this._eventsCount>0?Qn(this._events):[]},ut=Gn,ut.EventEmitter,ut.defaultMaxListeners,ut.init,ut.listenerCount,ut.EventEmitter,ut.defaultMaxListeners,ut.init,ut.listenerCount}),jt={};nr(jt,{EventEmitter:()=>Lo,default:()=>ut,defaultMaxListeners:()=>Uo,init:()=>jo,listenerCount:()=>No,on:()=>Do,once:()=>Fo});var Lo,Uo,jo,No,Do,Fo,Xt=nt(()=>{ue(),ce(),he(),Kn(),Kn(),ut.once=function(s,f){return new Promise((n,a)=>{function c(...e){r!==void 0&&s.removeListener("error",r),n(e)}let r;f!=="error"&&(r=e=>{s.removeListener(name,c),a(e)},s.once("error",r)),s.once(f,c)})},ut.on=function(s,f){let n=[],a=[],c=null,r=!1,e={async next(){let o=n.shift();if(o)return createIterResult(o,!1);if(c){let u=Promise.reject(c);return c=null,u}return r?createIterResult(void 0,!0):new Promise((u,d)=>a.push({resolve:u,reject:d}))},async return(){s.removeListener(f,i),s.removeListener("error",t),r=!0;for(let o of a)o.resolve(createIterResult(void 0,!0));return createIterResult(void 0,!0)},throw(o){c=o,s.removeListener(f,i),s.removeListener("error",t)},[Symbol.asyncIterator](){return this}};return s.on(f,i),s.on("error",t),e;function i(...o){let u=a.shift();u?u.resolve(createIterResult(o,!1)):n.push(o)}function t(o){r=!0;let u=a.shift();u?u.reject(o):c=o,e.return()}},{EventEmitter:Lo,defaultMaxListeners:Uo,init:jo,listenerCount:No,on:Do,once:Fo}=ut}),at=be((s,f)=>{ue(),ce(),he();var n=(Je(),Ne(Ye)),{format:a,inspect:c}=Mo(),{codes:{ERR_INVALID_ARG_TYPE:r}}=ot(),{kResistStopPropagation:e,AggregateError:i,SymbolDispose:t}=Ve(),o=globalThis.AbortSignal||br().AbortSignal,u=globalThis.AbortController||br().AbortController,d=Object.getPrototypeOf(async function(){}).constructor,p=globalThis.Blob||n.Blob,m=typeof p<"u"?function(E){return E instanceof p}:function(E){return!1},b=(E,I)=>{if(E!==void 0&&(E===null||typeof E!="object"||!("aborted"in E)))throw new r(I,"AbortSignal",E)},_=(E,I)=>{if(typeof E!="function")throw new r(I,"Function",E)};f.exports={AggregateError:i,kEmptyObject:Object.freeze({}),once(E){let I=!1;return function(...y){I||(I=!0,E.apply(this,y))}},createDeferredPromise:function(){let E,I;return{promise:new Promise((y,v)=>{E=y,I=v}),resolve:E,reject:I}},promisify(E){return new Promise((I,y)=>{E((v,...j)=>v?y(v):I(...j))})},debuglog(){return function(){}},format:a,inspect:c,types:{isAsyncFunction(E){return E instanceof d},isArrayBufferView(E){return ArrayBuffer.isView(E)}},isBlob:m,deprecate(E,I){return E},addAbortListener:(Xt(),Ne(jt)).addAbortListener||function(E,I){if(E===void 0)throw new r("signal","AbortSignal",E);b(E,"signal"),_(I,"listener");let y;return E.aborted?queueMicrotask(()=>I()):(E.addEventListener("abort",I,{__proto__:null,once:!0,[e]:!0}),y=()=>{E.removeEventListener("abort",I)}),{__proto__:null,[t](){var v;(v=y)===null||v===void 0||v()}}},AbortSignalAny:o.any||function(E){if(E.length===1)return E[0];let I=new u,y=()=>I.abort();return E.forEach(v=>{b(v,"signals"),v.addEventListener("abort",y,{once:!0})}),I.signal.addEventListener("abort",()=>{E.forEach(v=>v.removeEventListener("abort",y))},{once:!0}),I.signal}},f.exports.promisify.custom=Symbol.for("nodejs.util.promisify.custom")}),_r=be((s,f)=>{ue(),ce(),he();var{ArrayIsArray:n,ArrayPrototypeIncludes:a,ArrayPrototypeJoin:c,ArrayPrototypeMap:r,NumberIsInteger:e,NumberIsNaN:i,NumberMAX_SAFE_INTEGER:t,NumberMIN_SAFE_INTEGER:o,NumberParseInt:u,ObjectPrototypeHasOwnProperty:d,RegExpPrototypeExec:p,String:m,StringPrototypeToUpperCase:b,StringPrototypeTrim:_}=Ve(),{hideStackFrames:E,codes:{ERR_SOCKET_BAD_PORT:I,ERR_INVALID_ARG_TYPE:y,ERR_INVALID_ARG_VALUE:v,ERR_OUT_OF_RANGE:j,ERR_UNKNOWN_SIGNAL:x}}=ot(),{normalizeEncoding:A}=at(),{isAsyncFunction:T,isArrayBufferView:B}=at().types,Y={};function X(F){return F===(F|0)}function ae(F){return F===F>>>0}var P=/^[0-7]+$/,Q="must be a 32-bit unsigned integer or an octal string";function J(F,oe,ye){if(typeof F>"u"&&(F=ye),typeof F=="string"){if(p(P,F)===null)throw new v(oe,F,Q);F=u(F,8)}return de(F,oe),F}var W=E((F,oe,ye=o,ee=t)=>{if(typeof F!="number")throw new y(oe,"number",F);if(!e(F))throw new j(oe,"an integer",F);if(F<ye||F>ee)throw new j(oe,`>= ${ye} && <= ${ee}`,F)}),me=E((F,oe,ye=-2147483648,ee=2147483647)=>{if(typeof F!="number")throw new y(oe,"number",F);if(!e(F))throw new j(oe,"an integer",F);if(F<ye||F>ee)throw new j(oe,`>= ${ye} && <= ${ee}`,F)}),de=E((F,oe,ye=!1)=>{if(typeof F!="number")throw new y(oe,"number",F);if(!e(F))throw new j(oe,"an integer",F);let ee=ye?1:0,Pe=4294967295;if(F<ee||F>Pe)throw new j(oe,`>= ${ee} && <= ${Pe}`,F)});function ge(F,oe){if(typeof F!="string")throw new y(oe,"string",F)}function _e(F,oe,ye=void 0,ee){if(typeof F!="number")throw new y(oe,"number",F);if(ye!=null&&F<ye||ee!=null&&F>ee||(ye!=null||ee!=null)&&i(F))throw new j(oe,`${ye!=null?`>= ${ye}`:""}${ye!=null&&ee!=null?" && ":""}${ee!=null?`<= ${ee}`:""}`,F)}var G=E((F,oe,ye)=>{if(!a(ye,F)){let ee="must be one of: "+c(r(ye,Pe=>typeof Pe=="string"?`'${Pe}'`:m(Pe)),", ");throw new v(oe,F,ee)}});function fe(F,oe){if(typeof F!="boolean")throw new y(oe,"boolean",F)}function C(F,oe,ye){return F==null||!d(F,oe)?ye:F[oe]}var re=E((F,oe,ye=null)=>{let ee=C(ye,"allowArray",!1),Pe=C(ye,"allowFunction",!1);if(!C(ye,"nullable",!1)&&F===null||!ee&&n(F)||typeof F!="object"&&(!Pe||typeof F!="function"))throw new y(oe,"Object",F)}),pe=E((F,oe)=>{if(F!=null&&typeof F!="object"&&typeof F!="function")throw new y(oe,"a dictionary",F)}),N=E((F,oe,ye=0)=>{if(!n(F))throw new y(oe,"Array",F);if(F.length<ye){let ee=`must be longer than ${ye}`;throw new v(oe,F,ee)}});function Ae(F,oe){N(F,oe);for(let ye=0;ye<F.length;ye++)ge(F[ye],`${oe}[${ye}]`)}function V(F,oe){N(F,oe);for(let ye=0;ye<F.length;ye++)fe(F[ye],`${oe}[${ye}]`)}function L(F,oe){N(F,oe);for(let ye=0;ye<F.length;ye++){let ee=F[ye],Pe=`${oe}[${ye}]`;if(ee==null)throw new y(Pe,"AbortSignal",ee);se(ee,Pe)}}function Z(F,oe="signal"){if(ge(F,oe),Y[F]===void 0)throw Y[b(F)]!==void 0?new x(F+" (signals must use all capital letters)"):new x(F)}var $=E((F,oe="buffer")=>{if(!B(F))throw new y(oe,["Buffer","TypedArray","DataView"],F)});function q(F,oe){let ye=A(oe),ee=F.length;if(ye==="hex"&&ee%2!==0)throw new v("encoding",oe,`is invalid for data of length ${ee}`)}function H(F,oe="Port",ye=!0){if(typeof F!="number"&&typeof F!="string"||typeof F=="string"&&_(F).length===0||+F!==+F>>>0||F>65535||F===0&&!ye)throw new I(oe,F,ye);return F|0}var se=E((F,oe)=>{if(F!==void 0&&(F===null||typeof F!="object"||!("aborted"in F)))throw new y(oe,"AbortSignal",F)}),ie=E((F,oe)=>{if(typeof F!="function")throw new y(oe,"Function",F)}),M=E((F,oe)=>{if(typeof F!="function"||T(F))throw new y(oe,"Function",F)}),D=E((F,oe)=>{if(F!==void 0)throw new y(oe,"undefined",F)});function K(F,oe,ye){if(!a(ye,F))throw new y(oe,`('${c(ye,"|")}')`,F)}var ne=/^(?:<[^>]*>)(?:\s*;\s*[^;"\s]+(?:=(")?[^;"\s]*\1)?)*$/;function te(F,oe){if(typeof F>"u"||!p(ne,F))throw new v(oe,F,'must be an array or string of format "</styles.css>; rel=preload; as=style"')}function le(F){if(typeof F=="string")return te(F,"hints"),F;if(n(F)){let oe=F.length,ye="";if(oe===0)return ye;for(let ee=0;ee<oe;ee++){let Pe=F[ee];te(Pe,"hints"),ye+=Pe,ee!==oe-1&&(ye+=", ")}return ye}throw new v("hints",F,'must be an array or string of format "</styles.css>; rel=preload; as=style"')}f.exports={isInt32:X,isUint32:ae,parseFileMode:J,validateArray:N,validateStringArray:Ae,validateBooleanArray:V,validateAbortSignalArray:L,validateBoolean:fe,validateBuffer:$,validateDictionary:pe,validateEncoding:q,validateFunction:ie,validateInt32:me,validateInteger:W,validateNumber:_e,validateObject:re,validateOneOf:G,validatePlainFunction:M,validatePort:H,validateSignalName:Z,validateString:ge,validateUint32:de,validateUndefined:D,validateUnion:K,validateAbortSignal:se,validateLinkHeaderValue:le}}),Zt=be((s,f)=>{ue(),ce(),he();var n=f.exports={},a,c;function r(){throw new Error("setTimeout has not been defined")}function e(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?a=setTimeout:a=r}catch{a=r}try{typeof clearTimeout=="function"?c=clearTimeout:c=e}catch{c=e}})();function i(I){if(a===setTimeout)return setTimeout(I,0);if((a===r||!a)&&setTimeout)return a=setTimeout,setTimeout(I,0);try{return a(I,0)}catch{try{return a.call(null,I,0)}catch{return a.call(this,I,0)}}}function t(I){if(c===clearTimeout)return clearTimeout(I);if((c===e||!c)&&clearTimeout)return c=clearTimeout,clearTimeout(I);try{return c(I)}catch{try{return c.call(null,I)}catch{return c.call(this,I)}}}var o=[],u=!1,d,p=-1;function m(){!u||!d||(u=!1,d.length?o=d.concat(o):p=-1,o.length&&b())}function b(){if(!u){var I=i(m);u=!0;for(var y=o.length;y;){for(d=o,o=[];++p<y;)d&&d[p].run();p=-1,y=o.length}d=null,u=!1,t(I)}}n.nextTick=function(I){var y=new Array(arguments.length-1);if(arguments.length>1)for(var v=1;v<arguments.length;v++)y[v-1]=arguments[v];o.push(new _(I,y)),o.length===1&&!u&&i(b)};function _(I,y){this.fun=I,this.array=y}_.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={};function E(){}n.on=E,n.addListener=E,n.once=E,n.off=E,n.removeListener=E,n.removeAllListeners=E,n.emit=E,n.prependListener=E,n.prependOnceListener=E,n.listeners=function(I){return[]},n.binding=function(I){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(I){throw new Error("process.chdir is not supported")},n.umask=function(){return 0}}),Tt=be((s,f)=>{ue(),ce(),he();var{SymbolAsyncIterator:n,SymbolIterator:a,SymbolFor:c}=Ve(),r=c("nodejs.stream.destroyed"),e=c("nodejs.stream.errored"),i=c("nodejs.stream.readable"),t=c("nodejs.stream.writable"),o=c("nodejs.stream.disturbed"),u=c("nodejs.webstream.isClosedPromise"),d=c("nodejs.webstream.controllerErrorFunction");function p(C,re=!1){var pe;return!!(C&&typeof C.pipe=="function"&&typeof C.on=="function"&&(!re||typeof C.pause=="function"&&typeof C.resume=="function")&&(!C._writableState||((pe=C._readableState)===null||pe===void 0?void 0:pe.readable)!==!1)&&(!C._writableState||C._readableState))}function m(C){var re;return!!(C&&typeof C.write=="function"&&typeof C.on=="function"&&(!C._readableState||((re=C._writableState)===null||re===void 0?void 0:re.writable)!==!1))}function b(C){return!!(C&&typeof C.pipe=="function"&&C._readableState&&typeof C.on=="function"&&typeof C.write=="function")}function _(C){return C&&(C._readableState||C._writableState||typeof C.write=="function"&&typeof C.on=="function"||typeof C.pipe=="function"&&typeof C.on=="function")}function E(C){return!!(C&&!_(C)&&typeof C.pipeThrough=="function"&&typeof C.getReader=="function"&&typeof C.cancel=="function")}function I(C){return!!(C&&!_(C)&&typeof C.getWriter=="function"&&typeof C.abort=="function")}function y(C){return!!(C&&!_(C)&&typeof C.readable=="object"&&typeof C.writable=="object")}function v(C){return E(C)||I(C)||y(C)}function j(C,re){return C==null?!1:re===!0?typeof C[n]=="function":re===!1?typeof C[a]=="function":typeof C[n]=="function"||typeof C[a]=="function"}function x(C){if(!_(C))return null;let re=C._writableState,pe=C._readableState,N=re||pe;return!!(C.destroyed||C[r]||N!=null&&N.destroyed)}function A(C){if(!m(C))return null;if(C.writableEnded===!0)return!0;let re=C._writableState;return re!=null&&re.errored?!1:typeof(re==null?void 0:re.ended)!="boolean"?null:re.ended}function T(C,re){if(!m(C))return null;if(C.writableFinished===!0)return!0;let pe=C._writableState;return pe!=null&&pe.errored?!1:typeof(pe==null?void 0:pe.finished)!="boolean"?null:!!(pe.finished||re===!1&&pe.ended===!0&&pe.length===0)}function B(C){if(!p(C))return null;if(C.readableEnded===!0)return!0;let re=C._readableState;return!re||re.errored?!1:typeof(re==null?void 0:re.ended)!="boolean"?null:re.ended}function Y(C,re){if(!p(C))return null;let pe=C._readableState;return pe!=null&&pe.errored?!1:typeof(pe==null?void 0:pe.endEmitted)!="boolean"?null:!!(pe.endEmitted||re===!1&&pe.ended===!0&&pe.length===0)}function X(C){return C&&C[i]!=null?C[i]:typeof(C==null?void 0:C.readable)!="boolean"?null:x(C)?!1:p(C)&&C.readable&&!Y(C)}function ae(C){return C&&C[t]!=null?C[t]:typeof(C==null?void 0:C.writable)!="boolean"?null:x(C)?!1:m(C)&&C.writable&&!A(C)}function P(C,re){return _(C)?x(C)?!0:!((re==null?void 0:re.readable)!==!1&&X(C)||(re==null?void 0:re.writable)!==!1&&ae(C)):null}function Q(C){var re,pe;return _(C)?C.writableErrored?C.writableErrored:(re=(pe=C._writableState)===null||pe===void 0?void 0:pe.errored)!==null&&re!==void 0?re:null:null}function J(C){var re,pe;return _(C)?C.readableErrored?C.readableErrored:(re=(pe=C._readableState)===null||pe===void 0?void 0:pe.errored)!==null&&re!==void 0?re:null:null}function W(C){if(!_(C))return null;if(typeof C.closed=="boolean")return C.closed;let re=C._writableState,pe=C._readableState;return typeof(re==null?void 0:re.closed)=="boolean"||typeof(pe==null?void 0:pe.closed)=="boolean"?(re==null?void 0:re.closed)||(pe==null?void 0:pe.closed):typeof C._closed=="boolean"&&me(C)?C._closed:null}function me(C){return typeof C._closed=="boolean"&&typeof C._defaultKeepAlive=="boolean"&&typeof C._removedConnection=="boolean"&&typeof C._removedContLen=="boolean"}function de(C){return typeof C._sent100=="boolean"&&me(C)}function ge(C){var re;return typeof C._consuming=="boolean"&&typeof C._dumped=="boolean"&&((re=C.req)===null||re===void 0?void 0:re.upgradeOrConnect)===void 0}function _e(C){if(!_(C))return null;let re=C._writableState,pe=C._readableState,N=re||pe;return!N&&de(C)||!!(N&&N.autoDestroy&&N.emitClose&&N.closed===!1)}function G(C){var re;return!!(C&&((re=C[o])!==null&&re!==void 0?re:C.readableDidRead||C.readableAborted))}function fe(C){var re,pe,N,Ae,V,L,Z,$,q,H;return!!(C&&((re=(pe=(N=(Ae=(V=(L=C[e])!==null&&L!==void 0?L:C.readableErrored)!==null&&V!==void 0?V:C.writableErrored)!==null&&Ae!==void 0?Ae:(Z=C._readableState)===null||Z===void 0?void 0:Z.errorEmitted)!==null&&N!==void 0?N:($=C._writableState)===null||$===void 0?void 0:$.errorEmitted)!==null&&pe!==void 0?pe:(q=C._readableState)===null||q===void 0?void 0:q.errored)!==null&&re!==void 0?re:!((H=C._writableState)===null||H===void 0)&&H.errored))}f.exports={isDestroyed:x,kIsDestroyed:r,isDisturbed:G,kIsDisturbed:o,isErrored:fe,kIsErrored:e,isReadable:X,kIsReadable:i,kIsClosedPromise:u,kControllerErrorFunction:d,kIsWritable:t,isClosed:W,isDuplexNodeStream:b,isFinished:P,isIterable:j,isReadableNodeStream:p,isReadableStream:E,isReadableEnded:B,isReadableFinished:Y,isReadableErrored:J,isNodeStream:_,isWebStream:v,isWritable:ae,isWritableNodeStream:m,isWritableStream:I,isWritableEnded:A,isWritableFinished:T,isWritableErrored:Q,isServerRequest:ge,isServerResponse:de,willEmitClose:_e,isTransformStream:y}}),Nt=be((s,f)=>{ue(),ce(),he();var n=Zt(),{AbortError:a,codes:c}=ot(),{ERR_INVALID_ARG_TYPE:r,ERR_STREAM_PREMATURE_CLOSE:e}=c,{kEmptyObject:i,once:t}=at(),{validateAbortSignal:o,validateFunction:u,validateObject:d,validateBoolean:p}=_r(),{Promise:m,PromisePrototypeThen:b,SymbolDispose:_}=Ve(),{isClosed:E,isReadable:I,isReadableNodeStream:y,isReadableStream:v,isReadableFinished:j,isReadableErrored:x,isWritable:A,isWritableNodeStream:T,isWritableStream:B,isWritableFinished:Y,isWritableErrored:X,isNodeStream:ae,willEmitClose:P,kIsClosedPromise:Q}=Tt(),J;function W(G){return G.setHeader&&typeof G.abort=="function"}var me=()=>{};function de(G,fe,C){var re,pe;if(arguments.length===2?(C=fe,fe=i):fe==null?fe=i:d(fe,"options"),u(C,"callback"),o(fe.signal,"options.signal"),C=t(C),v(G)||B(G))return ge(G,fe,C);if(!ae(G))throw new r("stream",["ReadableStream","WritableStream","Stream"],G);let N=(re=fe.readable)!==null&&re!==void 0?re:y(G),Ae=(pe=fe.writable)!==null&&pe!==void 0?pe:T(G),V=G._writableState,L=G._readableState,Z=()=>{G.writable||H()},$=P(G)&&y(G)===N&&T(G)===Ae,q=Y(G,!1),H=()=>{q=!0,G.destroyed&&($=!1),!($&&(!G.readable||N))&&(!N||se)&&C.call(G)},se=j(G,!1),ie=()=>{se=!0,G.destroyed&&($=!1),!($&&(!G.writable||Ae))&&(!Ae||q)&&C.call(G)},M=F=>{C.call(G,F)},D=E(G),K=()=>{D=!0;let F=X(G)||x(G);if(F&&typeof F!="boolean")return C.call(G,F);if(N&&!se&&y(G,!0)&&!j(G,!1))return C.call(G,new e);if(Ae&&!q&&!Y(G,!1))return C.call(G,new e);C.call(G)},ne=()=>{D=!0;let F=X(G)||x(G);if(F&&typeof F!="boolean")return C.call(G,F);C.call(G)},te=()=>{G.req.on("finish",H)};W(G)?(G.on("complete",H),$||G.on("abort",K),G.req?te():G.on("request",te)):Ae&&!V&&(G.on("end",Z),G.on("close",Z)),!$&&typeof G.aborted=="boolean"&&G.on("aborted",K),G.on("end",ie),G.on("finish",H),fe.error!==!1&&G.on("error",M),G.on("close",K),D?n.nextTick(K):V!=null&&V.errorEmitted||L!=null&&L.errorEmitted?$||n.nextTick(ne):(!N&&(!$||I(G))&&(q||A(G)===!1)||!Ae&&(!$||A(G))&&(se||I(G)===!1)||L&&G.req&&G.aborted)&&n.nextTick(ne);let le=()=>{C=me,G.removeListener("aborted",K),G.removeListener("complete",H),G.removeListener("abort",K),G.removeListener("request",te),G.req&&G.req.removeListener("finish",H),G.removeListener("end",Z),G.removeListener("close",Z),G.removeListener("finish",H),G.removeListener("end",ie),G.removeListener("error",M),G.removeListener("close",K)};if(fe.signal&&!D){let F=()=>{let oe=C;le(),oe.call(G,new a(void 0,{cause:fe.signal.reason}))};if(fe.signal.aborted)n.nextTick(F);else{J=J||at().addAbortListener;let oe=J(fe.signal,F),ye=C;C=t((...ee)=>{oe[_](),ye.apply(G,ee)})}}return le}function ge(G,fe,C){let re=!1,pe=me;if(fe.signal)if(pe=()=>{re=!0,C.call(G,new a(void 0,{cause:fe.signal.reason}))},fe.signal.aborted)n.nextTick(pe);else{J=J||at().addAbortListener;let Ae=J(fe.signal,pe),V=C;C=t((...L)=>{Ae[_](),V.apply(G,L)})}let N=(...Ae)=>{re||n.nextTick(()=>C.apply(G,Ae))};return b(G[Q].promise,N,N),me}function _e(G,fe){var C;let re=!1;return fe===null&&(fe=i),(C=fe)!==null&&C!==void 0&&C.cleanup&&(p(fe.cleanup,"cleanup"),re=fe.cleanup),new m((pe,N)=>{let Ae=de(G,fe,V=>{re&&Ae(),V?N(V):pe()})})}f.exports=de,f.exports.finished=_e}),or=be((s,f)=>{ue(),ce(),he();var n=Zt(),{aggregateTwoErrors:a,codes:{ERR_MULTIPLE_CALLBACK:c},AbortError:r}=ot(),{Symbol:e}=Ve(),{kIsDestroyed:i,isDestroyed:t,isFinished:o,isServerRequest:u}=Tt(),d=e("kDestroy"),p=e("kConstruct");function m(P,Q,J){P&&(P.stack,Q&&!Q.errored&&(Q.errored=P),J&&!J.errored&&(J.errored=P))}function b(P,Q){let J=this._readableState,W=this._writableState,me=W||J;return W!=null&&W.destroyed||J!=null&&J.destroyed?(typeof Q=="function"&&Q(),this):(m(P,W,J),W&&(W.destroyed=!0),J&&(J.destroyed=!0),me.constructed?_(this,P,Q):this.once(d,function(de){_(this,a(de,P),Q)}),this)}function _(P,Q,J){let W=!1;function me(de){if(W)return;W=!0;let ge=P._readableState,_e=P._writableState;m(de,_e,ge),_e&&(_e.closed=!0),ge&&(ge.closed=!0),typeof J=="function"&&J(de),de?n.nextTick(E,P,de):n.nextTick(I,P)}try{P._destroy(Q||null,me)}catch(de){me(de)}}function E(P,Q){y(P,Q),I(P)}function I(P){let Q=P._readableState,J=P._writableState;J&&(J.closeEmitted=!0),Q&&(Q.closeEmitted=!0),(J!=null&&J.emitClose||Q!=null&&Q.emitClose)&&P.emit("close")}function y(P,Q){let J=P._readableState,W=P._writableState;W!=null&&W.errorEmitted||J!=null&&J.errorEmitted||(W&&(W.errorEmitted=!0),J&&(J.errorEmitted=!0),P.emit("error",Q))}function v(){let P=this._readableState,Q=this._writableState;P&&(P.constructed=!0,P.closed=!1,P.closeEmitted=!1,P.destroyed=!1,P.errored=null,P.errorEmitted=!1,P.reading=!1,P.ended=P.readable===!1,P.endEmitted=P.readable===!1),Q&&(Q.constructed=!0,Q.destroyed=!1,Q.closed=!1,Q.closeEmitted=!1,Q.errored=null,Q.errorEmitted=!1,Q.finalCalled=!1,Q.prefinished=!1,Q.ended=Q.writable===!1,Q.ending=Q.writable===!1,Q.finished=Q.writable===!1)}function j(P,Q,J){let W=P._readableState,me=P._writableState;if(me!=null&&me.destroyed||W!=null&&W.destroyed)return this;W!=null&&W.autoDestroy||me!=null&&me.autoDestroy?P.destroy(Q):Q&&(Q.stack,me&&!me.errored&&(me.errored=Q),W&&!W.errored&&(W.errored=Q),J?n.nextTick(y,P,Q):y(P,Q))}function x(P,Q){if(typeof P._construct!="function")return;let J=P._readableState,W=P._writableState;J&&(J.constructed=!1),W&&(W.constructed=!1),P.once(p,Q),!(P.listenerCount(p)>1)&&n.nextTick(A,P)}function A(P){let Q=!1;function J(W){if(Q){j(P,W??new c);return}Q=!0;let me=P._readableState,de=P._writableState,ge=de||me;me&&(me.constructed=!0),de&&(de.constructed=!0),ge.destroyed?P.emit(d,W):W?j(P,W,!0):n.nextTick(T,P)}try{P._construct(W=>{n.nextTick(J,W)})}catch(W){n.nextTick(J,W)}}function T(P){P.emit(p)}function B(P){return(P==null?void 0:P.setHeader)&&typeof P.abort=="function"}function Y(P){P.emit("close")}function X(P,Q){P.emit("error",Q),n.nextTick(Y,P)}function ae(P,Q){!P||t(P)||(!Q&&!o(P)&&(Q=new r),u(P)?(P.socket=null,P.destroy(Q)):B(P)?P.abort():B(P.req)?P.req.abort():typeof P.destroy=="function"?P.destroy(Q):typeof P.close=="function"?P.close():Q?n.nextTick(X,P,Q):n.nextTick(Y,P),P.destroyed||(P[i]=!0))}f.exports={construct:x,destroyer:ae,destroy:b,undestroy:v,errorOrDestroy:j}}),Pn=be((s,f)=>{ue(),ce(),he();var{ArrayIsArray:n,ObjectSetPrototypeOf:a}=Ve(),{EventEmitter:c}=(Xt(),Ne(jt));function r(i){c.call(this,i)}a(r.prototype,c.prototype),a(r,c),r.prototype.pipe=function(i,t){let o=this;function u(I){i.writable&&i.write(I)===!1&&o.pause&&o.pause()}o.on("data",u);function d(){o.readable&&o.resume&&o.resume()}i.on("drain",d),!i._isStdio&&(!t||t.end!==!1)&&(o.on("end",m),o.on("close",b));let p=!1;function m(){p||(p=!0,i.end())}function b(){p||(p=!0,typeof i.destroy=="function"&&i.destroy())}function _(I){E(),c.listenerCount(this,"error")===0&&this.emit("error",I)}e(o,"error",_),e(i,"error",_);function E(){o.removeListener("data",u),i.removeListener("drain",d),o.removeListener("end",m),o.removeListener("close",b),o.removeListener("error",_),i.removeListener("error",_),o.removeListener("end",E),o.removeListener("close",E),i.removeListener("close",E)}return o.on("end",E),o.on("close",E),i.on("close",E),i.emit("pipe",o),i};function e(i,t,o){if(typeof i.prependListener=="function")return i.prependListener(t,o);!i._events||!i._events[t]?i.on(t,o):n(i._events[t])?i._events[t].unshift(o):i._events[t]=[o,i._events[t]]}f.exports={Stream:r,prependListener:e}}),Dr=be((s,f)=>{ue(),ce(),he();var{SymbolDispose:n}=Ve(),{AbortError:a,codes:c}=ot(),{isNodeStream:r,isWebStream:e,kControllerErrorFunction:i}=Tt(),t=Nt(),{ERR_INVALID_ARG_TYPE:o}=c,u,d=(p,m)=>{if(typeof p!="object"||!("aborted"in p))throw new o(m,"AbortSignal",p)};f.exports.addAbortSignal=function(p,m){if(d(p,"signal"),!r(m)&&!e(m))throw new o("stream",["ReadableStream","WritableStream","Stream"],m);return f.exports.addAbortSignalNoValidate(p,m)},f.exports.addAbortSignalNoValidate=function(p,m){if(typeof p!="object"||!("aborted"in p))return m;let b=r(m)?()=>{m.destroy(new a(void 0,{cause:p.reason}))}:()=>{m[i](new a(void 0,{cause:p.reason}))};if(p.aborted)b();else{u=u||at().addAbortListener;let _=u(p,b);t(m,_[n])}return m}}),ka=be((s,f)=>{ue(),ce(),he();var{StringPrototypeSlice:n,SymbolIterator:a,TypedArrayPrototypeSet:c,Uint8Array:r}=Ve(),{Buffer:e}=(Je(),Ne(Ye)),{inspect:i}=at();f.exports=class{constructor(){this.head=null,this.tail=null,this.length=0}push(t){let o={data:t,next:null};this.length>0?this.tail.next=o:this.head=o,this.tail=o,++this.length}unshift(t){let o={data:t,next:this.head};this.length===0&&(this.tail=o),this.head=o,++this.length}shift(){if(this.length===0)return;let t=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,t}clear(){this.head=this.tail=null,this.length=0}join(t){if(this.length===0)return"";let o=this.head,u=""+o.data;for(;(o=o.next)!==null;)u+=t+o.data;return u}concat(t){if(this.length===0)return e.alloc(0);let o=e.allocUnsafe(t>>>0),u=this.head,d=0;for(;u;)c(o,u.data,d),d+=u.data.length,u=u.next;return o}consume(t,o){let u=this.head.data;if(t<u.length){let d=u.slice(0,t);return this.head.data=u.slice(t),d}return t===u.length?this.shift():o?this._getString(t):this._getBuffer(t)}first(){return this.head.data}*[a](){for(let t=this.head;t;t=t.next)yield t.data}_getString(t){let o="",u=this.head,d=0;do{let p=u.data;if(t>p.length)o+=p,t-=p.length;else{t===p.length?(o+=p,++d,u.next?this.head=u.next:this.head=this.tail=null):(o+=n(p,0,t),this.head=u,u.data=n(p,t));break}++d}while((u=u.next)!==null);return this.length-=d,o}_getBuffer(t){let o=e.allocUnsafe(t),u=t,d=this.head,p=0;do{let m=d.data;if(t>m.length)c(o,m,u-t),t-=m.length;else{t===m.length?(c(o,m,u-t),++p,d.next?this.head=d.next:this.head=this.tail=null):(c(o,new r(m.buffer,m.byteOffset,t),u-t),this.head=d,d.data=m.slice(t));break}++p}while((d=d.next)!==null);return this.length-=p,o}[Symbol.for("nodejs.util.inspect.custom")](t,o){return i(this,{...o,depth:0,customInspect:!1})}}}),Fr=be((s,f)=>{ue(),ce(),he();var{MathFloor:n,NumberIsInteger:a}=Ve(),{validateInteger:c}=_r(),{ERR_INVALID_ARG_VALUE:r}=ot().codes,e=16*1024,i=16;function t(p,m,b){return p.highWaterMark!=null?p.highWaterMark:m?p[b]:null}function o(p){return p?i:e}function u(p,m){c(m,"value",0),p?i=m:e=m}function d(p,m,b,_){let E=t(m,_,b);if(E!=null){if(!a(E)||E<0){let I=_?`options.${b}`:"options.highWaterMark";throw new r(I,E)}return n(E)}return o(p.objectMode)}f.exports={getHighWaterMark:d,getDefaultHighWaterMark:o,setDefaultHighWaterMark:u}}),Ta=be((s,f)=>{ue(),ce(),he();var n=(Je(),Ne(Ye)),a=n.Buffer;function c(e,i){for(var t in e)i[t]=e[t]}a.from&&a.alloc&&a.allocUnsafe&&a.allocUnsafeSlow?f.exports=n:(c(n,s),s.Buffer=r);function r(e,i,t){return a(e,i,t)}r.prototype=Object.create(a.prototype),c(a,r),r.from=function(e,i,t){if(typeof e=="number")throw new TypeError("Argument must not be a number");return a(e,i,t)},r.alloc=function(e,i,t){if(typeof e!="number")throw new TypeError("Argument must be a number");var o=a(e);return i!==void 0?typeof t=="string"?o.fill(i,t):o.fill(i):o.fill(0),o},r.allocUnsafe=function(e){if(typeof e!="number")throw new TypeError("Argument must be a number");return a(e)},r.allocUnsafeSlow=function(e){if(typeof e!="number")throw new TypeError("Argument must be a number");return n.SlowBuffer(e)}}),Oa=be(s=>{ue(),ce(),he();var f=Ta().Buffer,n=f.isEncoding||function(y){switch(y=""+y,y&&y.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function a(y){if(!y)return"utf8";for(var v;;)switch(y){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return y;default:if(v)return;y=(""+y).toLowerCase(),v=!0}}function c(y){var v=a(y);if(typeof v!="string"&&(f.isEncoding===n||!n(y)))throw new Error("Unknown encoding: "+y);return v||y}s.StringDecoder=r;function r(y){this.encoding=c(y);var v;switch(this.encoding){case"utf16le":this.text=p,this.end=m,v=4;break;case"utf8":this.fillLast=o,v=4;break;case"base64":this.text=b,this.end=_,v=3;break;default:this.write=E,this.end=I;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=f.allocUnsafe(v)}r.prototype.write=function(y){if(y.length===0)return"";var v,j;if(this.lastNeed){if(v=this.fillLast(y),v===void 0)return"";j=this.lastNeed,this.lastNeed=0}else j=0;return j<y.length?v?v+this.text(y,j):this.text(y,j):v||""},r.prototype.end=d,r.prototype.text=u,r.prototype.fillLast=function(y){if(this.lastNeed<=y.length)return y.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);y.copy(this.lastChar,this.lastTotal-this.lastNeed,0,y.length),this.lastNeed-=y.length};function e(y){return y<=127?0:y>>5===6?2:y>>4===14?3:y>>3===30?4:y>>6===2?-1:-2}function i(y,v,j){var x=v.length-1;if(x<j)return 0;var A=e(v[x]);return A>=0?(A>0&&(y.lastNeed=A-1),A):--x<j||A===-2?0:(A=e(v[x]),A>=0?(A>0&&(y.lastNeed=A-2),A):--x<j||A===-2?0:(A=e(v[x]),A>=0?(A>0&&(A===2?A=0:y.lastNeed=A-3),A):0))}function t(y,v,j){if((v[0]&192)!==128)return y.lastNeed=0,"";if(y.lastNeed>1&&v.length>1){if((v[1]&192)!==128)return y.lastNeed=1,"";if(y.lastNeed>2&&v.length>2&&(v[2]&192)!==128)return y.lastNeed=2,""}}function o(y){var v=this.lastTotal-this.lastNeed,j=t(this,y);if(j!==void 0)return j;if(this.lastNeed<=y.length)return y.copy(this.lastChar,v,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);y.copy(this.lastChar,v,0,y.length),this.lastNeed-=y.length}function u(y,v){var j=i(this,y,v);if(!this.lastNeed)return y.toString("utf8",v);this.lastTotal=j;var x=y.length-(j-this.lastNeed);return y.copy(this.lastChar,0,x),y.toString("utf8",v,x)}function d(y){var v=y&&y.length?this.write(y):"";return this.lastNeed?v+"":v}function p(y,v){if((y.length-v)%2===0){var j=y.toString("utf16le",v);if(j){var x=j.charCodeAt(j.length-1);if(x>=55296&&x<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=y[y.length-2],this.lastChar[1]=y[y.length-1],j.slice(0,-1)}return j}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=y[y.length-1],y.toString("utf16le",v,y.length-1)}function m(y){var v=y&&y.length?this.write(y):"";if(this.lastNeed){var j=this.lastTotal-this.lastNeed;return v+this.lastChar.toString("utf16le",0,j)}return v}function b(y,v){var j=(y.length-v)%3;return j===0?y.toString("base64",v):(this.lastNeed=3-j,this.lastTotal=3,j===1?this.lastChar[0]=y[y.length-1]:(this.lastChar[0]=y[y.length-2],this.lastChar[1]=y[y.length-1]),y.toString("base64",v,y.length-j))}function _(y){var v=y&&y.length?this.write(y):"";return this.lastNeed?v+this.lastChar.toString("base64",0,3-this.lastNeed):v}function E(y){return y.toString(this.encoding)}function I(y){return y&&y.length?this.write(y):""}}),Wo=be((s,f)=>{ue(),ce(),he();var n=Zt(),{PromisePrototypeThen:a,SymbolAsyncIterator:c,SymbolIterator:r}=Ve(),{Buffer:e}=(Je(),Ne(Ye)),{ERR_INVALID_ARG_TYPE:i,ERR_STREAM_NULL_VALUES:t}=ot().codes;function o(u,d,p){let m;if(typeof d=="string"||d instanceof e)return new u({objectMode:!0,...p,read(){this.push(d),this.push(null)}});let b;if(d&&d[c])b=!0,m=d[c]();else if(d&&d[r])b=!1,m=d[r]();else throw new i("iterable",["Iterable"],d);let _=new u({objectMode:!0,highWaterMark:1,...p}),E=!1;_._read=function(){E||(E=!0,y())},_._destroy=function(v,j){a(I(v),()=>n.nextTick(j,v),x=>n.nextTick(j,x||v))};async function I(v){let j=v!=null,x=typeof m.throw=="function";if(j&&x){let{value:A,done:T}=await m.throw(v);if(await A,T)return}if(typeof m.return=="function"){let{value:A}=await m.return();await A}}async function y(){for(;;){try{let{value:v,done:j}=b?await m.next():m.next();if(j)_.push(null);else{let x=v&&typeof v.then=="function"?await v:v;if(x===null)throw E=!1,new t;if(_.push(x))continue;E=!1}}catch(v){_.destroy(v)}break}}return _}f.exports=o}),Wr=be((s,f)=>{ue(),ce(),he();var n=Zt(),{ArrayPrototypeIndexOf:a,NumberIsInteger:c,NumberIsNaN:r,NumberParseInt:e,ObjectDefineProperties:i,ObjectKeys:t,ObjectSetPrototypeOf:o,Promise:u,SafeSet:d,SymbolAsyncDispose:p,SymbolAsyncIterator:m,Symbol:b}=Ve();f.exports=ee,ee.ReadableState=ye;var{EventEmitter:_}=(Xt(),Ne(jt)),{Stream:E,prependListener:I}=Pn(),{Buffer:y}=(Je(),Ne(Ye)),{addAbortSignal:v}=Dr(),j=Nt(),x=at().debuglog("stream",S=>{x=S}),A=ka(),T=or(),{getHighWaterMark:B,getDefaultHighWaterMark:Y}=Fr(),{aggregateTwoErrors:X,codes:{ERR_INVALID_ARG_TYPE:ae,ERR_METHOD_NOT_IMPLEMENTED:P,ERR_OUT_OF_RANGE:Q,ERR_STREAM_PUSH_AFTER_EOF:J,ERR_STREAM_UNSHIFT_AFTER_END_EVENT:W},AbortError:me}=ot(),{validateObject:de}=_r(),ge=b("kPaused"),{StringDecoder:_e}=Oa(),G=Wo();o(ee.prototype,E.prototype),o(ee,E);var fe=()=>{},{errorOrDestroy:C}=T,re=1,pe=2,N=4,Ae=8,V=16,L=32,Z=64,$=128,q=256,H=512,se=1024,ie=2048,M=4096,D=8192,K=16384,ne=32768,te=65536,le=1<<17,F=1<<18;function oe(S){return{enumerable:!1,get(){return(this.state&S)!==0},set(R){R?this.state|=S:this.state&=~S}}}i(ye.prototype,{objectMode:oe(re),ended:oe(pe),endEmitted:oe(N),reading:oe(Ae),constructed:oe(V),sync:oe(L),needReadable:oe(Z),emittedReadable:oe($),readableListening:oe(q),resumeScheduled:oe(H),errorEmitted:oe(se),emitClose:oe(ie),autoDestroy:oe(M),destroyed:oe(D),closed:oe(K),closeEmitted:oe(ne),multiAwaitDrain:oe(te),readingMore:oe(le),dataEmitted:oe(F)});function ye(S,R,we){typeof we!="boolean"&&(we=R instanceof It()),this.state=ie|M|V|L,S&&S.objectMode&&(this.state|=re),we&&S&&S.readableObjectMode&&(this.state|=re),this.highWaterMark=S?B(this,S,"readableHighWaterMark",we):Y(!1),this.buffer=new A,this.length=0,this.pipes=[],this.flowing=null,this[ge]=null,S&&S.emitClose===!1&&(this.state&=-2049),S&&S.autoDestroy===!1&&(this.state&=-4097),this.errored=null,this.defaultEncoding=S&&S.defaultEncoding||"utf8",this.awaitDrainWriters=null,this.decoder=null,this.encoding=null,S&&S.encoding&&(this.decoder=new _e(S.encoding),this.encoding=S.encoding)}function ee(S){if(!(this instanceof ee))return new ee(S);let R=this instanceof It();this._readableState=new ye(S,this,R),S&&(typeof S.read=="function"&&(this._read=S.read),typeof S.destroy=="function"&&(this._destroy=S.destroy),typeof S.construct=="function"&&(this._construct=S.construct),S.signal&&!R&&v(S.signal,this)),E.call(this,S),T.construct(this,()=>{this._readableState.needReadable&&ve(this,this._readableState)})}ee.prototype.destroy=T.destroy,ee.prototype._undestroy=T.undestroy,ee.prototype._destroy=function(S,R){R(S)},ee.prototype[_.captureRejectionSymbol]=function(S){this.destroy(S)},ee.prototype[p]=function(){let S;return this.destroyed||(S=this.readableEnded?null:new me,this.destroy(S)),new u((R,we)=>j(this,Se=>Se&&Se!==S?we(Se):R(null)))},ee.prototype.push=function(S,R){return Pe(this,S,R,!1)},ee.prototype.unshift=function(S,R){return Pe(this,S,R,!0)};function Pe(S,R,we,Se){x("readableAddChunk",R);let ke=S._readableState,Ze;if((ke.state&re)===0&&(typeof R=="string"?(we=we||ke.defaultEncoding,ke.encoding!==we&&(Se&&ke.encoding?R=y.from(R,we).toString(ke.encoding):(R=y.from(R,we),we=""))):R instanceof y?we="":E._isUint8Array(R)?(R=E._uint8ArrayToBuffer(R),we=""):R!=null&&(Ze=new ae("chunk",["string","Buffer","Uint8Array"],R))),Ze)C(S,Ze);else if(R===null)ke.state&=-9,k(S,ke);else if((ke.state&re)!==0||R&&R.length>0)if(Se)if((ke.state&N)!==0)C(S,new W);else{if(ke.destroyed||ke.errored)return!1;l(S,ke,R,!0)}else if(ke.ended)C(S,new J);else{if(ke.destroyed||ke.errored)return!1;ke.state&=-9,ke.decoder&&!we?(R=ke.decoder.write(R),ke.objectMode||R.length!==0?l(S,ke,R,!1):ve(S,ke)):l(S,ke,R,!1)}else Se||(ke.state&=-9,ve(S,ke));return!ke.ended&&(ke.length<ke.highWaterMark||ke.length===0)}function l(S,R,we,Se){R.flowing&&R.length===0&&!R.sync&&S.listenerCount("data")>0?((R.state&te)!==0?R.awaitDrainWriters.clear():R.awaitDrainWriters=null,R.dataEmitted=!0,S.emit("data",we)):(R.length+=R.objectMode?1:we.length,Se?R.buffer.unshift(we):R.buffer.push(we),(R.state&Z)!==0&&U(S)),ve(S,R)}ee.prototype.isPaused=function(){let S=this._readableState;return S[ge]===!0||S.flowing===!1},ee.prototype.setEncoding=function(S){let R=new _e(S);this._readableState.decoder=R,this._readableState.encoding=this._readableState.decoder.encoding;let we=this._readableState.buffer,Se="";for(let ke of we)Se+=R.write(ke);return we.clear(),Se!==""&&we.push(Se),this._readableState.length=Se.length,this};var h=1073741824;function g(S){if(S>h)throw new Q("size","<= 1GiB",S);return S--,S|=S>>>1,S|=S>>>2,S|=S>>>4,S|=S>>>8,S|=S>>>16,S++,S}function w(S,R){return S<=0||R.length===0&&R.ended?0:(R.state&re)!==0?1:r(S)?R.flowing&&R.length?R.buffer.first().length:R.length:S<=R.length?S:R.ended?R.length:0}ee.prototype.read=function(S){x("read",S),S===void 0?S=NaN:c(S)||(S=e(S,10));let R=this._readableState,we=S;if(S>R.highWaterMark&&(R.highWaterMark=g(S)),S!==0&&(R.state&=-129),S===0&&R.needReadable&&((R.highWaterMark!==0?R.length>=R.highWaterMark:R.length>0)||R.ended))return x("read: emitReadable",R.length,R.ended),R.length===0&&R.ended?De(this):U(this),null;if(S=w(S,R),S===0&&R.ended)return R.length===0&&De(this),null;let Se=(R.state&Z)!==0;if(x("need readable",Se),(R.length===0||R.length-S<R.highWaterMark)&&(Se=!0,x("length less than watermark",Se)),R.ended||R.reading||R.destroyed||R.errored||!R.constructed)Se=!1,x("reading, ended or constructing",Se);else if(Se){x("do read"),R.state|=Ae|L,R.length===0&&(R.state|=Z);try{this._read(R.highWaterMark)}catch(Ze){C(this,Ze)}R.state&=-33,R.reading||(S=w(we,R))}let ke;return S>0?ke=Me(S,R):ke=null,ke===null?(R.needReadable=R.length<=R.highWaterMark,S=0):(R.length-=S,R.multiAwaitDrain?R.awaitDrainWriters.clear():R.awaitDrainWriters=null),R.length===0&&(R.ended||(R.needReadable=!0),we!==S&&R.ended&&De(this)),ke!==null&&!R.errorEmitted&&!R.closeEmitted&&(R.dataEmitted=!0,this.emit("data",ke)),ke};function k(S,R){if(x("onEofChunk"),!R.ended){if(R.decoder){let we=R.decoder.end();we&&we.length&&(R.buffer.push(we),R.length+=R.objectMode?1:we.length)}R.ended=!0,R.sync?U(S):(R.needReadable=!1,R.emittedReadable=!0,z(S))}}function U(S){let R=S._readableState;x("emitReadable",R.needReadable,R.emittedReadable),R.needReadable=!1,R.emittedReadable||(x("emitReadable",R.flowing),R.emittedReadable=!0,n.nextTick(z,S))}function z(S){let R=S._readableState;x("emitReadable_",R.destroyed,R.length,R.ended),!R.destroyed&&!R.errored&&(R.length||R.ended)&&(S.emit("readable"),R.emittedReadable=!1),R.needReadable=!R.flowing&&!R.ended&&R.length<=R.highWaterMark,lt(S)}function ve(S,R){!R.readingMore&&R.constructed&&(R.readingMore=!0,n.nextTick(Ee,S,R))}function Ee(S,R){for(;!R.reading&&!R.ended&&(R.length<R.highWaterMark||R.flowing&&R.length===0);){let we=R.length;if(x("maybeReadMore read 0"),S.read(0),we===R.length)break}R.readingMore=!1}ee.prototype._read=function(S){throw new P("_read()")},ee.prototype.pipe=function(S,R){let we=this,Se=this._readableState;Se.pipes.length===1&&(Se.multiAwaitDrain||(Se.multiAwaitDrain=!0,Se.awaitDrainWriters=new d(Se.awaitDrainWriters?[Se.awaitDrainWriters]:[]))),Se.pipes.push(S),x("pipe count=%d opts=%j",Se.pipes.length,R);let ke=(!R||R.end!==!1)&&S!==n.stdout&&S!==n.stderr?ht:ar;Se.endEmitted?n.nextTick(ke):we.once("end",ke),S.on("unpipe",Ze);function Ze(Ft,yt){x("onunpipe"),Ft===we&&yt&&yt.hasUnpiped===!1&&(yt.hasUnpiped=!0,Zs())}function ht(){x("onend"),S.end()}let Dt,Un=!1;function Zs(){x("cleanup"),S.removeListener("close",Vr),S.removeListener("finish",zr),Dt&&S.removeListener("drain",Dt),S.removeListener("error",Hr),S.removeListener("unpipe",Ze),we.removeListener("end",ht),we.removeListener("end",ar),we.removeListener("data",Nn),Un=!0,Dt&&Se.awaitDrainWriters&&(!S._writableState||S._writableState.needDrain)&&Dt()}function jn(){Un||(Se.pipes.length===1&&Se.pipes[0]===S?(x("false write response, pause",0),Se.awaitDrainWriters=S,Se.multiAwaitDrain=!1):Se.pipes.length>1&&Se.pipes.includes(S)&&(x("false write response, pause",Se.awaitDrainWriters.size),Se.awaitDrainWriters.add(S)),we.pause()),Dt||(Dt=Oe(we,S),S.on("drain",Dt))}we.on("data",Nn);function Nn(Ft){x("ondata");let yt=S.write(Ft);x("dest.write",yt),yt===!1&&jn()}function Hr(Ft){if(x("onerror",Ft),ar(),S.removeListener("error",Hr),S.listenerCount("error")===0){let yt=S._writableState||S._readableState;yt&&!yt.errorEmitted?C(S,Ft):S.emit("error",Ft)}}I(S,"error",Hr);function Vr(){S.removeListener("finish",zr),ar()}S.once("close",Vr);function zr(){x("onfinish"),S.removeListener("close",Vr),ar()}S.once("finish",zr);function ar(){x("unpipe"),we.unpipe(S)}return S.emit("pipe",we),S.writableNeedDrain===!0?jn():Se.flowing||(x("pipe resume"),we.resume()),S};function Oe(S,R){return function(){let we=S._readableState;we.awaitDrainWriters===R?(x("pipeOnDrain",1),we.awaitDrainWriters=null):we.multiAwaitDrain&&(x("pipeOnDrain",we.awaitDrainWriters.size),we.awaitDrainWriters.delete(R)),(!we.awaitDrainWriters||we.awaitDrainWriters.size===0)&&S.listenerCount("data")&&S.resume()}}ee.prototype.unpipe=function(S){let R=this._readableState,we={hasUnpiped:!1};if(R.pipes.length===0)return this;if(!S){let ke=R.pipes;R.pipes=[],this.pause();for(let Ze=0;Ze<ke.length;Ze++)ke[Ze].emit("unpipe",this,{hasUnpiped:!1});return this}let Se=a(R.pipes,S);return Se===-1?this:(R.pipes.splice(Se,1),R.pipes.length===0&&this.pause(),S.emit("unpipe",this,we),this)},ee.prototype.on=function(S,R){let we=E.prototype.on.call(this,S,R),Se=this._readableState;return S==="data"?(Se.readableListening=this.listenerCount("readable")>0,Se.flowing!==!1&&this.resume()):S==="readable"&&!Se.endEmitted&&!Se.readableListening&&(Se.readableListening=Se.needReadable=!0,Se.flowing=!1,Se.emittedReadable=!1,x("on readable",Se.length,Se.reading),Se.length?U(this):Se.reading||n.nextTick(Ce,this)),we},ee.prototype.addListener=ee.prototype.on,ee.prototype.removeListener=function(S,R){let we=E.prototype.removeListener.call(this,S,R);return S==="readable"&&n.nextTick(xe,this),we},ee.prototype.off=ee.prototype.removeListener,ee.prototype.removeAllListeners=function(S){let R=E.prototype.removeAllListeners.apply(this,arguments);return(S==="readable"||S===void 0)&&n.nextTick(xe,this),R};function xe(S){let R=S._readableState;R.readableListening=S.listenerCount("readable")>0,R.resumeScheduled&&R[ge]===!1?R.flowing=!0:S.listenerCount("data")>0?S.resume():R.readableListening||(R.flowing=null)}function Ce(S){x("readable nexttick read 0"),S.read(0)}ee.prototype.resume=function(){let S=this._readableState;return S.flowing||(x("resume"),S.flowing=!S.readableListening,pt(this,S)),S[ge]=!1,this};function pt(S,R){R.resumeScheduled||(R.resumeScheduled=!0,n.nextTick(st,S,R))}function st(S,R){x("resume",R.reading),R.reading||S.read(0),R.resumeScheduled=!1,S.emit("resume"),lt(S),R.flowing&&!R.reading&&S.read(0)}ee.prototype.pause=function(){return x("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(x("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState[ge]=!0,this};function lt(S){let R=S._readableState;for(x("flow",R.flowing);R.flowing&&S.read()!==null;);}ee.prototype.wrap=function(S){let R=!1;S.on("data",Se=>{!this.push(Se)&&S.pause&&(R=!0,S.pause())}),S.on("end",()=>{this.push(null)}),S.on("error",Se=>{C(this,Se)}),S.on("close",()=>{this.destroy()}),S.on("destroy",()=>{this.destroy()}),this._read=()=>{R&&S.resume&&(R=!1,S.resume())};let we=t(S);for(let Se=1;Se<we.length;Se++){let ke=we[Se];this[ke]===void 0&&typeof S[ke]=="function"&&(this[ke]=S[ke].bind(S))}return this},ee.prototype[m]=function(){return We(this)},ee.prototype.iterator=function(S){return S!==void 0&&de(S,"options"),We(this,S)};function We(S,R){typeof S.read!="function"&&(S=ee.wrap(S,{objectMode:!0}));let we=Ke(S,R);return we.stream=S,we}async function*Ke(S,R){let we=fe;function Se(ht){this===S?(we(),we=fe):we=ht}S.on("readable",Se);let ke,Ze=j(S,{writable:!1},ht=>{ke=ht?X(ke,ht):null,we(),we=fe});try{for(;;){let ht=S.destroyed?null:S.read();if(ht!==null)yield ht;else{if(ke)throw ke;if(ke===null)return;await new u(Se)}}}catch(ht){throw ke=X(ke,ht),ke}finally{(ke||(R==null?void 0:R.destroyOnReturn)!==!1)&&(ke===void 0||S._readableState.autoDestroy)?T.destroyer(S,null):(S.off("readable",Se),Ze())}}i(ee.prototype,{readable:{__proto__:null,get(){let S=this._readableState;return!!S&&S.readable!==!1&&!S.destroyed&&!S.errorEmitted&&!S.endEmitted},set(S){this._readableState&&(this._readableState.readable=!!S)}},readableDidRead:{__proto__:null,enumerable:!1,get:function(){return this._readableState.dataEmitted}},readableAborted:{__proto__:null,enumerable:!1,get:function(){return!!(this._readableState.readable!==!1&&(this._readableState.destroyed||this._readableState.errored)&&!this._readableState.endEmitted)}},readableHighWaterMark:{__proto__:null,enumerable:!1,get:function(){return this._readableState.highWaterMark}},readableBuffer:{__proto__:null,enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}},readableFlowing:{__proto__:null,enumerable:!1,get:function(){return this._readableState.flowing},set:function(S){this._readableState&&(this._readableState.flowing=S)}},readableLength:{__proto__:null,enumerable:!1,get(){return this._readableState.length}},readableObjectMode:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.objectMode:!1}},readableEncoding:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.encoding:null}},errored:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.errored:null}},closed:{__proto__:null,get(){return this._readableState?this._readableState.closed:!1}},destroyed:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.destroyed:!1},set(S){this._readableState&&(this._readableState.destroyed=S)}},readableEnded:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.endEmitted:!1}}}),i(ye.prototype,{pipesCount:{__proto__:null,get(){return this.pipes.length}},paused:{__proto__:null,get(){return this[ge]!==!1},set(S){this[ge]=!!S}}}),ee._fromList=Me;function Me(S,R){if(R.length===0)return null;let we;return R.objectMode?we=R.buffer.shift():!S||S>=R.length?(R.decoder?we=R.buffer.join(""):R.buffer.length===1?we=R.buffer.first():we=R.buffer.concat(R.length),R.buffer.clear()):we=R.buffer.consume(S,R.decoder),we}function De(S){let R=S._readableState;x("endReadable",R.endEmitted),R.endEmitted||(R.ended=!0,n.nextTick(Xe,R,S))}function Xe(S,R){if(x("endReadableNT",S.endEmitted,S.length),!S.errored&&!S.closeEmitted&&!S.endEmitted&&S.length===0){if(S.endEmitted=!0,R.emit("end"),R.writable&&R.allowHalfOpen===!1)n.nextTick(Ge,R);else if(S.autoDestroy){let we=R._writableState;(!we||we.autoDestroy&&(we.finished||we.writable===!1))&&R.destroy()}}}function Ge(S){S.writable&&!S.writableEnded&&!S.destroyed&&S.end()}ee.from=function(S,R){return G(ee,S,R)};var rt;function Pt(){return rt===void 0&&(rt={}),rt}ee.fromWeb=function(S,R){return Pt().newStreamReadableFromReadableStream(S,R)},ee.toWeb=function(S,R){return Pt().newReadableStreamFromStreamReadable(S,R)},ee.wrap=function(S,R){var we,Se;return new ee({objectMode:(we=(Se=S.readableObjectMode)!==null&&Se!==void 0?Se:S.objectMode)!==null&&we!==void 0?we:!0,...R,destroy(ke,Ze){T.destroyer(S,ke),Ze(ke)}}).wrap(S)}}),Cn=be((s,f)=>{ue(),ce(),he();var n=Zt(),{ArrayPrototypeSlice:a,Error:c,FunctionPrototypeSymbolHasInstance:r,ObjectDefineProperty:e,ObjectDefineProperties:i,ObjectSetPrototypeOf:t,StringPrototypeToLowerCase:o,Symbol:u,SymbolHasInstance:d}=Ve();f.exports=de,de.WritableState=W;var{EventEmitter:p}=(Xt(),Ne(jt)),m=Pn().Stream,{Buffer:b}=(Je(),Ne(Ye)),_=or(),{addAbortSignal:E}=Dr(),{getHighWaterMark:I,getDefaultHighWaterMark:y}=Fr(),{ERR_INVALID_ARG_TYPE:v,ERR_METHOD_NOT_IMPLEMENTED:j,ERR_MULTIPLE_CALLBACK:x,ERR_STREAM_CANNOT_PIPE:A,ERR_STREAM_DESTROYED:T,ERR_STREAM_ALREADY_FINISHED:B,ERR_STREAM_NULL_VALUES:Y,ERR_STREAM_WRITE_AFTER_END:X,ERR_UNKNOWN_ENCODING:ae}=ot().codes,{errorOrDestroy:P}=_;t(de.prototype,m.prototype),t(de,m);function Q(){}var J=u("kOnFinished");function W(M,D,K){typeof K!="boolean"&&(K=D instanceof It()),this.objectMode=!!(M&&M.objectMode),K&&(this.objectMode=this.objectMode||!!(M&&M.writableObjectMode)),this.highWaterMark=M?I(this,M,"writableHighWaterMark",K):y(!1),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;let ne=!!(M&&M.decodeStrings===!1);this.decodeStrings=!ne,this.defaultEncoding=M&&M.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=C.bind(void 0,D),this.writecb=null,this.writelen=0,this.afterWriteTickInfo=null,me(this),this.pendingcb=0,this.constructed=!0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!M||M.emitClose!==!1,this.autoDestroy=!M||M.autoDestroy!==!1,this.errored=null,this.closed=!1,this.closeEmitted=!1,this[J]=[]}function me(M){M.buffered=[],M.bufferedIndex=0,M.allBuffers=!0,M.allNoop=!0}W.prototype.getBuffer=function(){return a(this.buffered,this.bufferedIndex)},e(W.prototype,"bufferedRequestCount",{__proto__:null,get(){return this.buffered.length-this.bufferedIndex}});function de(M){let D=this instanceof It();if(!D&&!r(de,this))return new de(M);this._writableState=new W(M,this,D),M&&(typeof M.write=="function"&&(this._write=M.write),typeof M.writev=="function"&&(this._writev=M.writev),typeof M.destroy=="function"&&(this._destroy=M.destroy),typeof M.final=="function"&&(this._final=M.final),typeof M.construct=="function"&&(this._construct=M.construct),M.signal&&E(M.signal,this)),m.call(this,M),_.construct(this,()=>{let K=this._writableState;K.writing||Ae(this,K),$(this,K)})}e(de,d,{__proto__:null,value:function(M){return r(this,M)?!0:this!==de?!1:M&&M._writableState instanceof W}}),de.prototype.pipe=function(){P(this,new A)};function ge(M,D,K,ne){let te=M._writableState;if(typeof K=="function")ne=K,K=te.defaultEncoding;else{if(!K)K=te.defaultEncoding;else if(K!=="buffer"&&!b.isEncoding(K))throw new ae(K);typeof ne!="function"&&(ne=Q)}if(D===null)throw new Y;if(!te.objectMode)if(typeof D=="string")te.decodeStrings!==!1&&(D=b.from(D,K),K="buffer");else if(D instanceof b)K="buffer";else if(m._isUint8Array(D))D=m._uint8ArrayToBuffer(D),K="buffer";else throw new v("chunk",["string","Buffer","Uint8Array"],D);let le;return te.ending?le=new X:te.destroyed&&(le=new T("write")),le?(n.nextTick(ne,le),P(M,le,!0),le):(te.pendingcb++,_e(M,te,D,K,ne))}de.prototype.write=function(M,D,K){return ge(this,M,D,K)===!0},de.prototype.cork=function(){this._writableState.corked++},de.prototype.uncork=function(){let M=this._writableState;M.corked&&(M.corked--,M.writing||Ae(this,M))},de.prototype.setDefaultEncoding=function(M){if(typeof M=="string"&&(M=o(M)),!b.isEncoding(M))throw new ae(M);return this._writableState.defaultEncoding=M,this};function _e(M,D,K,ne,te){let le=D.objectMode?1:K.length;D.length+=le;let F=D.length<D.highWaterMark;return F||(D.needDrain=!0),D.writing||D.corked||D.errored||!D.constructed?(D.buffered.push({chunk:K,encoding:ne,callback:te}),D.allBuffers&&ne!=="buffer"&&(D.allBuffers=!1),D.allNoop&&te!==Q&&(D.allNoop=!1)):(D.writelen=le,D.writecb=te,D.writing=!0,D.sync=!0,M._write(K,ne,D.onwrite),D.sync=!1),F&&!D.errored&&!D.destroyed}function G(M,D,K,ne,te,le,F){D.writelen=ne,D.writecb=F,D.writing=!0,D.sync=!0,D.destroyed?D.onwrite(new T("write")):K?M._writev(te,D.onwrite):M._write(te,le,D.onwrite),D.sync=!1}function fe(M,D,K,ne){--D.pendingcb,ne(K),N(D),P(M,K)}function C(M,D){let K=M._writableState,ne=K.sync,te=K.writecb;if(typeof te!="function"){P(M,new x);return}K.writing=!1,K.writecb=null,K.length-=K.writelen,K.writelen=0,D?(D.stack,K.errored||(K.errored=D),M._readableState&&!M._readableState.errored&&(M._readableState.errored=D),ne?n.nextTick(fe,M,K,D,te):fe(M,K,D,te)):(K.buffered.length>K.bufferedIndex&&Ae(M,K),ne?K.afterWriteTickInfo!==null&&K.afterWriteTickInfo.cb===te?K.afterWriteTickInfo.count++:(K.afterWriteTickInfo={count:1,cb:te,stream:M,state:K},n.nextTick(re,K.afterWriteTickInfo)):pe(M,K,1,te))}function re({stream:M,state:D,count:K,cb:ne}){return D.afterWriteTickInfo=null,pe(M,D,K,ne)}function pe(M,D,K,ne){for(!D.ending&&!M.destroyed&&D.length===0&&D.needDrain&&(D.needDrain=!1,M.emit("drain"));K-- >0;)D.pendingcb--,ne();D.destroyed&&N(D),$(M,D)}function N(M){if(M.writing)return;for(let te=M.bufferedIndex;te<M.buffered.length;++te){var D;let{chunk:le,callback:F}=M.buffered[te],oe=M.objectMode?1:le.length;M.length-=oe,F((D=M.errored)!==null&&D!==void 0?D:new T("write"))}let K=M[J].splice(0);for(let te=0;te<K.length;te++){var ne;K[te]((ne=M.errored)!==null&&ne!==void 0?ne:new T("end"))}me(M)}function Ae(M,D){if(D.corked||D.bufferProcessing||D.destroyed||!D.constructed)return;let{buffered:K,bufferedIndex:ne,objectMode:te}=D,le=K.length-ne;if(!le)return;let F=ne;if(D.bufferProcessing=!0,le>1&&M._writev){D.pendingcb-=le-1;let oe=D.allNoop?Q:ee=>{for(let Pe=F;Pe<K.length;++Pe)K[Pe].callback(ee)},ye=D.allNoop&&F===0?K:a(K,F);ye.allBuffers=D.allBuffers,G(M,D,!0,D.length,ye,"",oe),me(D)}else{do{let{chunk:oe,encoding:ye,callback:ee}=K[F];K[F++]=null;let Pe=te?1:oe.length;G(M,D,!1,Pe,oe,ye,ee)}while(F<K.length&&!D.writing);F===K.length?me(D):F>256?(K.splice(0,F),D.bufferedIndex=0):D.bufferedIndex=F}D.bufferProcessing=!1}de.prototype._write=function(M,D,K){if(this._writev)this._writev([{chunk:M,encoding:D}],K);else throw new j("_write()")},de.prototype._writev=null,de.prototype.end=function(M,D,K){let ne=this._writableState;typeof M=="function"?(K=M,M=null,D=null):typeof D=="function"&&(K=D,D=null);let te;if(M!=null){let le=ge(this,M,D);le instanceof c&&(te=le)}return ne.corked&&(ne.corked=1,this.uncork()),te||(!ne.errored&&!ne.ending?(ne.ending=!0,$(this,ne,!0),ne.ended=!0):ne.finished?te=new B("end"):ne.destroyed&&(te=new T("end"))),typeof K=="function"&&(te||ne.finished?n.nextTick(K,te):ne[J].push(K)),this};function V(M){return M.ending&&!M.destroyed&&M.constructed&&M.length===0&&!M.errored&&M.buffered.length===0&&!M.finished&&!M.writing&&!M.errorEmitted&&!M.closeEmitted}function L(M,D){let K=!1;function ne(te){if(K){P(M,te??x());return}if(K=!0,D.pendingcb--,te){let le=D[J].splice(0);for(let F=0;F<le.length;F++)le[F](te);P(M,te,D.sync)}else V(D)&&(D.prefinished=!0,M.emit("prefinish"),D.pendingcb++,n.nextTick(q,M,D))}D.sync=!0,D.pendingcb++;try{M._final(ne)}catch(te){ne(te)}D.sync=!1}function Z(M,D){!D.prefinished&&!D.finalCalled&&(typeof M._final=="function"&&!D.destroyed?(D.finalCalled=!0,L(M,D)):(D.prefinished=!0,M.emit("prefinish")))}function $(M,D,K){V(D)&&(Z(M,D),D.pendingcb===0&&(K?(D.pendingcb++,n.nextTick((ne,te)=>{V(te)?q(ne,te):te.pendingcb--},M,D)):V(D)&&(D.pendingcb++,q(M,D))))}function q(M,D){D.pendingcb--,D.finished=!0;let K=D[J].splice(0);for(let ne=0;ne<K.length;ne++)K[ne]();if(M.emit("finish"),D.autoDestroy){let ne=M._readableState;(!ne||ne.autoDestroy&&(ne.endEmitted||ne.readable===!1))&&M.destroy()}}i(de.prototype,{closed:{__proto__:null,get(){return this._writableState?this._writableState.closed:!1}},destroyed:{__proto__:null,get(){return this._writableState?this._writableState.destroyed:!1},set(M){this._writableState&&(this._writableState.destroyed=M)}},writable:{__proto__:null,get(){let M=this._writableState;return!!M&&M.writable!==!1&&!M.destroyed&&!M.errored&&!M.ending&&!M.ended},set(M){this._writableState&&(this._writableState.writable=!!M)}},writableFinished:{__proto__:null,get(){return this._writableState?this._writableState.finished:!1}},writableObjectMode:{__proto__:null,get(){return this._writableState?this._writableState.objectMode:!1}},writableBuffer:{__proto__:null,get(){return this._writableState&&this._writableState.getBuffer()}},writableEnded:{__proto__:null,get(){return this._writableState?this._writableState.ending:!1}},writableNeedDrain:{__proto__:null,get(){let M=this._writableState;return M?!M.destroyed&&!M.ending&&M.needDrain:!1}},writableHighWaterMark:{__proto__:null,get(){return this._writableState&&this._writableState.highWaterMark}},writableCorked:{__proto__:null,get(){return this._writableState?this._writableState.corked:0}},writableLength:{__proto__:null,get(){return this._writableState&&this._writableState.length}},errored:{__proto__:null,enumerable:!1,get(){return this._writableState?this._writableState.errored:null}},writableAborted:{__proto__:null,enumerable:!1,get:function(){return!!(this._writableState.writable!==!1&&(this._writableState.destroyed||this._writableState.errored)&&!this._writableState.finished)}}});var H=_.destroy;de.prototype.destroy=function(M,D){let K=this._writableState;return!K.destroyed&&(K.bufferedIndex<K.buffered.length||K[J].length)&&n.nextTick(N,K),H.call(this,M,D),this},de.prototype._undestroy=_.undestroy,de.prototype._destroy=function(M,D){D(M)},de.prototype[p.captureRejectionSymbol]=function(M){this.destroy(M)};var se;function ie(){return se===void 0&&(se={}),se}de.fromWeb=function(M,D){return ie().newStreamWritableFromWritableStream(M,D)},de.toWeb=function(M){return ie().newWritableStreamFromStreamWritable(M)}}),Ra=be((s,f)=>{ue(),ce(),he();var n=Zt(),a=(Je(),Ne(Ye)),{isReadable:c,isWritable:r,isIterable:e,isNodeStream:i,isReadableNodeStream:t,isWritableNodeStream:o,isDuplexNodeStream:u,isReadableStream:d,isWritableStream:p}=Tt(),m=Nt(),{AbortError:b,codes:{ERR_INVALID_ARG_TYPE:_,ERR_INVALID_RETURN_VALUE:E}}=ot(),{destroyer:I}=or(),y=It(),v=Wr(),j=Cn(),{createDeferredPromise:x}=at(),A=Wo(),T=globalThis.Blob||a.Blob,B=typeof T<"u"?function(J){return J instanceof T}:function(J){return!1},Y=globalThis.AbortController||br().AbortController,{FunctionPrototypeCall:X}=Ve(),ae=class extends y{constructor(J){super(J),(J==null?void 0:J.readable)===!1&&(this._readableState.readable=!1,this._readableState.ended=!0,this._readableState.endEmitted=!0),(J==null?void 0:J.writable)===!1&&(this._writableState.writable=!1,this._writableState.ending=!0,this._writableState.ended=!0,this._writableState.finished=!0)}};f.exports=function J(W,me){if(u(W))return W;if(t(W))return Q({readable:W});if(o(W))return Q({writable:W});if(i(W))return Q({writable:!1,readable:!1});if(d(W))return Q({readable:v.fromWeb(W)});if(p(W))return Q({writable:j.fromWeb(W)});if(typeof W=="function"){let{value:ge,write:_e,final:G,destroy:fe}=P(W);if(e(ge))return A(ae,ge,{objectMode:!0,write:_e,final:G,destroy:fe});let C=ge==null?void 0:ge.then;if(typeof C=="function"){let re,pe=X(C,ge,N=>{if(N!=null)throw new E("nully","body",N)},N=>{I(re,N)});return re=new ae({objectMode:!0,readable:!1,write:_e,final(N){G(async()=>{try{await pe,n.nextTick(N,null)}catch(Ae){n.nextTick(N,Ae)}})},destroy:fe})}throw new E("Iterable, AsyncIterable or AsyncFunction",me,ge)}if(B(W))return J(W.arrayBuffer());if(e(W))return A(ae,W,{objectMode:!0,writable:!1});if(d(W==null?void 0:W.readable)&&p(W==null?void 0:W.writable))return ae.fromWeb(W);if(typeof(W==null?void 0:W.writable)=="object"||typeof(W==null?void 0:W.readable)=="object"){let ge=W!=null&&W.readable?t(W==null?void 0:W.readable)?W==null?void 0:W.readable:J(W.readable):void 0,_e=W!=null&&W.writable?o(W==null?void 0:W.writable)?W==null?void 0:W.writable:J(W.writable):void 0;return Q({readable:ge,writable:_e})}let de=W==null?void 0:W.then;if(typeof de=="function"){let ge;return X(de,W,_e=>{_e!=null&&ge.push(_e),ge.push(null)},_e=>{I(ge,_e)}),ge=new ae({objectMode:!0,writable:!1,read(){}})}throw new _(me,["Blob","ReadableStream","WritableStream","Stream","Iterable","AsyncIterable","Function","{ readable, writable } pair","Promise"],W)};function P(J){let{promise:W,resolve:me}=x(),de=new Y,ge=de.signal;return{value:J(async function*(){for(;;){let _e=W;W=null;let{chunk:G,done:fe,cb:C}=await _e;if(n.nextTick(C),fe)return;if(ge.aborted)throw new b(void 0,{cause:ge.reason});({promise:W,resolve:me}=x()),yield G}}(),{signal:ge}),write(_e,G,fe){let C=me;me=null,C({chunk:_e,done:!1,cb:fe})},final(_e){let G=me;me=null,G({done:!0,cb:_e})},destroy(_e,G){de.abort(),G(_e)}}}function Q(J){let W=J.readable&&typeof J.readable.read!="function"?v.wrap(J.readable):J.readable,me=J.writable,de=!!c(W),ge=!!r(me),_e,G,fe,C,re;function pe(N){let Ae=C;C=null,Ae?Ae(N):N&&re.destroy(N)}return re=new ae({readableObjectMode:!!(W!=null&&W.readableObjectMode),writableObjectMode:!!(me!=null&&me.writableObjectMode),readable:de,writable:ge}),ge&&(m(me,N=>{ge=!1,N&&I(W,N),pe(N)}),re._write=function(N,Ae,V){me.write(N,Ae)?V():_e=V},re._final=function(N){me.end(),G=N},me.on("drain",function(){if(_e){let N=_e;_e=null,N()}}),me.on("finish",function(){if(G){let N=G;G=null,N()}})),de&&(m(W,N=>{de=!1,N&&I(W,N),pe(N)}),W.on("readable",function(){if(fe){let N=fe;fe=null,N()}}),W.on("end",function(){re.push(null)}),re._read=function(){for(;;){let N=W.read();if(N===null){fe=re._read;return}if(!re.push(N))return}}),re._destroy=function(N,Ae){!N&&C!==null&&(N=new b),fe=null,_e=null,G=null,C===null?Ae(N):(C=Ae,I(me,N),I(W,N))},re}}),It=be((s,f)=>{ue(),ce(),he();var{ObjectDefineProperties:n,ObjectGetOwnPropertyDescriptor:a,ObjectKeys:c,ObjectSetPrototypeOf:r}=Ve();f.exports=t;var e=Wr(),i=Cn();r(t.prototype,e.prototype),r(t,e);{let p=c(i.prototype);for(let m=0;m<p.length;m++){let b=p[m];t.prototype[b]||(t.prototype[b]=i.prototype[b])}}function t(p){if(!(this instanceof t))return new t(p);e.call(this,p),i.call(this,p),p?(this.allowHalfOpen=p.allowHalfOpen!==!1,p.readable===!1&&(this._readableState.readable=!1,this._readableState.ended=!0,this._readableState.endEmitted=!0),p.writable===!1&&(this._writableState.writable=!1,this._writableState.ending=!0,this._writableState.ended=!0,this._writableState.finished=!0)):this.allowHalfOpen=!0}n(t.prototype,{writable:{__proto__:null,...a(i.prototype,"writable")},writableHighWaterMark:{__proto__:null,...a(i.prototype,"writableHighWaterMark")},writableObjectMode:{__proto__:null,...a(i.prototype,"writableObjectMode")},writableBuffer:{__proto__:null,...a(i.prototype,"writableBuffer")},writableLength:{__proto__:null,...a(i.prototype,"writableLength")},writableFinished:{__proto__:null,...a(i.prototype,"writableFinished")},writableCorked:{__proto__:null,...a(i.prototype,"writableCorked")},writableEnded:{__proto__:null,...a(i.prototype,"writableEnded")},writableNeedDrain:{__proto__:null,...a(i.prototype,"writableNeedDrain")},destroyed:{__proto__:null,get(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set(p){this._readableState&&this._writableState&&(this._readableState.destroyed=p,this._writableState.destroyed=p)}}});var o;function u(){return o===void 0&&(o={}),o}t.fromWeb=function(p,m){return u().newStreamDuplexFromReadableWritablePair(p,m)},t.toWeb=function(p){return u().newReadableWritablePairFromDuplex(p)};var d;t.from=function(p){return d||(d=Ra()),d(p,"body")}}),$o=be((s,f)=>{ue(),ce(),he();var{ObjectSetPrototypeOf:n,Symbol:a}=Ve();f.exports=t;var{ERR_METHOD_NOT_IMPLEMENTED:c}=ot().codes,r=It(),{getHighWaterMark:e}=Fr();n(t.prototype,r.prototype),n(t,r);var i=a("kCallback");function t(d){if(!(this instanceof t))return new t(d);let p=d?e(this,d,"readableHighWaterMark",!0):null;p===0&&(d={...d,highWaterMark:null,readableHighWaterMark:p,writableHighWaterMark:d.writableHighWaterMark||0}),r.call(this,d),this._readableState.sync=!1,this[i]=null,d&&(typeof d.transform=="function"&&(this._transform=d.transform),typeof d.flush=="function"&&(this._flush=d.flush)),this.on("prefinish",u)}function o(d){typeof this._flush=="function"&&!this.destroyed?this._flush((p,m)=>{if(p){d?d(p):this.destroy(p);return}m!=null&&this.push(m),this.push(null),d&&d()}):(this.push(null),d&&d())}function u(){this._final!==o&&o.call(this)}t.prototype._final=o,t.prototype._transform=function(d,p,m){throw new c("_transform()")},t.prototype._write=function(d,p,m){let b=this._readableState,_=this._writableState,E=b.length;this._transform(d,p,(I,y)=>{if(I){m(I);return}y!=null&&this.push(y),_.ended||E===b.length||b.length<b.highWaterMark?m():this[i]=m})},t.prototype._read=function(){if(this[i]){let d=this[i];this[i]=null,d()}}}),qo=be((s,f)=>{ue(),ce(),he();var{ObjectSetPrototypeOf:n}=Ve();f.exports=c;var a=$o();n(c.prototype,a.prototype),n(c,a);function c(r){if(!(this instanceof c))return new c(r);a.call(this,r)}c.prototype._transform=function(r,e,i){i(null,r)}}),Mn=be((s,f)=>{ue(),ce(),he();var n=Zt(),{ArrayIsArray:a,Promise:c,SymbolAsyncIterator:r,SymbolDispose:e}=Ve(),i=Nt(),{once:t}=at(),o=or(),u=It(),{aggregateTwoErrors:d,codes:{ERR_INVALID_ARG_TYPE:p,ERR_INVALID_RETURN_VALUE:m,ERR_MISSING_ARGS:b,ERR_STREAM_DESTROYED:_,ERR_STREAM_PREMATURE_CLOSE:E},AbortError:I}=ot(),{validateFunction:y,validateAbortSignal:v}=_r(),{isIterable:j,isReadable:x,isReadableNodeStream:A,isNodeStream:T,isTransformStream:B,isWebStream:Y,isReadableStream:X,isReadableFinished:ae}=Tt(),P=globalThis.AbortController||br().AbortController,Q,J,W;function me(N,Ae,V){let L=!1;N.on("close",()=>{L=!0});let Z=i(N,{readable:Ae,writable:V},$=>{L=!$});return{destroy:$=>{L||(L=!0,o.destroyer(N,$||new _("pipe")))},cleanup:Z}}function de(N){return y(N[N.length-1],"streams[stream.length - 1]"),N.pop()}function ge(N){if(j(N))return N;if(A(N))return _e(N);throw new p("val",["Readable","Iterable","AsyncIterable"],N)}async function*_e(N){J||(J=Wr()),yield*J.prototype[r].call(N)}async function G(N,Ae,V,{end:L}){let Z,$=null,q=ie=>{if(ie&&(Z=ie),$){let M=$;$=null,M()}},H=()=>new c((ie,M)=>{Z?M(Z):$=()=>{Z?M(Z):ie()}});Ae.on("drain",q);let se=i(Ae,{readable:!1},q);try{Ae.writableNeedDrain&&await H();for await(let ie of N)Ae.write(ie)||await H();L&&(Ae.end(),await H()),V()}catch(ie){V(Z!==ie?d(Z,ie):ie)}finally{se(),Ae.off("drain",q)}}async function fe(N,Ae,V,{end:L}){B(Ae)&&(Ae=Ae.writable);let Z=Ae.getWriter();try{for await(let $ of N)await Z.ready,Z.write($).catch(()=>{});await Z.ready,L&&await Z.close(),V()}catch($){try{await Z.abort($),V($)}catch(q){V(q)}}}function C(...N){return re(N,t(de(N)))}function re(N,Ae,V){if(N.length===1&&a(N[0])&&(N=N[0]),N.length<2)throw new b("streams");let L=new P,Z=L.signal,$=V==null?void 0:V.signal,q=[];v($,"options.signal");function H(){te(new I)}W=W||at().addAbortListener;let se;$&&(se=W($,H));let ie,M,D=[],K=0;function ne(ye){te(ye,--K===0)}function te(ye,ee){var Pe;if(ye&&(!ie||ie.code==="ERR_STREAM_PREMATURE_CLOSE")&&(ie=ye),!(!ie&&!ee)){for(;D.length;)D.shift()(ie);(Pe=se)===null||Pe===void 0||Pe[e](),L.abort(),ee&&(ie||q.forEach(l=>l()),n.nextTick(Ae,ie,M))}}let le;for(let ye=0;ye<N.length;ye++){let ee=N[ye],Pe=ye<N.length-1,l=ye>0,h=Pe||(V==null?void 0:V.end)!==!1,g=ye===N.length-1;if(T(ee)){let w=function(k){k&&k.name!=="AbortError"&&k.code!=="ERR_STREAM_PREMATURE_CLOSE"&&ne(k)};if(h){let{destroy:k,cleanup:U}=me(ee,Pe,l);D.push(k),x(ee)&&g&&q.push(U)}ee.on("error",w),x(ee)&&g&&q.push(()=>{ee.removeListener("error",w)})}if(ye===0)if(typeof ee=="function"){if(le=ee({signal:Z}),!j(le))throw new m("Iterable, AsyncIterable or Stream","source",le)}else j(ee)||A(ee)||B(ee)?le=ee:le=u.from(ee);else if(typeof ee=="function"){if(B(le)){var F;le=ge((F=le)===null||F===void 0?void 0:F.readable)}else le=ge(le);if(le=ee(le,{signal:Z}),Pe){if(!j(le,!0))throw new m("AsyncIterable",`transform[${ye-1}]`,le)}else{var oe;Q||(Q=qo());let w=new Q({objectMode:!0}),k=(oe=le)===null||oe===void 0?void 0:oe.then;if(typeof k=="function")K++,k.call(le,ve=>{M=ve,ve!=null&&w.write(ve),h&&w.end(),n.nextTick(ne)},ve=>{w.destroy(ve),n.nextTick(ne,ve)});else if(j(le,!0))K++,G(le,w,ne,{end:h});else if(X(le)||B(le)){let ve=le.readable||le;K++,G(ve,w,ne,{end:h})}else throw new m("AsyncIterable or Promise","destination",le);le=w;let{destroy:U,cleanup:z}=me(le,!1,!0);D.push(U),g&&q.push(z)}}else if(T(ee)){if(A(le)){K+=2;let w=pe(le,ee,ne,{end:h});x(ee)&&g&&q.push(w)}else if(B(le)||X(le)){let w=le.readable||le;K++,G(w,ee,ne,{end:h})}else if(j(le))K++,G(le,ee,ne,{end:h});else throw new p("val",["Readable","Iterable","AsyncIterable","ReadableStream","TransformStream"],le);le=ee}else if(Y(ee)){if(A(le))K++,fe(ge(le),ee,ne,{end:h});else if(X(le)||j(le))K++,fe(le,ee,ne,{end:h});else if(B(le))K++,fe(le.readable,ee,ne,{end:h});else throw new p("val",["Readable","Iterable","AsyncIterable","ReadableStream","TransformStream"],le);le=ee}else le=u.from(ee)}return(Z!=null&&Z.aborted||$!=null&&$.aborted)&&n.nextTick(H),le}function pe(N,Ae,V,{end:L}){let Z=!1;if(Ae.on("close",()=>{Z||V(new E)}),N.pipe(Ae,{end:!1}),L){let $=function(){Z=!0,Ae.end()};ae(N)?n.nextTick($):N.once("end",$)}else V();return i(N,{readable:!0,writable:!1},$=>{let q=N._readableState;$&&$.code==="ERR_STREAM_PREMATURE_CLOSE"&&q&&q.ended&&!q.errored&&!q.errorEmitted?N.once("end",V).once("error",V):V($)}),i(Ae,{readable:!1,writable:!0},V)}f.exports={pipelineImpl:re,pipeline:C}}),Ho=be((s,f)=>{ue(),ce(),he();var{pipeline:n}=Mn(),a=It(),{destroyer:c}=or(),{isNodeStream:r,isReadable:e,isWritable:i,isWebStream:t,isTransformStream:o,isWritableStream:u,isReadableStream:d}=Tt(),{AbortError:p,codes:{ERR_INVALID_ARG_VALUE:m,ERR_MISSING_ARGS:b}}=ot(),_=Nt();f.exports=function(...E){if(E.length===0)throw new b("streams");if(E.length===1)return a.from(E[0]);let I=[...E];if(typeof E[0]=="function"&&(E[0]=a.from(E[0])),typeof E[E.length-1]=="function"){let P=E.length-1;E[P]=a.from(E[P])}for(let P=0;P<E.length;++P)if(!(!r(E[P])&&!t(E[P]))){if(P<E.length-1&&!(e(E[P])||d(E[P])||o(E[P])))throw new m(`streams[${P}]`,I[P],"must be readable");if(P>0&&!(i(E[P])||u(E[P])||o(E[P])))throw new m(`streams[${P}]`,I[P],"must be writable")}let y,v,j,x,A;function T(P){let Q=x;x=null,Q?Q(P):P?A.destroy(P):!ae&&!X&&A.destroy()}let B=E[0],Y=n(E,T),X=!!(i(B)||u(B)||o(B)),ae=!!(e(Y)||d(Y)||o(Y));if(A=new a({writableObjectMode:!!(B!=null&&B.writableObjectMode),readableObjectMode:!!(Y!=null&&Y.readableObjectMode),writable:X,readable:ae}),X){if(r(B))A._write=function(Q,J,W){B.write(Q,J)?W():y=W},A._final=function(Q){B.end(),v=Q},B.on("drain",function(){if(y){let Q=y;y=null,Q()}});else if(t(B)){let Q=(o(B)?B.writable:B).getWriter();A._write=async function(J,W,me){try{await Q.ready,Q.write(J).catch(()=>{}),me()}catch(de){me(de)}},A._final=async function(J){try{await Q.ready,Q.close().catch(()=>{}),v=J}catch(W){J(W)}}}let P=o(Y)?Y.readable:Y;_(P,()=>{if(v){let Q=v;v=null,Q()}})}if(ae){if(r(Y))Y.on("readable",function(){if(j){let P=j;j=null,P()}}),Y.on("end",function(){A.push(null)}),A._read=function(){for(;;){let P=Y.read();if(P===null){j=A._read;return}if(!A.push(P))return}};else if(t(Y)){let P=(o(Y)?Y.readable:Y).getReader();A._read=async function(){for(;;)try{let{value:Q,done:J}=await P.read();if(!A.push(Q))return;if(J){A.push(null);return}}catch{return}}}}return A._destroy=function(P,Q){!P&&x!==null&&(P=new p),j=null,y=null,v=null,x===null?Q(P):(x=Q,r(Y)&&c(Y,P))},A}}),Pa=be((s,f)=>{ue(),ce(),he();var n=globalThis.AbortController||br().AbortController,{codes:{ERR_INVALID_ARG_VALUE:a,ERR_INVALID_ARG_TYPE:c,ERR_MISSING_ARGS:r,ERR_OUT_OF_RANGE:e},AbortError:i}=ot(),{validateAbortSignal:t,validateInteger:o,validateObject:u}=_r(),d=Ve().Symbol("kWeak"),p=Ve().Symbol("kResistStopPropagation"),{finished:m}=Nt(),b=Ho(),{addAbortSignalNoValidate:_}=Dr(),{isWritable:E,isNodeStream:I}=Tt(),{deprecate:y}=at(),{ArrayPrototypePush:v,Boolean:j,MathFloor:x,Number:A,NumberIsNaN:T,Promise:B,PromiseReject:Y,PromiseResolve:X,PromisePrototypeThen:ae,Symbol:P}=Ve(),Q=P("kEmpty"),J=P("kEof");function W($,q){if(q!=null&&u(q,"options"),(q==null?void 0:q.signal)!=null&&t(q.signal,"options.signal"),I($)&&!E($))throw new a("stream",$,"must be writable");let H=b(this,$);return q!=null&&q.signal&&_(q.signal,H),H}function me($,q){if(typeof $!="function")throw new c("fn",["Function","AsyncFunction"],$);q!=null&&u(q,"options"),(q==null?void 0:q.signal)!=null&&t(q.signal,"options.signal");let H=1;(q==null?void 0:q.concurrency)!=null&&(H=x(q.concurrency));let se=H-1;return(q==null?void 0:q.highWaterMark)!=null&&(se=x(q.highWaterMark)),o(H,"options.concurrency",1),o(se,"options.highWaterMark",0),se+=H,(async function*(){let ie=at().AbortSignalAny([q==null?void 0:q.signal].filter(j)),M=this,D=[],K={signal:ie},ne,te,le=!1,F=0;function oe(){le=!0,ye()}function ye(){F-=1,ee()}function ee(){te&&!le&&F<H&&D.length<se&&(te(),te=null)}async function Pe(){try{for await(let l of M){if(le)return;if(ie.aborted)throw new i;try{if(l=$(l,K),l===Q)continue;l=X(l)}catch(h){l=Y(h)}F+=1,ae(l,ye,oe),D.push(l),ne&&(ne(),ne=null),!le&&(D.length>=se||F>=H)&&await new B(h=>{te=h})}D.push(J)}catch(l){let h=Y(l);ae(h,ye,oe),D.push(h)}finally{le=!0,ne&&(ne(),ne=null)}}Pe();try{for(;;){for(;D.length>0;){let l=await D[0];if(l===J)return;if(ie.aborted)throw new i;l!==Q&&(yield l),D.shift(),ee()}await new B(l=>{ne=l})}}finally{le=!0,te&&(te(),te=null)}}).call(this)}function de($=void 0){return $!=null&&u($,"options"),($==null?void 0:$.signal)!=null&&t($.signal,"options.signal"),(async function*(){let q=0;for await(let se of this){var H;if($!=null&&(H=$.signal)!==null&&H!==void 0&&H.aborted)throw new i({cause:$.signal.reason});yield[q++,se]}}).call(this)}async function ge($,q=void 0){for await(let H of C.call(this,$,q))return!0;return!1}async function _e($,q=void 0){if(typeof $!="function")throw new c("fn",["Function","AsyncFunction"],$);return!await ge.call(this,async(...H)=>!await $(...H),q)}async function G($,q){for await(let H of C.call(this,$,q))return H}async function fe($,q){if(typeof $!="function")throw new c("fn",["Function","AsyncFunction"],$);async function H(se,ie){return await $(se,ie),Q}for await(let se of me.call(this,H,q));}function C($,q){if(typeof $!="function")throw new c("fn",["Function","AsyncFunction"],$);async function H(se,ie){return await $(se,ie)?se:Q}return me.call(this,H,q)}var re=class extends r{constructor(){super("reduce"),this.message="Reduce of an empty stream requires an initial value"}};async function pe($,q,H){var se;if(typeof $!="function")throw new c("reducer",["Function","AsyncFunction"],$);H!=null&&u(H,"options"),(H==null?void 0:H.signal)!=null&&t(H.signal,"options.signal");let ie=arguments.length>1;if(H!=null&&(se=H.signal)!==null&&se!==void 0&&se.aborted){let te=new i(void 0,{cause:H.signal.reason});throw this.once("error",()=>{}),await m(this.destroy(te)),te}let M=new n,D=M.signal;if(H!=null&&H.signal){let te={once:!0,[d]:this,[p]:!0};H.signal.addEventListener("abort",()=>M.abort(),te)}let K=!1;try{for await(let te of this){var ne;if(K=!0,H!=null&&(ne=H.signal)!==null&&ne!==void 0&&ne.aborted)throw new i;ie?q=await $(q,te,{signal:D}):(q=te,ie=!0)}if(!K&&!ie)throw new re}finally{M.abort()}return q}async function N($){$!=null&&u($,"options"),($==null?void 0:$.signal)!=null&&t($.signal,"options.signal");let q=[];for await(let se of this){var H;if($!=null&&(H=$.signal)!==null&&H!==void 0&&H.aborted)throw new i(void 0,{cause:$.signal.reason});v(q,se)}return q}function Ae($,q){let H=me.call(this,$,q);return(async function*(){for await(let se of H)yield*se}).call(this)}function V($){if($=A($),T($))return 0;if($<0)throw new e("number",">= 0",$);return $}function L($,q=void 0){return q!=null&&u(q,"options"),(q==null?void 0:q.signal)!=null&&t(q.signal,"options.signal"),$=V($),(async function*(){var H;if(q!=null&&(H=q.signal)!==null&&H!==void 0&&H.aborted)throw new i;for await(let ie of this){var se;if(q!=null&&(se=q.signal)!==null&&se!==void 0&&se.aborted)throw new i;$--<=0&&(yield ie)}}).call(this)}function Z($,q=void 0){return q!=null&&u(q,"options"),(q==null?void 0:q.signal)!=null&&t(q.signal,"options.signal"),$=V($),(async function*(){var H;if(q!=null&&(H=q.signal)!==null&&H!==void 0&&H.aborted)throw new i;for await(let ie of this){var se;if(q!=null&&(se=q.signal)!==null&&se!==void 0&&se.aborted)throw new i;if($-- >0&&(yield ie),$<=0)return}}).call(this)}f.exports.streamReturningOperators={asIndexedPairs:y(de,"readable.asIndexedPairs will be removed in a future version."),drop:L,filter:C,flatMap:Ae,map:me,take:Z,compose:W},f.exports.promiseReturningOperators={every:_e,forEach:fe,reduce:pe,toArray:N,some:ge,find:G}}),Vo=be((s,f)=>{ue(),ce(),he();var{ArrayPrototypePop:n,Promise:a}=Ve(),{isIterable:c,isNodeStream:r,isWebStream:e}=Tt(),{pipelineImpl:i}=Mn(),{finished:t}=Nt();zo();function o(...u){return new a((d,p)=>{let m,b,_=u[u.length-1];if(_&&typeof _=="object"&&!r(_)&&!c(_)&&!e(_)){let E=n(u);m=E.signal,b=E.end}i(u,(E,I)=>{E?p(E):d(I)},{signal:m,end:b})})}f.exports={finished:t,pipeline:o}}),zo=be((s,f)=>{ue(),ce(),he();var{Buffer:n}=(Je(),Ne(Ye)),{ObjectDefineProperty:a,ObjectKeys:c,ReflectApply:r}=Ve(),{promisify:{custom:e}}=at(),{streamReturningOperators:i,promiseReturningOperators:t}=Pa(),{codes:{ERR_ILLEGAL_CONSTRUCTOR:o}}=ot(),u=Ho(),{setDefaultHighWaterMark:d,getDefaultHighWaterMark:p}=Fr(),{pipeline:m}=Mn(),{destroyer:b}=or(),_=Nt(),E=Vo(),I=Tt(),y=f.exports=Pn().Stream;y.isDestroyed=I.isDestroyed,y.isDisturbed=I.isDisturbed,y.isErrored=I.isErrored,y.isReadable=I.isReadable,y.isWritable=I.isWritable,y.Readable=Wr();for(let j of c(i)){let x=function(...T){if(new.target)throw o();return y.Readable.from(r(A,this,T))},A=i[j];a(x,"name",{__proto__:null,value:A.name}),a(x,"length",{__proto__:null,value:A.length}),a(y.Readable.prototype,j,{__proto__:null,value:x,enumerable:!1,configurable:!0,writable:!0})}for(let j of c(t)){let x=function(...T){if(new.target)throw o();return r(A,this,T)},A=t[j];a(x,"name",{__proto__:null,value:A.name}),a(x,"length",{__proto__:null,value:A.length}),a(y.Readable.prototype,j,{__proto__:null,value:x,enumerable:!1,configurable:!0,writable:!0})}y.Writable=Cn(),y.Duplex=It(),y.Transform=$o(),y.PassThrough=qo(),y.pipeline=m;var{addAbortSignal:v}=Dr();y.addAbortSignal=v,y.finished=_,y.destroy=b,y.compose=u,y.setDefaultHighWaterMark=d,y.getDefaultHighWaterMark=p,a(y,"promises",{__proto__:null,configurable:!0,enumerable:!0,get(){return E}}),a(m,e,{__proto__:null,enumerable:!0,get(){return E.pipeline}}),a(_,e,{__proto__:null,enumerable:!0,get(){return E.finished}}),y.Stream=y,y._isUint8Array=function(j){return j instanceof Uint8Array},y._uint8ArrayToBuffer=function(j){return n.from(j.buffer,j.byteOffset,j.byteLength)}}),er=be((s,f)=>{ue(),ce(),he();var n=zo(),a=Vo(),c=n.Readable.destroy;f.exports=n.Readable,f.exports._uint8ArrayToBuffer=n._uint8ArrayToBuffer,f.exports._isUint8Array=n._isUint8Array,f.exports.isDisturbed=n.isDisturbed,f.exports.isErrored=n.isErrored,f.exports.isReadable=n.isReadable,f.exports.Readable=n.Readable,f.exports.Writable=n.Writable,f.exports.Duplex=n.Duplex,f.exports.Transform=n.Transform,f.exports.PassThrough=n.PassThrough,f.exports.addAbortSignal=n.addAbortSignal,f.exports.finished=n.finished,f.exports.destroy=n.destroy,f.exports.destroy=c,f.exports.pipeline=n.pipeline,f.exports.compose=n.compose,Object.defineProperty(n,"promises",{configurable:!0,enumerable:!0,get(){return a}}),f.exports.Stream=n.Stream,f.exports.default=f.exports}),Ca=be((s,f)=>{ue(),ce(),he(),typeof Object.create=="function"?f.exports=function(n,a){a&&(n.super_=a,n.prototype=Object.create(a.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}))}:f.exports=function(n,a){if(a){n.super_=a;var c=function(){};c.prototype=a.prototype,n.prototype=new c,n.prototype.constructor=n}}}),Ma=be((s,f)=>{ue(),ce(),he();var{Buffer:n}=(Je(),Ne(Ye)),a=Symbol.for("BufferList");function c(r){if(!(this instanceof c))return new c(r);c._init.call(this,r)}c._init=function(r){Object.defineProperty(this,a,{value:!0}),this._bufs=[],this.length=0,r&&this.append(r)},c.prototype._new=function(r){return new c(r)},c.prototype._offset=function(r){if(r===0)return[0,0];let e=0;for(let i=0;i<this._bufs.length;i++){let t=e+this._bufs[i].length;if(r<t||i===this._bufs.length-1)return[i,r-e];e=t}},c.prototype._reverseOffset=function(r){let e=r[0],i=r[1];for(let t=0;t<e;t++)i+=this._bufs[t].length;return i},c.prototype.get=function(r){if(r>this.length||r<0)return;let e=this._offset(r);return this._bufs[e[0]][e[1]]},c.prototype.slice=function(r,e){return typeof r=="number"&&r<0&&(r+=this.length),typeof e=="number"&&e<0&&(e+=this.length),this.copy(null,0,r,e)},c.prototype.copy=function(r,e,i,t){if((typeof i!="number"||i<0)&&(i=0),(typeof t!="number"||t>this.length)&&(t=this.length),i>=this.length||t<=0)return r||n.alloc(0);let o=!!r,u=this._offset(i),d=t-i,p=d,m=o&&e||0,b=u[1];if(i===0&&t===this.length){if(!o)return this._bufs.length===1?this._bufs[0]:n.concat(this._bufs,this.length);for(let _=0;_<this._bufs.length;_++)this._bufs[_].copy(r,m),m+=this._bufs[_].length;return r}if(p<=this._bufs[u[0]].length-b)return o?this._bufs[u[0]].copy(r,e,b,b+p):this._bufs[u[0]].slice(b,b+p);o||(r=n.allocUnsafe(d));for(let _=u[0];_<this._bufs.length;_++){let E=this._bufs[_].length-b;if(p>E)this._bufs[_].copy(r,m,b),m+=E;else{this._bufs[_].copy(r,m,b,b+p),m+=E;break}p-=E,b&&(b=0)}return r.length>m?r.slice(0,m):r},c.prototype.shallowSlice=function(r,e){if(r=r||0,e=typeof e!="number"?this.length:e,r<0&&(r+=this.length),e<0&&(e+=this.length),r===e)return this._new();let i=this._offset(r),t=this._offset(e),o=this._bufs.slice(i[0],t[0]+1);return t[1]===0?o.pop():o[o.length-1]=o[o.length-1].slice(0,t[1]),i[1]!==0&&(o[0]=o[0].slice(i[1])),this._new(o)},c.prototype.toString=function(r,e,i){return this.slice(e,i).toString(r)},c.prototype.consume=function(r){if(r=Math.trunc(r),Number.isNaN(r)||r<=0)return this;for(;this._bufs.length;)if(r>=this._bufs[0].length)r-=this._bufs[0].length,this.length-=this._bufs[0].length,this._bufs.shift();else{this._bufs[0]=this._bufs[0].slice(r),this.length-=r;break}return this},c.prototype.duplicate=function(){let r=this._new();for(let e=0;e<this._bufs.length;e++)r.append(this._bufs[e]);return r},c.prototype.append=function(r){if(r==null)return this;if(r.buffer)this._appendBuffer(n.from(r.buffer,r.byteOffset,r.byteLength));else if(Array.isArray(r))for(let e=0;e<r.length;e++)this.append(r[e]);else if(this._isBufferList(r))for(let e=0;e<r._bufs.length;e++)this.append(r._bufs[e]);else typeof r=="number"&&(r=r.toString()),this._appendBuffer(n.from(r));return this},c.prototype._appendBuffer=function(r){this._bufs.push(r),this.length+=r.length},c.prototype.indexOf=function(r,e,i){if(i===void 0&&typeof e=="string"&&(i=e,e=void 0),typeof r=="function"||Array.isArray(r))throw new TypeError('The "value" argument must be one of type string, Buffer, BufferList, or Uint8Array.');if(typeof r=="number"?r=n.from([r]):typeof r=="string"?r=n.from(r,i):this._isBufferList(r)?r=r.slice():Array.isArray(r.buffer)?r=n.from(r.buffer,r.byteOffset,r.byteLength):n.isBuffer(r)||(r=n.from(r)),e=Number(e||0),isNaN(e)&&(e=0),e<0&&(e=this.length+e),e<0&&(e=0),r.length===0)return e>this.length?this.length:e;let t=this._offset(e),o=t[0],u=t[1];for(;o<this._bufs.length;o++){let d=this._bufs[o];for(;u<d.length;)if(d.length-u>=r.length){let p=d.indexOf(r,u);if(p!==-1)return this._reverseOffset([o,p]);u=d.length-r.length+1}else{let p=this._reverseOffset([o,u]);if(this._match(p,r))return p;u++}u=0}return-1},c.prototype._match=function(r,e){if(this.length-r<e.length)return!1;for(let i=0;i<e.length;i++)if(this.get(r+i)!==e[i])return!1;return!0},function(){let r={readDoubleBE:8,readDoubleLE:8,readFloatBE:4,readFloatLE:4,readBigInt64BE:8,readBigInt64LE:8,readBigUInt64BE:8,readBigUInt64LE:8,readInt32BE:4,readInt32LE:4,readUInt32BE:4,readUInt32LE:4,readInt16BE:2,readInt16LE:2,readUInt16BE:2,readUInt16LE:2,readInt8:1,readUInt8:1,readIntBE:null,readIntLE:null,readUIntBE:null,readUIntLE:null};for(let e in r)(function(i){r[i]===null?c.prototype[i]=function(t,o){return this.slice(t,t+o)[i](0,o)}:c.prototype[i]=function(t=0){return this.slice(t,t+r[i])[i](0)}})(e)}(),c.prototype._isBufferList=function(r){return r instanceof c||c.isBufferList(r)},c.isBufferList=function(r){return r!=null&&r[a]},f.exports=c}),xa=be((s,f)=>{ue(),ce(),he();var n=er().Duplex,a=Ca(),c=Ma();function r(e){if(!(this instanceof r))return new r(e);if(typeof e=="function"){this._callback=e;let i=(function(t){this._callback&&(this._callback(t),this._callback=null)}).bind(this);this.on("pipe",function(t){t.on("error",i)}),this.on("unpipe",function(t){t.removeListener("error",i)}),e=null}c._init.call(this,e),n.call(this)}a(r,n),Object.assign(r.prototype,c.prototype),r.prototype._new=function(e){return new r(e)},r.prototype._write=function(e,i,t){this._appendBuffer(e),typeof t=="function"&&t()},r.prototype._read=function(e){if(!this.length)return this.push(null);e=Math.min(e,this.length),this.push(this.slice(0,e)),this.consume(e)},r.prototype.end=function(e){n.prototype.end.call(this,e),this._callback&&(this._callback(null,this.slice()),this._callback=null)},r.prototype._destroy=function(e,i){this._bufs.length=0,this.length=0,i(e)},r.prototype._isBufferList=function(e){return e instanceof r||e instanceof c||r.isBufferList(e)},r.isBufferList=c.isBufferList,f.exports=r,f.exports.BufferListStream=r,f.exports.BufferList=c}),Ba=be((s,f)=>{ue(),ce(),he();var n=class{constructor(){this.cmd=null,this.retain=!1,this.qos=0,this.dup=!1,this.length=-1,this.topic=null,this.payload=null}};f.exports=n}),Go=be((s,f)=>{ue(),ce(),he();var n=f.exports,{Buffer:a}=(Je(),Ne(Ye));n.types={0:"reserved",1:"connect",2:"connack",3:"publish",4:"puback",5:"pubrec",6:"pubrel",7:"pubcomp",8:"subscribe",9:"suback",10:"unsubscribe",11:"unsuback",12:"pingreq",13:"pingresp",14:"disconnect",15:"auth"},n.requiredHeaderFlags={1:0,2:0,4:0,5:0,6:2,7:0,8:2,9:0,10:2,11:0,12:0,13:0,14:0,15:0},n.requiredHeaderFlagsErrors={};for(let r in n.requiredHeaderFlags){let e=n.requiredHeaderFlags[r];n.requiredHeaderFlagsErrors[r]="Invalid header flag bits, must be 0x"+e.toString(16)+" for "+n.types[r]+" packet"}n.codes={};for(let r in n.types){let e=n.types[r];n.codes[e]=r}n.CMD_SHIFT=4,n.CMD_MASK=240,n.DUP_MASK=8,n.QOS_MASK=3,n.QOS_SHIFT=1,n.RETAIN_MASK=1,n.VARBYTEINT_MASK=127,n.VARBYTEINT_FIN_MASK=128,n.VARBYTEINT_MAX=268435455,n.SESSIONPRESENT_MASK=1,n.SESSIONPRESENT_HEADER=a.from([n.SESSIONPRESENT_MASK]),n.CONNACK_HEADER=a.from([n.codes.connack<<n.CMD_SHIFT]),n.USERNAME_MASK=128,n.PASSWORD_MASK=64,n.WILL_RETAIN_MASK=32,n.WILL_QOS_MASK=24,n.WILL_QOS_SHIFT=3,n.WILL_FLAG_MASK=4,n.CLEAN_SESSION_MASK=2,n.CONNECT_HEADER=a.from([n.codes.connect<<n.CMD_SHIFT]),n.properties={sessionExpiryInterval:17,willDelayInterval:24,receiveMaximum:33,maximumPacketSize:39,topicAliasMaximum:34,requestResponseInformation:25,requestProblemInformation:23,userProperties:38,authenticationMethod:21,authenticationData:22,payloadFormatIndicator:1,messageExpiryInterval:2,contentType:3,responseTopic:8,correlationData:9,maximumQoS:36,retainAvailable:37,assignedClientIdentifier:18,reasonString:31,wildcardSubscriptionAvailable:40,subscriptionIdentifiersAvailable:41,sharedSubscriptionAvailable:42,serverKeepAlive:19,responseInformation:26,serverReference:28,topicAlias:35,subscriptionIdentifier:11},n.propertiesCodes={};for(let r in n.properties){let e=n.properties[r];n.propertiesCodes[e]=r}n.propertiesTypes={sessionExpiryInterval:"int32",willDelayInterval:"int32",receiveMaximum:"int16",maximumPacketSize:"int32",topicAliasMaximum:"int16",requestResponseInformation:"byte",requestProblemInformation:"byte",userProperties:"pair",authenticationMethod:"string",authenticationData:"binary",payloadFormatIndicator:"byte",messageExpiryInterval:"int32",contentType:"string",responseTopic:"string",correlationData:"binary",maximumQoS:"int8",retainAvailable:"byte",assignedClientIdentifier:"string",reasonString:"string",wildcardSubscriptionAvailable:"byte",subscriptionIdentifiersAvailable:"byte",sharedSubscriptionAvailable:"byte",serverKeepAlive:"int16",responseInformation:"string",serverReference:"string",topicAlias:"int16",subscriptionIdentifier:"var"};function c(r){return[0,1,2].map(e=>[0,1].map(i=>[0,1].map(t=>{let o=a.alloc(1);return o.writeUInt8(n.codes[r]<<n.CMD_SHIFT|(i?n.DUP_MASK:0)|e<<n.QOS_SHIFT|t,0,!0),o})))}n.PUBLISH_HEADER=c("publish"),n.SUBSCRIBE_HEADER=c("subscribe"),n.SUBSCRIBE_OPTIONS_QOS_MASK=3,n.SUBSCRIBE_OPTIONS_NL_MASK=1,n.SUBSCRIBE_OPTIONS_NL_SHIFT=2,n.SUBSCRIBE_OPTIONS_RAP_MASK=1,n.SUBSCRIBE_OPTIONS_RAP_SHIFT=3,n.SUBSCRIBE_OPTIONS_RH_MASK=3,n.SUBSCRIBE_OPTIONS_RH_SHIFT=4,n.SUBSCRIBE_OPTIONS_RH=[0,16,32],n.SUBSCRIBE_OPTIONS_NL=4,n.SUBSCRIBE_OPTIONS_RAP=8,n.SUBSCRIBE_OPTIONS_QOS=[0,1,2],n.UNSUBSCRIBE_HEADER=c("unsubscribe"),n.ACKS={unsuback:c("unsuback"),puback:c("puback"),pubcomp:c("pubcomp"),pubrel:c("pubrel"),pubrec:c("pubrec")},n.SUBACK_HEADER=a.from([n.codes.suback<<n.CMD_SHIFT]),n.VERSION3=a.from([3]),n.VERSION4=a.from([4]),n.VERSION5=a.from([5]),n.VERSION131=a.from([131]),n.VERSION132=a.from([132]),n.QOS=[0,1,2].map(r=>a.from([r])),n.EMPTY={pingreq:a.from([n.codes.pingreq<<4,0]),pingresp:a.from([n.codes.pingresp<<4,0]),disconnect:a.from([n.codes.disconnect<<4,0])},n.MQTT5_PUBACK_PUBREC_CODES={0:"Success",16:"No matching subscribers",128:"Unspecified error",131:"Implementation specific error",135:"Not authorized",144:"Topic Name invalid",145:"Packet identifier in use",151:"Quota exceeded",153:"Payload format invalid"},n.MQTT5_PUBREL_PUBCOMP_CODES={0:"Success",146:"Packet Identifier not found"},n.MQTT5_SUBACK_CODES={0:"Granted QoS 0",1:"Granted QoS 1",2:"Granted QoS 2",128:"Unspecified error",131:"Implementation specific error",135:"Not authorized",143:"Topic Filter invalid",145:"Packet Identifier in use",151:"Quota exceeded",158:"Shared Subscriptions not supported",161:"Subscription Identifiers not supported",162:"Wildcard Subscriptions not supported"},n.MQTT5_UNSUBACK_CODES={0:"Success",17:"No subscription existed",128:"Unspecified error",131:"Implementation specific error",135:"Not authorized",143:"Topic Filter invalid",145:"Packet Identifier in use"},n.MQTT5_DISCONNECT_CODES={0:"Normal disconnection",4:"Disconnect with Will Message",128:"Unspecified error",129:"Malformed Packet",130:"Protocol Error",131:"Implementation specific error",135:"Not authorized",137:"Server busy",139:"Server shutting down",141:"Keep Alive timeout",142:"Session taken over",143:"Topic Filter invalid",144:"Topic Name invalid",147:"Receive Maximum exceeded",148:"Topic Alias invalid",149:"Packet too large",150:"Message rate too high",151:"Quota exceeded",152:"Administrative action",153:"Payload format invalid",154:"Retain not supported",155:"QoS not supported",156:"Use another server",157:"Server moved",158:"Shared Subscriptions not supported",159:"Connection rate exceeded",160:"Maximum connect time",161:"Subscription Identifiers not supported",162:"Wildcard Subscriptions not supported"},n.MQTT5_AUTH_CODES={0:"Success",24:"Continue authentication",25:"Re-authenticate"}}),La=be((s,f)=>{ue(),ce(),he();var n=1e3,a=n*60,c=a*60,r=c*24,e=r*7,i=r*365.25;f.exports=function(p,m){m=m||{};var b=typeof p;if(b==="string"&&p.length>0)return t(p);if(b==="number"&&isFinite(p))return m.long?u(p):o(p);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(p))};function t(p){if(p=String(p),!(p.length>100)){var m=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(p);if(m){var b=parseFloat(m[1]),_=(m[2]||"ms").toLowerCase();switch(_){case"years":case"year":case"yrs":case"yr":case"y":return b*i;case"weeks":case"week":case"w":return b*e;case"days":case"day":case"d":return b*r;case"hours":case"hour":case"hrs":case"hr":case"h":return b*c;case"minutes":case"minute":case"mins":case"min":case"m":return b*a;case"seconds":case"second":case"secs":case"sec":case"s":return b*n;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return b;default:return}}}}function o(p){var m=Math.abs(p);return m>=r?Math.round(p/r)+"d":m>=c?Math.round(p/c)+"h":m>=a?Math.round(p/a)+"m":m>=n?Math.round(p/n)+"s":p+"ms"}function u(p){var m=Math.abs(p);return m>=r?d(p,m,r,"day"):m>=c?d(p,m,c,"hour"):m>=a?d(p,m,a,"minute"):m>=n?d(p,m,n,"second"):p+" ms"}function d(p,m,b,_){var E=m>=b*1.5;return Math.round(p/b)+" "+_+(E?"s":"")}}),Ua=be((s,f)=>{ue(),ce(),he();function n(a){r.debug=r,r.default=r,r.coerce=d,r.disable=o,r.enable=i,r.enabled=u,r.humanize=La(),r.destroy=p,Object.keys(a).forEach(m=>{r[m]=a[m]}),r.names=[],r.skips=[],r.formatters={};function c(m){let b=0;for(let _=0;_<m.length;_++)b=(b<<5)-b+m.charCodeAt(_),b|=0;return r.colors[Math.abs(b)%r.colors.length]}r.selectColor=c;function r(m){let b,_=null,E,I;function y(...v){if(!y.enabled)return;let j=y,x=Number(new Date),A=x-(b||x);j.diff=A,j.prev=b,j.curr=x,b=x,v[0]=r.coerce(v[0]),typeof v[0]!="string"&&v.unshift("%O");let T=0;v[0]=v[0].replace(/%([a-zA-Z%])/g,(B,Y)=>{if(B==="%%")return"%";T++;let X=r.formatters[Y];if(typeof X=="function"){let ae=v[T];B=X.call(j,ae),v.splice(T,1),T--}return B}),r.formatArgs.call(j,v),(j.log||r.log).apply(j,v)}return y.namespace=m,y.useColors=r.useColors(),y.color=r.selectColor(m),y.extend=e,y.destroy=r.destroy,Object.defineProperty(y,"enabled",{enumerable:!0,configurable:!1,get:()=>_!==null?_:(E!==r.namespaces&&(E=r.namespaces,I=r.enabled(m)),I),set:v=>{_=v}}),typeof r.init=="function"&&r.init(y),y}function e(m,b){let _=r(this.namespace+(typeof b>"u"?":":b)+m);return _.log=this.log,_}function i(m){r.save(m),r.namespaces=m,r.names=[],r.skips=[];let b=(typeof m=="string"?m:"").trim().replace(" ",",").split(",").filter(Boolean);for(let _ of b)_[0]==="-"?r.skips.push(_.slice(1)):r.names.push(_)}function t(m,b){let _=0,E=0,I=-1,y=0;for(;_<m.length;)if(E<b.length&&(b[E]===m[_]||b[E]==="*"))b[E]==="*"?(I=E,y=_,E++):(_++,E++);else if(I!==-1)E=I+1,y++,_=y;else return!1;for(;E<b.length&&b[E]==="*";)E++;return E===b.length}function o(){let m=[...r.names,...r.skips.map(b=>"-"+b)].join(",");return r.enable(""),m}function u(m){for(let b of r.skips)if(t(m,b))return!1;for(let b of r.names)if(t(m,b))return!0;return!1}function d(m){return m instanceof Error?m.stack||m.message:m}function p(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return r.enable(r.load()),r}f.exports=n}),kt=be((s,f)=>{ue(),ce(),he(),s.formatArgs=a,s.save=c,s.load=r,s.useColors=n,s.storage=e(),s.destroy=(()=>{let t=!1;return()=>{t||(t=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),s.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function n(){if(typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs))return!0;if(typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;let t;return typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&(t=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(t[1],10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function a(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+f.exports.humanize(this.diff),!this.useColors)return;let o="color: "+this.color;t.splice(1,0,o,"color: inherit");let u=0,d=0;t[0].replace(/%[a-zA-Z%]/g,p=>{p!=="%%"&&(u++,p==="%c"&&(d=u))}),t.splice(d,0,o)}s.log=console.debug||console.log||(()=>{});function c(t){try{t?s.storage.setItem("debug",t):s.storage.removeItem("debug")}catch{}}function r(){let t;try{t=s.storage.getItem("debug")}catch{}return!t&&typeof Le<"u"&&"env"in Le&&(t=Le.env.DEBUG),t}function e(){try{return localStorage}catch{}}f.exports=Ua()(s);var{formatters:i}=f.exports;i.j=function(t){try{return JSON.stringify(t)}catch(o){return"[UnexpectedJSONParseError]: "+o.message}}}),ja=be((s,f)=>{ue(),ce(),he();var n=xa(),{EventEmitter:a}=(Xt(),Ne(jt)),c=Ba(),r=Go(),e=kt()("mqtt-packet:parser"),i=class dn extends a{constructor(){super(),this.parser=this.constructor.parser}static parser(o){return this instanceof dn?(this.settings=o||{},this._states=["_parseHeader","_parseLength","_parsePayload","_newPacket"],this._resetState(),this):new dn().parser(o)}_resetState(){e("_resetState: resetting packet, error, _list, and _stateCounter"),this.packet=new c,this.error=null,this._list=n(),this._stateCounter=0}parse(o){for(this.error&&this._resetState(),this._list.append(o),e("parse: current state: %s",this._states[this._stateCounter]);(this.packet.length!==-1||this._list.length>0)&&this[this._states[this._stateCounter]]()&&!this.error;)this._stateCounter++,e("parse: state complete. _stateCounter is now: %d",this._stateCounter),e("parse: packet.length: %d, buffer list length: %d",this.packet.length,this._list.length),this._stateCounter>=this._states.length&&(this._stateCounter=0);return e("parse: exited while loop. packet: %d, buffer list length: %d",this.packet.length,this._list.length),this._list.length}_parseHeader(){let o=this._list.readUInt8(0),u=o>>r.CMD_SHIFT;this.packet.cmd=r.types[u];let d=o&15,p=r.requiredHeaderFlags[u];return p!=null&&d!==p?this._emitError(new Error(r.requiredHeaderFlagsErrors[u])):(this.packet.retain=(o&r.RETAIN_MASK)!==0,this.packet.qos=o>>r.QOS_SHIFT&r.QOS_MASK,this.packet.qos>2?this._emitError(new Error("Packet must not have both QoS bits set to 1")):(this.packet.dup=(o&r.DUP_MASK)!==0,e("_parseHeader: packet: %o",this.packet),this._list.consume(1),!0))}_parseLength(){let o=this._parseVarByteNum(!0);return o&&(this.packet.length=o.value,this._list.consume(o.bytes)),e("_parseLength %d",o.value),!!o}_parsePayload(){e("_parsePayload: payload %O",this._list);let o=!1;if(this.packet.length===0||this._list.length>=this.packet.length){switch(this._pos=0,this.packet.cmd){case"connect":this._parseConnect();break;case"connack":this._parseConnack();break;case"publish":this._parsePublish();break;case"puback":case"pubrec":case"pubrel":case"pubcomp":this._parseConfirmation();break;case"subscribe":this._parseSubscribe();break;case"suback":this._parseSuback();break;case"unsubscribe":this._parseUnsubscribe();break;case"unsuback":this._parseUnsuback();break;case"pingreq":case"pingresp":break;case"disconnect":this._parseDisconnect();break;case"auth":this._parseAuth();break;default:this._emitError(new Error("Not supported"))}o=!0}return e("_parsePayload complete result: %s",o),o}_parseConnect(){e("_parseConnect");let o,u,d,p,m={},b=this.packet,_=this._parseString();if(_===null)return this._emitError(new Error("Cannot parse protocolId"));if(_!=="MQTT"&&_!=="MQIsdp")return this._emitError(new Error("Invalid protocolId"));if(b.protocolId=_,this._pos>=this._list.length)return this._emitError(new Error("Packet too short"));if(b.protocolVersion=this._list.readUInt8(this._pos),b.protocolVersion>=128&&(b.bridgeMode=!0,b.protocolVersion=b.protocolVersion-128),b.protocolVersion!==3&&b.protocolVersion!==4&&b.protocolVersion!==5)return this._emitError(new Error("Invalid protocol version"));if(this._pos++,this._pos>=this._list.length)return this._emitError(new Error("Packet too short"));if(this._list.readUInt8(this._pos)&1)return this._emitError(new Error("Connect flag bit 0 must be 0, but got 1"));m.username=this._list.readUInt8(this._pos)&r.USERNAME_MASK,m.password=this._list.readUInt8(this._pos)&r.PASSWORD_MASK,m.will=this._list.readUInt8(this._pos)&r.WILL_FLAG_MASK;let E=!!(this._list.readUInt8(this._pos)&r.WILL_RETAIN_MASK),I=(this._list.readUInt8(this._pos)&r.WILL_QOS_MASK)>>r.WILL_QOS_SHIFT;if(m.will)b.will={},b.will.retain=E,b.will.qos=I;else{if(E)return this._emitError(new Error("Will Retain Flag must be set to zero when Will Flag is set to 0"));if(I)return this._emitError(new Error("Will QoS must be set to zero when Will Flag is set to 0"))}if(b.clean=(this._list.readUInt8(this._pos)&r.CLEAN_SESSION_MASK)!==0,this._pos++,b.keepalive=this._parseNum(),b.keepalive===-1)return this._emitError(new Error("Packet too short"));if(b.protocolVersion===5){let v=this._parseProperties();Object.getOwnPropertyNames(v).length&&(b.properties=v)}let y=this._parseString();if(y===null)return this._emitError(new Error("Packet too short"));if(b.clientId=y,e("_parseConnect: packet.clientId: %s",b.clientId),m.will){if(b.protocolVersion===5){let v=this._parseProperties();Object.getOwnPropertyNames(v).length&&(b.will.properties=v)}if(o=this._parseString(),o===null)return this._emitError(new Error("Cannot parse will topic"));if(b.will.topic=o,e("_parseConnect: packet.will.topic: %s",b.will.topic),u=this._parseBuffer(),u===null)return this._emitError(new Error("Cannot parse will payload"));b.will.payload=u,e("_parseConnect: packet.will.paylaod: %s",b.will.payload)}if(m.username){if(p=this._parseString(),p===null)return this._emitError(new Error("Cannot parse username"));b.username=p,e("_parseConnect: packet.username: %s",b.username)}if(m.password){if(d=this._parseBuffer(),d===null)return this._emitError(new Error("Cannot parse password"));b.password=d}return this.settings=b,e("_parseConnect: complete"),b}_parseConnack(){e("_parseConnack");let o=this.packet;if(this._list.length<1)return null;let u=this._list.readUInt8(this._pos++);if(u>1)return this._emitError(new Error("Invalid connack flags, bits 7-1 must be set to 0"));if(o.sessionPresent=!!(u&r.SESSIONPRESENT_MASK),this.settings.protocolVersion===5)this._list.length>=2?o.reasonCode=this._list.readUInt8(this._pos++):o.reasonCode=0;else{if(this._list.length<2)return null;o.returnCode=this._list.readUInt8(this._pos++)}if(o.returnCode===-1||o.reasonCode===-1)return this._emitError(new Error("Cannot parse return code"));if(this.settings.protocolVersion===5){let d=this._parseProperties();Object.getOwnPropertyNames(d).length&&(o.properties=d)}e("_parseConnack: complete")}_parsePublish(){e("_parsePublish");let o=this.packet;if(o.topic=this._parseString(),o.topic===null)return this._emitError(new Error("Cannot parse topic"));if(!(o.qos>0&&!this._parseMessageId())){if(this.settings.protocolVersion===5){let u=this._parseProperties();Object.getOwnPropertyNames(u).length&&(o.properties=u)}o.payload=this._list.slice(this._pos,o.length),e("_parsePublish: payload from buffer list: %o",o.payload)}}_parseSubscribe(){e("_parseSubscribe");let o=this.packet,u,d,p,m,b,_,E;if(o.subscriptions=[],!!this._parseMessageId()){if(this.settings.protocolVersion===5){let I=this._parseProperties();Object.getOwnPropertyNames(I).length&&(o.properties=I)}if(o.length<=0)return this._emitError(new Error("Malformed subscribe, no payload specified"));for(;this._pos<o.length;){if(u=this._parseString(),u===null)return this._emitError(new Error("Cannot parse topic"));if(this._pos>=o.length)return this._emitError(new Error("Malformed Subscribe Payload"));if(d=this._parseByte(),this.settings.protocolVersion===5){if(d&192)return this._emitError(new Error("Invalid subscribe topic flag bits, bits 7-6 must be 0"))}else if(d&252)return this._emitError(new Error("Invalid subscribe topic flag bits, bits 7-2 must be 0"));if(p=d&r.SUBSCRIBE_OPTIONS_QOS_MASK,p>2)return this._emitError(new Error("Invalid subscribe QoS, must be <= 2"));if(_=(d>>r.SUBSCRIBE_OPTIONS_NL_SHIFT&r.SUBSCRIBE_OPTIONS_NL_MASK)!==0,b=(d>>r.SUBSCRIBE_OPTIONS_RAP_SHIFT&r.SUBSCRIBE_OPTIONS_RAP_MASK)!==0,m=d>>r.SUBSCRIBE_OPTIONS_RH_SHIFT&r.SUBSCRIBE_OPTIONS_RH_MASK,m>2)return this._emitError(new Error("Invalid retain handling, must be <= 2"));E={topic:u,qos:p},this.settings.protocolVersion===5?(E.nl=_,E.rap=b,E.rh=m):this.settings.bridgeMode&&(E.rh=0,E.rap=!0,E.nl=!0),e("_parseSubscribe: push subscription `%s` to subscription",E),o.subscriptions.push(E)}}}_parseSuback(){e("_parseSuback");let o=this.packet;if(this.packet.granted=[],!!this._parseMessageId()){if(this.settings.protocolVersion===5){let u=this._parseProperties();Object.getOwnPropertyNames(u).length&&(o.properties=u)}if(o.length<=0)return this._emitError(new Error("Malformed suback, no payload specified"));for(;this._pos<this.packet.length;){let u=this._list.readUInt8(this._pos++);if(this.settings.protocolVersion===5){if(!r.MQTT5_SUBACK_CODES[u])return this._emitError(new Error("Invalid suback code"))}else if(u>2&&u!==128)return this._emitError(new Error("Invalid suback QoS, must be 0, 1, 2 or 128"));this.packet.granted.push(u)}}}_parseUnsubscribe(){e("_parseUnsubscribe");let o=this.packet;if(o.unsubscriptions=[],!!this._parseMessageId()){if(this.settings.protocolVersion===5){let u=this._parseProperties();Object.getOwnPropertyNames(u).length&&(o.properties=u)}if(o.length<=0)return this._emitError(new Error("Malformed unsubscribe, no payload specified"));for(;this._pos<o.length;){let u=this._parseString();if(u===null)return this._emitError(new Error("Cannot parse topic"));e("_parseUnsubscribe: push topic `%s` to unsubscriptions",u),o.unsubscriptions.push(u)}}}_parseUnsuback(){e("_parseUnsuback");let o=this.packet;if(!this._parseMessageId())return this._emitError(new Error("Cannot parse messageId"));if((this.settings.protocolVersion===3||this.settings.protocolVersion===4)&&o.length!==2)return this._emitError(new Error("Malformed unsuback, payload length must be 2"));if(o.length<=0)return this._emitError(new Error("Malformed unsuback, no payload specified"));if(this.settings.protocolVersion===5){let u=this._parseProperties();for(Object.getOwnPropertyNames(u).length&&(o.properties=u),o.granted=[];this._pos<this.packet.length;){let d=this._list.readUInt8(this._pos++);if(!r.MQTT5_UNSUBACK_CODES[d])return this._emitError(new Error("Invalid unsuback code"));this.packet.granted.push(d)}}}_parseConfirmation(){e("_parseConfirmation: packet.cmd: `%s`",this.packet.cmd);let o=this.packet;if(this._parseMessageId(),this.settings.protocolVersion===5){if(o.length>2){switch(o.reasonCode=this._parseByte(),this.packet.cmd){case"puback":case"pubrec":if(!r.MQTT5_PUBACK_PUBREC_CODES[o.reasonCode])return this._emitError(new Error("Invalid "+this.packet.cmd+" reason code"));break;case"pubrel":case"pubcomp":if(!r.MQTT5_PUBREL_PUBCOMP_CODES[o.reasonCode])return this._emitError(new Error("Invalid "+this.packet.cmd+" reason code"));break}e("_parseConfirmation: packet.reasonCode `%d`",o.reasonCode)}else o.reasonCode=0;if(o.length>3){let u=this._parseProperties();Object.getOwnPropertyNames(u).length&&(o.properties=u)}}return!0}_parseDisconnect(){let o=this.packet;if(e("_parseDisconnect"),this.settings.protocolVersion===5){this._list.length>0?(o.reasonCode=this._parseByte(),r.MQTT5_DISCONNECT_CODES[o.reasonCode]||this._emitError(new Error("Invalid disconnect reason code"))):o.reasonCode=0;let u=this._parseProperties();Object.getOwnPropertyNames(u).length&&(o.properties=u)}return e("_parseDisconnect result: true"),!0}_parseAuth(){e("_parseAuth");let o=this.packet;if(this.settings.protocolVersion!==5)return this._emitError(new Error("Not supported auth packet for this version MQTT"));if(o.reasonCode=this._parseByte(),!r.MQTT5_AUTH_CODES[o.reasonCode])return this._emitError(new Error("Invalid auth reason code"));let u=this._parseProperties();return Object.getOwnPropertyNames(u).length&&(o.properties=u),e("_parseAuth: result: true"),!0}_parseMessageId(){let o=this.packet;return o.messageId=this._parseNum(),o.messageId===null?(this._emitError(new Error("Cannot parse messageId")),!1):(e("_parseMessageId: packet.messageId %d",o.messageId),!0)}_parseString(o){let u=this._parseNum(),d=u+this._pos;if(u===-1||d>this._list.length||d>this.packet.length)return null;let p=this._list.toString("utf8",this._pos,d);return this._pos+=u,e("_parseString: result: %s",p),p}_parseStringPair(){return e("_parseStringPair"),{name:this._parseString(),value:this._parseString()}}_parseBuffer(){let o=this._parseNum(),u=o+this._pos;if(o===-1||u>this._list.length||u>this.packet.length)return null;let d=this._list.slice(this._pos,u);return this._pos+=o,e("_parseBuffer: result: %o",d),d}_parseNum(){if(this._list.length-this._pos<2)return-1;let o=this._list.readUInt16BE(this._pos);return this._pos+=2,e("_parseNum: result: %s",o),o}_parse4ByteNum(){if(this._list.length-this._pos<4)return-1;let o=this._list.readUInt32BE(this._pos);return this._pos+=4,e("_parse4ByteNum: result: %s",o),o}_parseVarByteNum(o){e("_parseVarByteNum");let u=4,d=0,p=1,m=0,b=!1,_,E=this._pos?this._pos:0;for(;d<u&&E+d<this._list.length;){if(_=this._list.readUInt8(E+d++),m+=p*(_&r.VARBYTEINT_MASK),p*=128,(_&r.VARBYTEINT_FIN_MASK)===0){b=!0;break}if(this._list.length<=d)break}return!b&&d===u&&this._list.length>=d&&this._emitError(new Error("Invalid variable byte integer")),E&&(this._pos+=d),b?o?b={bytes:d,value:m}:b=m:b=!1,e("_parseVarByteNum: result: %o",b),b}_parseByte(){let o;return this._pos<this._list.length&&(o=this._list.readUInt8(this._pos),this._pos++),e("_parseByte: result: %o",o),o}_parseByType(o){switch(e("_parseByType: type: %s",o),o){case"byte":return this._parseByte()!==0;case"int8":return this._parseByte();case"int16":return this._parseNum();case"int32":return this._parse4ByteNum();case"var":return this._parseVarByteNum();case"string":return this._parseString();case"pair":return this._parseStringPair();case"binary":return this._parseBuffer()}}_parseProperties(){e("_parseProperties");let o=this._parseVarByteNum(),u=this._pos+o,d={};for(;this._pos<u;){let p=this._parseByte();if(!p)return this._emitError(new Error("Cannot parse property code type")),!1;let m=r.propertiesCodes[p];if(!m)return this._emitError(new Error("Unknown property")),!1;if(m==="userProperties"){d[m]||(d[m]=Object.create(null));let b=this._parseByType(r.propertiesTypes[m]);if(d[m][b.name])if(Array.isArray(d[m][b.name]))d[m][b.name].push(b.value);else{let _=d[m][b.name];d[m][b.name]=[_],d[m][b.name].push(b.value)}else d[m][b.name]=b.value;continue}d[m]?Array.isArray(d[m])?d[m].push(this._parseByType(r.propertiesTypes[m])):(d[m]=[d[m]],d[m].push(this._parseByType(r.propertiesTypes[m]))):d[m]=this._parseByType(r.propertiesTypes[m])}return d}_newPacket(){return e("_newPacket"),this.packet&&(this._list.consume(this.packet.length),e("_newPacket: parser emit packet: packet.cmd: %s, packet.payload: %s, packet.length: %d",this.packet.cmd,this.packet.payload,this.packet.length),this.emit("packet",this.packet)),e("_newPacket: new packet"),this.packet=new c,this._pos=0,!0}_emitError(o){e("_emitError",o),this.error=o,this.emit("error",o)}};f.exports=i}),Na=be((s,f)=>{ue(),ce(),he();var{Buffer:n}=(Je(),Ne(Ye)),a=65536,c={},r=n.isBuffer(n.from([1,2]).subarray(0,1));function e(u){let d=n.allocUnsafe(2);return d.writeUInt8(u>>8,0),d.writeUInt8(u&255,1),d}function i(){for(let u=0;u<a;u++)c[u]=e(u)}function t(u){let d=0,p=0,m=n.allocUnsafe(4);do d=u%128|0,u=u/128|0,u>0&&(d=d|128),m.writeUInt8(d,p++);while(u>0&&p<4);return u>0&&(p=0),r?m.subarray(0,p):m.slice(0,p)}function o(u){let d=n.allocUnsafe(4);return d.writeUInt32BE(u,0),d}f.exports={cache:c,generateCache:i,generateNumber:e,genBufVariableByteInt:t,generate4ByteBuffer:o}}),Da=be((s,f)=>{ue(),ce(),he(),typeof Le>"u"||!Le.version||Le.version.indexOf("v0.")===0||Le.version.indexOf("v1.")===0&&Le.version.indexOf("v1.8.")!==0?f.exports={nextTick:n}:f.exports=Le;function n(a,c,r,e){if(typeof a!="function")throw new TypeError('"callback" argument must be a function');var i=arguments.length,t,o;switch(i){case 0:case 1:return Le.nextTick(a);case 2:return Le.nextTick(function(){a.call(null,c)});case 3:return Le.nextTick(function(){a.call(null,c,r)});case 4:return Le.nextTick(function(){a.call(null,c,r,e)});default:for(t=new Array(i-1),o=0;o<t.length;)t[o++]=arguments[o];return Le.nextTick(function(){a.apply(null,t)})}}}),Qo=be((s,f)=>{ue(),ce(),he();var n=Go(),{Buffer:a}=(Je(),Ne(Ye)),c=a.allocUnsafe(0),r=a.from([0]),e=Na(),i=Da().nextTick,t=kt()("mqtt-packet:writeToStream"),o=e.cache,u=e.generateNumber,d=e.generateCache,p=e.genBufVariableByteInt,m=e.generate4ByteBuffer,b=de,_=!0;function E(V,L,Z){switch(t("generate called"),L.cork&&(L.cork(),i(I,L)),_&&(_=!1,d()),t("generate: packet.cmd: %s",V.cmd),V.cmd){case"connect":return y(V,L);case"connack":return v(V,L,Z);case"publish":return j(V,L,Z);case"puback":case"pubrec":case"pubrel":case"pubcomp":return x(V,L,Z);case"subscribe":return A(V,L,Z);case"suback":return T(V,L,Z);case"unsubscribe":return B(V,L,Z);case"unsuback":return Y(V,L,Z);case"pingreq":case"pingresp":return X(V,L);case"disconnect":return ae(V,L,Z);case"auth":return P(V,L,Z);default:return L.destroy(new Error("Unknown command")),!1}}Object.defineProperty(E,"cacheNumbers",{get(){return b===de},set(V){V?((!o||Object.keys(o).length===0)&&(_=!0),b=de):(_=!1,b=ge)}});function I(V){V.uncork()}function y(V,L,Z){let $=V||{},q=$.protocolId||"MQTT",H=$.protocolVersion||4,se=$.will,ie=$.clean,M=$.keepalive||0,D=$.clientId||"",K=$.username,ne=$.password,te=$.properties;ie===void 0&&(ie=!0);let le=0;if(typeof q!="string"&&!a.isBuffer(q))return L.destroy(new Error("Invalid protocolId")),!1;if(le+=q.length+2,H!==3&&H!==4&&H!==5)return L.destroy(new Error("Invalid protocol version")),!1;if(le+=1,(typeof D=="string"||a.isBuffer(D))&&(D||H>=4)&&(D||ie))le+=a.byteLength(D)+2;else{if(H<4)return L.destroy(new Error("clientId must be supplied before 3.1.1")),!1;if(ie*1===0)return L.destroy(new Error("clientId must be given if cleanSession set to 0")),!1}if(typeof M!="number"||M<0||M>65535||M%1!==0)return L.destroy(new Error("Invalid keepalive")),!1;le+=2,le+=1;let F,oe;if(H===5){if(F=fe(L,te),!F)return!1;le+=F.length}if(se){if(typeof se!="object")return L.destroy(new Error("Invalid will")),!1;if(!se.topic||typeof se.topic!="string")return L.destroy(new Error("Invalid will topic")),!1;if(le+=a.byteLength(se.topic)+2,le+=2,se.payload)if(se.payload.length>=0)typeof se.payload=="string"?le+=a.byteLength(se.payload):le+=se.payload.length;else return L.destroy(new Error("Invalid will payload")),!1;if(oe={},H===5){if(oe=fe(L,se.properties),!oe)return!1;le+=oe.length}}let ye=!1;if(K!=null)if(Ae(K))ye=!0,le+=a.byteLength(K)+2;else return L.destroy(new Error("Invalid username")),!1;if(ne!=null){if(!ye)return L.destroy(new Error("Username is required to use password")),!1;if(Ae(ne))le+=N(ne)+2;else return L.destroy(new Error("Invalid password")),!1}L.write(n.CONNECT_HEADER),J(L,le),G(L,q),$.bridgeMode&&(H+=128),L.write(H===131?n.VERSION131:H===132?n.VERSION132:H===4?n.VERSION4:H===5?n.VERSION5:n.VERSION3);let ee=0;return ee|=K!=null?n.USERNAME_MASK:0,ee|=ne!=null?n.PASSWORD_MASK:0,ee|=se&&se.retain?n.WILL_RETAIN_MASK:0,ee|=se&&se.qos?se.qos<<n.WILL_QOS_SHIFT:0,ee|=se?n.WILL_FLAG_MASK:0,ee|=ie?n.CLEAN_SESSION_MASK:0,L.write(a.from([ee])),b(L,M),H===5&&F.write(),G(L,D),se&&(H===5&&oe.write(),W(L,se.topic),G(L,se.payload)),K!=null&&G(L,K),ne!=null&&G(L,ne),!0}function v(V,L,Z){let $=Z?Z.protocolVersion:4,q=V||{},H=$===5?q.reasonCode:q.returnCode,se=q.properties,ie=2;if(typeof H!="number")return L.destroy(new Error("Invalid return code")),!1;let M=null;if($===5){if(M=fe(L,se),!M)return!1;ie+=M.length}return L.write(n.CONNACK_HEADER),J(L,ie),L.write(q.sessionPresent?n.SESSIONPRESENT_HEADER:r),L.write(a.from([H])),M==null||M.write(),!0}function j(V,L,Z){t("publish: packet: %o",V);let $=Z?Z.protocolVersion:4,q=V||{},H=q.qos||0,se=q.retain?n.RETAIN_MASK:0,ie=q.topic,M=q.payload||c,D=q.messageId,K=q.properties,ne=0;if(typeof ie=="string")ne+=a.byteLength(ie)+2;else if(a.isBuffer(ie))ne+=ie.length+2;else return L.destroy(new Error("Invalid topic")),!1;if(a.isBuffer(M)?ne+=M.length:ne+=a.byteLength(M),H&&typeof D!="number")return L.destroy(new Error("Invalid messageId")),!1;H&&(ne+=2);let te=null;if($===5){if(te=fe(L,K),!te)return!1;ne+=te.length}return L.write(n.PUBLISH_HEADER[H][q.dup?1:0][se?1:0]),J(L,ne),b(L,N(ie)),L.write(ie),H>0&&b(L,D),te==null||te.write(),t("publish: payload: %o",M),L.write(M)}function x(V,L,Z){let $=Z?Z.protocolVersion:4,q=V||{},H=q.cmd||"puback",se=q.messageId,ie=q.dup&&H==="pubrel"?n.DUP_MASK:0,M=0,D=q.reasonCode,K=q.properties,ne=$===5?3:2;if(H==="pubrel"&&(M=1),typeof se!="number")return L.destroy(new Error("Invalid messageId")),!1;let te=null;if($===5&&typeof K=="object"){if(te=C(L,K,Z,ne),!te)return!1;ne+=te.length}return L.write(n.ACKS[H][M][ie][0]),ne===3&&(ne+=D!==0?1:-1),J(L,ne),b(L,se),$===5&&ne!==2&&L.write(a.from([D])),te!==null?te.write():ne===4&&L.write(a.from([0])),!0}function A(V,L,Z){t("subscribe: packet: ");let $=Z?Z.protocolVersion:4,q=V||{},H=q.dup?n.DUP_MASK:0,se=q.messageId,ie=q.subscriptions,M=q.properties,D=0;if(typeof se!="number")return L.destroy(new Error("Invalid messageId")),!1;D+=2;let K=null;if($===5){if(K=fe(L,M),!K)return!1;D+=K.length}if(typeof ie=="object"&&ie.length)for(let te=0;te<ie.length;te+=1){let le=ie[te].topic,F=ie[te].qos;if(typeof le!="string")return L.destroy(new Error("Invalid subscriptions - invalid topic")),!1;if(typeof F!="number")return L.destroy(new Error("Invalid subscriptions - invalid qos")),!1;if($===5){if(typeof(ie[te].nl||!1)!="boolean")return L.destroy(new Error("Invalid subscriptions - invalid No Local")),!1;if(typeof(ie[te].rap||!1)!="boolean")return L.destroy(new Error("Invalid subscriptions - invalid Retain as Published")),!1;let oe=ie[te].rh||0;if(typeof oe!="number"||oe>2)return L.destroy(new Error("Invalid subscriptions - invalid Retain Handling")),!1}D+=a.byteLength(le)+2+1}else return L.destroy(new Error("Invalid subscriptions")),!1;t("subscribe: writing to stream: %o",n.SUBSCRIBE_HEADER),L.write(n.SUBSCRIBE_HEADER[1][H?1:0][0]),J(L,D),b(L,se),K!==null&&K.write();let ne=!0;for(let te of ie){let le=te.topic,F=te.qos,oe=+te.nl,ye=+te.rap,ee=te.rh,Pe;W(L,le),Pe=n.SUBSCRIBE_OPTIONS_QOS[F],$===5&&(Pe|=oe?n.SUBSCRIBE_OPTIONS_NL:0,Pe|=ye?n.SUBSCRIBE_OPTIONS_RAP:0,Pe|=ee?n.SUBSCRIBE_OPTIONS_RH[ee]:0),ne=L.write(a.from([Pe]))}return ne}function T(V,L,Z){let $=Z?Z.protocolVersion:4,q=V||{},H=q.messageId,se=q.granted,ie=q.properties,M=0;if(typeof H!="number")return L.destroy(new Error("Invalid messageId")),!1;if(M+=2,typeof se=="object"&&se.length)for(let K=0;K<se.length;K+=1){if(typeof se[K]!="number")return L.destroy(new Error("Invalid qos vector")),!1;M+=1}else return L.destroy(new Error("Invalid qos vector")),!1;let D=null;if($===5){if(D=C(L,ie,Z,M),!D)return!1;M+=D.length}return L.write(n.SUBACK_HEADER),J(L,M),b(L,H),D!==null&&D.write(),L.write(a.from(se))}function B(V,L,Z){let $=Z?Z.protocolVersion:4,q=V||{},H=q.messageId,se=q.dup?n.DUP_MASK:0,ie=q.unsubscriptions,M=q.properties,D=0;if(typeof H!="number")return L.destroy(new Error("Invalid messageId")),!1;if(D+=2,typeof ie=="object"&&ie.length)for(let te=0;te<ie.length;te+=1){if(typeof ie[te]!="string")return L.destroy(new Error("Invalid unsubscriptions")),!1;D+=a.byteLength(ie[te])+2}else return L.destroy(new Error("Invalid unsubscriptions")),!1;let K=null;if($===5){if(K=fe(L,M),!K)return!1;D+=K.length}L.write(n.UNSUBSCRIBE_HEADER[1][se?1:0][0]),J(L,D),b(L,H),K!==null&&K.write();let ne=!0;for(let te=0;te<ie.length;te++)ne=W(L,ie[te]);return ne}function Y(V,L,Z){let $=Z?Z.protocolVersion:4,q=V||{},H=q.messageId,se=q.dup?n.DUP_MASK:0,ie=q.granted,M=q.properties,D=q.cmd,K=0,ne=2;if(typeof H!="number")return L.destroy(new Error("Invalid messageId")),!1;if($===5)if(typeof ie=="object"&&ie.length)for(let le=0;le<ie.length;le+=1){if(typeof ie[le]!="number")return L.destroy(new Error("Invalid qos vector")),!1;ne+=1}else return L.destroy(new Error("Invalid qos vector")),!1;let te=null;if($===5){if(te=C(L,M,Z,ne),!te)return!1;ne+=te.length}return L.write(n.ACKS[D][K][se][0]),J(L,ne),b(L,H),te!==null&&te.write(),$===5&&L.write(a.from(ie)),!0}function X(V,L,Z){return L.write(n.EMPTY[V.cmd])}function ae(V,L,Z){let $=Z?Z.protocolVersion:4,q=V||{},H=q.reasonCode,se=q.properties,ie=$===5?1:0,M=null;if($===5){if(M=C(L,se,Z,ie),!M)return!1;ie+=M.length}return L.write(a.from([n.codes.disconnect<<4])),J(L,ie),$===5&&L.write(a.from([H])),M!==null&&M.write(),!0}function P(V,L,Z){let $=Z?Z.protocolVersion:4,q=V||{},H=q.reasonCode,se=q.properties,ie=$===5?1:0;$!==5&&L.destroy(new Error("Invalid mqtt version for auth packet"));let M=C(L,se,Z,ie);return M?(ie+=M.length,L.write(a.from([n.codes.auth<<4])),J(L,ie),L.write(a.from([H])),M!==null&&M.write(),!0):!1}var Q={};function J(V,L){if(L>n.VARBYTEINT_MAX)return V.destroy(new Error(`Invalid variable byte integer: ${L}`)),!1;let Z=Q[L];return Z||(Z=p(L),L<16384&&(Q[L]=Z)),t("writeVarByteInt: writing to stream: %o",Z),V.write(Z)}function W(V,L){let Z=a.byteLength(L);return b(V,Z),t("writeString: %s",L),V.write(L,"utf8")}function me(V,L,Z){W(V,L),W(V,Z)}function de(V,L){return t("writeNumberCached: number: %d",L),t("writeNumberCached: %o",o[L]),V.write(o[L])}function ge(V,L){let Z=u(L);return t("writeNumberGenerated: %o",Z),V.write(Z)}function _e(V,L){let Z=m(L);return t("write4ByteNumber: %o",Z),V.write(Z)}function G(V,L){typeof L=="string"?W(V,L):L?(b(V,L.length),V.write(L)):b(V,0)}function fe(V,L){if(typeof L!="object"||L.length!=null)return{length:1,write(){pe(V,{},0)}};let Z=0;function $(q,H){let se=n.propertiesTypes[q],ie=0;switch(se){case"byte":{if(typeof H!="boolean")return V.destroy(new Error(`Invalid ${q}: ${H}`)),!1;ie+=2;break}case"int8":{if(typeof H!="number"||H<0||H>255)return V.destroy(new Error(`Invalid ${q}: ${H}`)),!1;ie+=2;break}case"binary":{if(H&&H===null)return V.destroy(new Error(`Invalid ${q}: ${H}`)),!1;ie+=1+a.byteLength(H)+2;break}case"int16":{if(typeof H!="number"||H<0||H>65535)return V.destroy(new Error(`Invalid ${q}: ${H}`)),!1;ie+=3;break}case"int32":{if(typeof H!="number"||H<0||H>4294967295)return V.destroy(new Error(`Invalid ${q}: ${H}`)),!1;ie+=5;break}case"var":{if(typeof H!="number"||H<0||H>268435455)return V.destroy(new Error(`Invalid ${q}: ${H}`)),!1;ie+=1+a.byteLength(p(H));break}case"string":{if(typeof H!="string")return V.destroy(new Error(`Invalid ${q}: ${H}`)),!1;ie+=3+a.byteLength(H.toString());break}case"pair":{if(typeof H!="object")return V.destroy(new Error(`Invalid ${q}: ${H}`)),!1;ie+=Object.getOwnPropertyNames(H).reduce((M,D)=>{let K=H[D];return Array.isArray(K)?M+=K.reduce((ne,te)=>(ne+=3+a.byteLength(D.toString())+2+a.byteLength(te.toString()),ne),0):M+=3+a.byteLength(D.toString())+2+a.byteLength(H[D].toString()),M},0);break}default:return V.destroy(new Error(`Invalid property ${q}: ${H}`)),!1}return ie}if(L)for(let q in L){let H=0,se=0,ie=L[q];if(ie!==void 0){if(Array.isArray(ie))for(let M=0;M<ie.length;M++){if(se=$(q,ie[M]),!se)return!1;H+=se}else{if(se=$(q,ie),!se)return!1;H=se}if(!H)return!1;Z+=H}}return{length:a.byteLength(p(Z))+Z,write(){pe(V,L,Z)}}}function C(V,L,Z,$){let q=["reasonString","userProperties"],H=Z&&Z.properties&&Z.properties.maximumPacketSize?Z.properties.maximumPacketSize:0,se=fe(V,L);if(H)for(;$+se.length>H;){let ie=q.shift();if(ie&&L[ie])delete L[ie],se=fe(V,L);else return!1}return se}function re(V,L,Z){switch(n.propertiesTypes[L]){case"byte":{V.write(a.from([n.properties[L]])),V.write(a.from([+Z]));break}case"int8":{V.write(a.from([n.properties[L]])),V.write(a.from([Z]));break}case"binary":{V.write(a.from([n.properties[L]])),G(V,Z);break}case"int16":{V.write(a.from([n.properties[L]])),b(V,Z);break}case"int32":{V.write(a.from([n.properties[L]])),_e(V,Z);break}case"var":{V.write(a.from([n.properties[L]])),J(V,Z);break}case"string":{V.write(a.from([n.properties[L]])),W(V,Z);break}case"pair":{Object.getOwnPropertyNames(Z).forEach($=>{let q=Z[$];Array.isArray(q)?q.forEach(H=>{V.write(a.from([n.properties[L]])),me(V,$.toString(),H.toString())}):(V.write(a.from([n.properties[L]])),me(V,$.toString(),q.toString()))});break}default:return V.destroy(new Error(`Invalid property ${L} value: ${Z}`)),!1}}function pe(V,L,Z){J(V,Z);for(let $ in L)if(Object.prototype.hasOwnProperty.call(L,$)&&L[$]!=null){let q=L[$];if(Array.isArray(q))for(let H=0;H<q.length;H++)re(V,$,q[H]);else re(V,$,q)}}function N(V){return V?V instanceof a?V.length:a.byteLength(V):0}function Ae(V){return typeof V=="string"||V instanceof a}f.exports=E}),Fa=be((s,f)=>{ue(),ce(),he();var n=Qo(),{EventEmitter:a}=(Xt(),Ne(jt)),{Buffer:c}=(Je(),Ne(Ye));function r(i,t){let o=new e;return n(i,o,t),o.concat()}var e=class extends a{constructor(){super(),this._array=new Array(20),this._i=0}write(i){return this._array[this._i++]=i,!0}concat(){let i=0,t=new Array(this._array.length),o=this._array,u=0,d;for(d=0;d<o.length&&o[d]!==void 0;d++)typeof o[d]!="string"?t[d]=o[d].length:t[d]=c.byteLength(o[d]),i+=t[d];let p=c.allocUnsafe(i);for(d=0;d<o.length&&o[d]!==void 0;d++)typeof o[d]!="string"?(o[d].copy(p,u),u+=t[d]):(p.write(o[d],u),u+=t[d]);return p}destroy(i){i&&this.emit("error",i)}};f.exports=r}),Wa=be(s=>{ue(),ce(),he(),s.parser=ja().parser,s.generate=Fa(),s.writeToStream=Qo()}),Ko=be(s=>{ue(),ce(),he(),Object.defineProperty(s,"__esModule",{value:!0});var f=class{constructor(){this.nextId=Math.max(1,Math.floor(Math.random()*65535))}allocate(){let n=this.nextId++;return this.nextId===65536&&(this.nextId=1),n}getLastAllocated(){return this.nextId===1?65535:this.nextId-1}register(n){return!0}deallocate(n){}clear(){}};s.default=f}),$a=be((s,f)=>{ue(),ce(),he(),f.exports=a;function n(r){return r instanceof Ur?Ur.from(r):new r.constructor(r.buffer.slice(),r.byteOffset,r.length)}function a(r){if(r=r||{},r.circles)return c(r);let e=new Map;if(e.set(Date,d=>new Date(d)),e.set(Map,(d,p)=>new Map(t(Array.from(d),p))),e.set(Set,(d,p)=>new Set(t(Array.from(d),p))),r.constructorHandlers)for(let d of r.constructorHandlers)e.set(d[0],d[1]);let i=null;return r.proto?u:o;function t(d,p){let m=Object.keys(d),b=new Array(m.length);for(let _=0;_<m.length;_++){let E=m[_],I=d[E];typeof I!="object"||I===null?b[E]=I:I.constructor!==Object&&(i=e.get(I.constructor))?b[E]=i(I,p):ArrayBuffer.isView(I)?b[E]=n(I):b[E]=p(I)}return b}function o(d){if(typeof d!="object"||d===null)return d;if(Array.isArray(d))return t(d,o);if(d.constructor!==Object&&(i=e.get(d.constructor)))return i(d,o);let p={};for(let m in d){if(Object.hasOwnProperty.call(d,m)===!1)continue;let b=d[m];typeof b!="object"||b===null?p[m]=b:b.constructor!==Object&&(i=e.get(b.constructor))?p[m]=i(b,o):ArrayBuffer.isView(b)?p[m]=n(b):p[m]=o(b)}return p}function u(d){if(typeof d!="object"||d===null)return d;if(Array.isArray(d))return t(d,u);if(d.constructor!==Object&&(i=e.get(d.constructor)))return i(d,u);let p={};for(let m in d){let b=d[m];typeof b!="object"||b===null?p[m]=b:b.constructor!==Object&&(i=e.get(b.constructor))?p[m]=i(b,u):ArrayBuffer.isView(b)?p[m]=n(b):p[m]=u(b)}return p}}function c(r){let e=[],i=[],t=new Map;if(t.set(Date,m=>new Date(m)),t.set(Map,(m,b)=>new Map(u(Array.from(m),b))),t.set(Set,(m,b)=>new Set(u(Array.from(m),b))),r.constructorHandlers)for(let m of r.constructorHandlers)t.set(m[0],m[1]);let o=null;return r.proto?p:d;function u(m,b){let _=Object.keys(m),E=new Array(_.length);for(let I=0;I<_.length;I++){let y=_[I],v=m[y];if(typeof v!="object"||v===null)E[y]=v;else if(v.constructor!==Object&&(o=t.get(v.constructor)))E[y]=o(v,b);else if(ArrayBuffer.isView(v))E[y]=n(v);else{let j=e.indexOf(v);j!==-1?E[y]=i[j]:E[y]=b(v)}}return E}function d(m){if(typeof m!="object"||m===null)return m;if(Array.isArray(m))return u(m,d);if(m.constructor!==Object&&(o=t.get(m.constructor)))return o(m,d);let b={};e.push(m),i.push(b);for(let _ in m){if(Object.hasOwnProperty.call(m,_)===!1)continue;let E=m[_];if(typeof E!="object"||E===null)b[_]=E;else if(E.constructor!==Object&&(o=t.get(E.constructor)))b[_]=o(E,d);else if(ArrayBuffer.isView(E))b[_]=n(E);else{let I=e.indexOf(E);I!==-1?b[_]=i[I]:b[_]=d(E)}}return e.pop(),i.pop(),b}function p(m){if(typeof m!="object"||m===null)return m;if(Array.isArray(m))return u(m,p);if(m.constructor!==Object&&(o=t.get(m.constructor)))return o(m,p);let b={};e.push(m),i.push(b);for(let _ in m){let E=m[_];if(typeof E!="object"||E===null)b[_]=E;else if(E.constructor!==Object&&(o=t.get(E.constructor)))b[_]=o(E,p);else if(ArrayBuffer.isView(E))b[_]=n(E);else{let I=e.indexOf(E);I!==-1?b[_]=i[I]:b[_]=p(E)}}return e.pop(),i.pop(),b}}}),qa=be((s,f)=>{ue(),ce(),he(),f.exports=$a()()}),Ha=be(s=>{ue(),ce(),he(),Object.defineProperty(s,"__esModule",{value:!0}),s.validateTopic=f,s.validateTopics=n;function f(a){let c=a.split("/");for(let r=0;r<c.length;r++)if(c[r]!=="+"){if(c[r]==="#")return r===c.length-1;if(c[r].indexOf("+")!==-1||c[r].indexOf("#")!==-1)return!1}return!0}function n(a){if(a.length===0)return"empty_topic_list";for(let c=0;c<a.length;c++)if(!f(a[c]))return a[c];return null}}),Yo=be(s=>{ue(),ce(),he(),Object.defineProperty(s,"__esModule",{value:!0});var f=er(),n={objectMode:!0},a={clean:!0},c=class{constructor(r){this.options=r||{},this.options=Object.assign(Object.assign({},a),r),this._inflights=new Map}put(r,e){return this._inflights.set(r.messageId,r),e&&e(),this}createStream(){let r=new f.Readable(n),e=[],i=!1,t=0;return this._inflights.forEach((o,u)=>{e.push(o)}),r._read=()=>{!i&&t<e.length?r.push(e[t++]):r.push(null)},r.destroy=o=>{if(!i)return i=!0,setTimeout(()=>{r.emit("close")},0),r},r}del(r,e){let i=this._inflights.get(r.messageId);return i?(this._inflights.delete(r.messageId),e(null,i)):e&&e(new Error("missing packet")),this}get(r,e){let i=this._inflights.get(r.messageId);return i?e(null,i):e&&e(new Error("missing packet")),this}close(r){this.options.clean&&(this._inflights=null),r&&r()}};s.default=c}),Va=be(s=>{ue(),ce(),he(),Object.defineProperty(s,"__esModule",{value:!0});var f=[0,16,128,131,135,144,145,151,153],n=(a,c,r)=>{a.log("handlePublish: packet %o",c),r=typeof r<"u"?r:a.noop;let e=c.topic.toString(),i=c.payload,{qos:t}=c,{messageId:o}=c,{options:u}=a;if(a.options.protocolVersion===5){let d;if(c.properties&&(d=c.properties.topicAlias),typeof d<"u")if(e.length===0)if(d>0&&d<=65535){let p=a.topicAliasRecv.getTopicByAlias(d);if(p)e=p,a.log("handlePublish :: topic complemented by alias. topic: %s - alias: %d",e,d);else{a.log("handlePublish :: unregistered topic alias. alias: %d",d),a.emit("error",new Error("Received unregistered Topic Alias"));return}}else{a.log("handlePublish :: topic alias out of range. alias: %d",d),a.emit("error",new Error("Received Topic Alias is out of range"));return}else if(a.topicAliasRecv.put(e,d))a.log("handlePublish :: registered topic: %s - alias: %d",e,d);else{a.log("handlePublish :: topic alias out of range. alias: %d",d),a.emit("error",new Error("Received Topic Alias is out of range"));return}}switch(a.log("handlePublish: qos %d",t),t){case 2:{u.customHandleAcks(e,i,c,(d,p)=>{if(typeof d=="number"&&(p=d,d=null),d)return a.emit("error",d);if(f.indexOf(p)===-1)return a.emit("error",new Error("Wrong reason code for pubrec"));p?a._sendPacket({cmd:"pubrec",messageId:o,reasonCode:p},r):a.incomingStore.put(c,()=>{a._sendPacket({cmd:"pubrec",messageId:o},r)})});break}case 1:{u.customHandleAcks(e,i,c,(d,p)=>{if(typeof d=="number"&&(p=d,d=null),d)return a.emit("error",d);if(f.indexOf(p)===-1)return a.emit("error",new Error("Wrong reason code for puback"));p||a.emit("message",e,i,c),a.handleMessage(c,m=>{if(m)return r&&r(m);a._sendPacket({cmd:"puback",messageId:o,reasonCode:p},r)})});break}case 0:a.emit("message",e,i,c),a.handleMessage(c,r);break;default:a.log("handlePublish: unknown QoS. Doing nothing.");break}};s.default=n}),za=be((s,f)=>{f.exports={version:"5.13.1"}}),sr=be(s=>{ue(),ce(),he(),Object.defineProperty(s,"__esModule",{value:!0}),s.MQTTJS_VERSION=s.nextTick=s.ErrorWithSubackPacket=s.ErrorWithReasonCode=void 0,s.applyMixin=a;var f=class Jo extends Error{constructor(r,e){super(r),this.code=e,Object.setPrototypeOf(this,Jo.prototype),Object.getPrototypeOf(this).name="ErrorWithReasonCode"}};s.ErrorWithReasonCode=f;var n=class Xo extends Error{constructor(r,e){super(r),this.packet=e,Object.setPrototypeOf(this,Xo.prototype),Object.getPrototypeOf(this).name="ErrorWithSubackPacket"}};s.ErrorWithSubackPacket=n;function a(c,r,e=!1){var i;let t=[r];for(;;){let o=t[0],u=Object.getPrototypeOf(o);if(u!=null&&u.prototype)t.unshift(u);else break}for(let o of t)for(let u of Object.getOwnPropertyNames(o.prototype))(e||u!=="constructor")&&Object.defineProperty(c.prototype,u,(i=Object.getOwnPropertyDescriptor(o.prototype,u))!==null&&i!==void 0?i:Object.create(null))}s.nextTick=typeof(Le==null?void 0:Le.nextTick)=="function"?Le.nextTick:c=>{setTimeout(c,0)},s.MQTTJS_VERSION=za().version}),$r=be(s=>{ue(),ce(),he(),Object.defineProperty(s,"__esModule",{value:!0}),s.ReasonCodes=void 0;var f=sr();s.ReasonCodes={0:"",1:"Unacceptable protocol version",2:"Identifier rejected",3:"Server unavailable",4:"Bad username or password",5:"Not authorized",16:"No matching subscribers",17:"No subscription existed",128:"Unspecified error",129:"Malformed Packet",130:"Protocol Error",131:"Implementation specific error",132:"Unsupported Protocol Version",133:"Client Identifier not valid",134:"Bad User Name or Password",135:"Not authorized",136:"Server unavailable",137:"Server busy",138:"Banned",139:"Server shutting down",140:"Bad authentication method",141:"Keep Alive timeout",142:"Session taken over",143:"Topic Filter invalid",144:"Topic Name invalid",145:"Packet identifier in use",146:"Packet Identifier not found",147:"Receive Maximum exceeded",148:"Topic Alias invalid",149:"Packet too large",150:"Message rate too high",151:"Quota exceeded",152:"Administrative action",153:"Payload format invalid",154:"Retain not supported",155:"QoS not supported",156:"Use another server",157:"Server moved",158:"Shared Subscriptions not supported",159:"Connection rate exceeded",160:"Maximum connect time",161:"Subscription Identifiers not supported",162:"Wildcard Subscriptions not supported"};var n=(a,c)=>{let{messageId:r}=c,e=c.cmd,i=null,t=a.outgoing[r]?a.outgoing[r].cb:null,o=null;if(!t){a.log("_handleAck :: Server sent an ack in error. Ignoring.");return}switch(a.log("_handleAck :: packet type",e),e){case"pubcomp":case"puback":{let u=c.reasonCode;u&&u>0&&u!==16?(o=new f.ErrorWithReasonCode(`Publish error: ${s.ReasonCodes[u]}`,u),a._removeOutgoingAndStoreMessage(r,()=>{t(o,c)})):a._removeOutgoingAndStoreMessage(r,t);break}case"pubrec":{i={cmd:"pubrel",qos:2,messageId:r};let u=c.reasonCode;u&&u>0&&u!==16?(o=new f.ErrorWithReasonCode(`Publish error: ${s.ReasonCodes[u]}`,u),a._removeOutgoingAndStoreMessage(r,()=>{t(o,c)})):a._sendPacket(i);break}case"suback":{delete a.outgoing[r],a.messageIdProvider.deallocate(r);let u=c.granted;for(let d=0;d<u.length;d++){let p=u[d];if((p&128)!==0){o=new Error(`Subscribe error: ${s.ReasonCodes[p]}`),o.code=p;let m=a.messageIdToTopic[r];m&&m.forEach(b=>{delete a._resubscribeTopics[b]})}}delete a.messageIdToTopic[r],a._invokeStoreProcessingQueue(),t(o,c);break}case"unsuback":{delete a.outgoing[r],a.messageIdProvider.deallocate(r),a._invokeStoreProcessingQueue(),t(null,c);break}default:a.emit("error",new Error("unrecognized packet type"))}a.disconnecting&&Object.keys(a.outgoing).length===0&&a.emit("outgoingEmpty")};s.default=n}),Ga=be(s=>{ue(),ce(),he(),Object.defineProperty(s,"__esModule",{value:!0});var f=sr(),n=$r(),a=(c,r)=>{let{options:e}=c,i=e.protocolVersion,t=i===5?r.reasonCode:r.returnCode;if(i!==5){let o=new f.ErrorWithReasonCode(`Protocol error: Auth packets are only supported in MQTT 5. Your version:${i}`,t);c.emit("error",o);return}c.handleAuth(r,(o,u)=>{if(o){c.emit("error",o);return}if(t===24)c.reconnecting=!1,c._sendPacket(u);else{let d=new f.ErrorWithReasonCode(`Connection refused: ${n.ReasonCodes[t]}`,t);c.emit("error",d)}})};s.default=a}),Qa=be(s=>{var m,b,_,E,I,y,v,j,x,A,T,B,Y,X,ae,P,Q,J,W,me,de,ge,_e,G,fe,C,re,pe,N,pn,V,L,Z,$,Zo,H,se,ie,xt,Bt,gn,Pr,Cr,Fe,mn,fr,Lt,bn,Pe;ue(),ce(),he(),Object.defineProperty(s,"__esModule",{value:!0}),s.LRUCache=void 0;var f=typeof performance=="object"&&performance&&typeof performance.now=="function"?performance:Date,n=new Set,a=typeof Le=="object"&&Le?Le:{},c=(l,h,g,w)=>{typeof a.emitWarning=="function"?a.emitWarning(l,h,g,w):console.error(`[${g}] ${h}: ${l}`)},r=globalThis.AbortController,e=globalThis.AbortSignal;if(typeof r>"u"){e=class{constructor(){Te(this,"onabort");Te(this,"_onabort",[]);Te(this,"reason");Te(this,"aborted",!1)}addEventListener(g,w){this._onabort.push(w)}},r=class{constructor(){Te(this,"signal",new e);h()}abort(g){var w,k;if(!this.signal.aborted){this.signal.reason=g,this.signal.aborted=!0;for(let U of this.signal._onabort)U(g);(k=(w=this.signal).onabort)==null||k.call(w,g)}}};let l=((m=a.env)==null?void 0:m.LRU_CACHE_IGNORE_AC_WARNING)!=="1",h=()=>{l&&(l=!1,c("AbortController is not defined. If using lru-cache in node 14, load an AbortController polyfill from the `node-abort-controller` package. A minimal polyfill is provided for use by LRUCache.fetch(), but it should not be relied upon in other contexts (eg, passing it to other APIs that use AbortController/AbortSignal might have undesirable effects). You may disable this with LRU_CACHE_IGNORE_AC_WARNING=1 in the env.","NO_ABORT_CONTROLLER","ENOTSUP",h))}}var i=l=>!n.has(l),t=l=>l&&l===Math.floor(l)&&l>0&&isFinite(l),o=l=>t(l)?l<=Math.pow(2,8)?Uint8Array:l<=Math.pow(2,16)?Uint16Array:l<=Math.pow(2,32)?Uint32Array:l<=Number.MAX_SAFE_INTEGER?u:null:null,u=class extends Array{constructor(l){super(l),this.fill(0)}},d=(b=class{constructor(h,g){Te(this,"heap");Te(this,"length");if(!O(b,_))throw new TypeError("instantiate Stack using Stack.create(n)");this.heap=new g(h),this.length=0}static create(h){let g=o(h);if(!g)return[];Re(b,_,!0);let w=new b(h,g);return Re(b,_,!1),w}push(h){this.heap[this.length++]=h}pop(){return this.heap[--this.length]}},_=new WeakMap,Be(b,_,!1),b),p=(Pe=class{constructor(h){Be(this,N);Be(this,y);Be(this,v);Be(this,j);Be(this,x);Be(this,A);Be(this,T);Te(this,"ttl");Te(this,"ttlResolution");Te(this,"ttlAutopurge");Te(this,"updateAgeOnGet");Te(this,"updateAgeOnHas");Te(this,"allowStale");Te(this,"noDisposeOnSet");Te(this,"noUpdateTTL");Te(this,"maxEntrySize");Te(this,"sizeCalculation");Te(this,"noDeleteOnFetchRejection");Te(this,"noDeleteOnStaleGet");Te(this,"allowStaleOnFetchAbort");Te(this,"allowStaleOnFetchRejection");Te(this,"ignoreFetchAbort");Be(this,B);Be(this,Y);Be(this,X);Be(this,ae);Be(this,P);Be(this,Q);Be(this,J);Be(this,W);Be(this,me);Be(this,de);Be(this,ge);Be(this,_e);Be(this,G);Be(this,fe);Be(this,C);Be(this,re);Be(this,pe);Be(this,V,()=>{});Be(this,L,()=>{});Be(this,Z,()=>{});Be(this,$,()=>!1);Be(this,H,h=>{});Be(this,se,(h,g,w)=>{});Be(this,ie,(h,g,w,k)=>{if(w||k)throw new TypeError("cannot set size without setting maxSize or maxEntrySize on cache");return 0});Te(this,E,"LRUCache");let{max:g=0,ttl:w,ttlResolution:k=1,ttlAutopurge:U,updateAgeOnGet:z,updateAgeOnHas:ve,allowStale:Ee,dispose:Oe,disposeAfter:xe,noDisposeOnSet:Ce,noUpdateTTL:pt,maxSize:st=0,maxEntrySize:lt=0,sizeCalculation:We,fetchMethod:Ke,memoMethod:Me,noDeleteOnFetchRejection:De,noDeleteOnStaleGet:Xe,allowStaleOnFetchRejection:Ge,allowStaleOnFetchAbort:rt,ignoreFetchAbort:Pt}=h;if(g!==0&&!t(g))throw new TypeError("max option must be a nonnegative integer");let S=g?o(g):Array;if(!S)throw new Error("invalid max value: "+g);if(Re(this,y,g),Re(this,v,st),this.maxEntrySize=lt||O(this,v),this.sizeCalculation=We,this.sizeCalculation){if(!O(this,v)&&!this.maxEntrySize)throw new TypeError("cannot set sizeCalculation without setting maxSize or maxEntrySize");if(typeof this.sizeCalculation!="function")throw new TypeError("sizeCalculation set to non-function")}if(Me!==void 0&&typeof Me!="function")throw new TypeError("memoMethod must be a function if defined");if(Re(this,T,Me),Ke!==void 0&&typeof Ke!="function")throw new TypeError("fetchMethod must be a function if specified");if(Re(this,A,Ke),Re(this,re,!!Ke),Re(this,X,new Map),Re(this,ae,new Array(g).fill(void 0)),Re(this,P,new Array(g).fill(void 0)),Re(this,Q,new S(g)),Re(this,J,new S(g)),Re(this,W,0),Re(this,me,0),Re(this,de,d.create(g)),Re(this,B,0),Re(this,Y,0),typeof Oe=="function"&&Re(this,j,Oe),typeof xe=="function"?(Re(this,x,xe),Re(this,ge,[])):(Re(this,x,void 0),Re(this,ge,void 0)),Re(this,C,!!O(this,j)),Re(this,pe,!!O(this,x)),this.noDisposeOnSet=!!Ce,this.noUpdateTTL=!!pt,this.noDeleteOnFetchRejection=!!De,this.allowStaleOnFetchRejection=!!Ge,this.allowStaleOnFetchAbort=!!rt,this.ignoreFetchAbort=!!Pt,this.maxEntrySize!==0){if(O(this,v)!==0&&!t(O(this,v)))throw new TypeError("maxSize must be a positive integer if specified");if(!t(this.maxEntrySize))throw new TypeError("maxEntrySize must be a positive integer if specified");Ie(this,N,Zo).call(this)}if(this.allowStale=!!Ee,this.noDeleteOnStaleGet=!!Xe,this.updateAgeOnGet=!!z,this.updateAgeOnHas=!!ve,this.ttlResolution=t(k)||k===0?k:1,this.ttlAutopurge=!!U,this.ttl=w||0,this.ttl){if(!t(this.ttl))throw new TypeError("ttl must be a positive integer if specified");Ie(this,N,pn).call(this)}if(O(this,y)===0&&this.ttl===0&&O(this,v)===0)throw new TypeError("At least one of max, maxSize, or ttl is required");if(!this.ttlAutopurge&&!O(this,y)&&!O(this,v)){let R="LRU_CACHE_UNBOUNDED";i(R)&&(n.add(R),c("TTL caching without ttlAutopurge, max, or maxSize can result in unbounded memory consumption.","UnboundedCacheWarning",R,Pe))}}static unsafeExposeInternals(h){return{starts:O(h,G),ttls:O(h,fe),sizes:O(h,_e),keyMap:O(h,X),keyList:O(h,ae),valList:O(h,P),next:O(h,Q),prev:O(h,J),get head(){return O(h,W)},get tail(){return O(h,me)},free:O(h,de),isBackgroundFetch:g=>{var w;return Ie(w=h,N,Fe).call(w,g)},backgroundFetch:(g,w,k,U)=>{var z;return Ie(z=h,N,Cr).call(z,g,w,k,U)},moveToTail:g=>{var w;return Ie(w=h,N,fr).call(w,g)},indexes:g=>{var w;return Ie(w=h,N,xt).call(w,g)},rindexes:g=>{var w;return Ie(w=h,N,Bt).call(w,g)},isStale:g=>{var w;return O(w=h,$).call(w,g)}}}get max(){return O(this,y)}get maxSize(){return O(this,v)}get calculatedSize(){return O(this,Y)}get size(){return O(this,B)}get fetchMethod(){return O(this,A)}get memoMethod(){return O(this,T)}get dispose(){return O(this,j)}get disposeAfter(){return O(this,x)}getRemainingTTL(h){return O(this,X).has(h)?1/0:0}*entries(){for(let h of Ie(this,N,xt).call(this))O(this,P)[h]!==void 0&&O(this,ae)[h]!==void 0&&!Ie(this,N,Fe).call(this,O(this,P)[h])&&(yield[O(this,ae)[h],O(this,P)[h]])}*rentries(){for(let h of Ie(this,N,Bt).call(this))O(this,P)[h]!==void 0&&O(this,ae)[h]!==void 0&&!Ie(this,N,Fe).call(this,O(this,P)[h])&&(yield[O(this,ae)[h],O(this,P)[h]])}*keys(){for(let h of Ie(this,N,xt).call(this)){let g=O(this,ae)[h];g!==void 0&&!Ie(this,N,Fe).call(this,O(this,P)[h])&&(yield g)}}*rkeys(){for(let h of Ie(this,N,Bt).call(this)){let g=O(this,ae)[h];g!==void 0&&!Ie(this,N,Fe).call(this,O(this,P)[h])&&(yield g)}}*values(){for(let h of Ie(this,N,xt).call(this))O(this,P)[h]!==void 0&&!Ie(this,N,Fe).call(this,O(this,P)[h])&&(yield O(this,P)[h])}*rvalues(){for(let h of Ie(this,N,Bt).call(this))O(this,P)[h]!==void 0&&!Ie(this,N,Fe).call(this,O(this,P)[h])&&(yield O(this,P)[h])}[(I=Symbol.iterator,E=Symbol.toStringTag,I)](){return this.entries()}find(h,g={}){for(let w of Ie(this,N,xt).call(this)){let k=O(this,P)[w],U=Ie(this,N,Fe).call(this,k)?k.__staleWhileFetching:k;if(U!==void 0&&h(U,O(this,ae)[w],this))return this.get(O(this,ae)[w],g)}}forEach(h,g=this){for(let w of Ie(this,N,xt).call(this)){let k=O(this,P)[w],U=Ie(this,N,Fe).call(this,k)?k.__staleWhileFetching:k;U!==void 0&&h.call(g,U,O(this,ae)[w],this)}}rforEach(h,g=this){for(let w of Ie(this,N,Bt).call(this)){let k=O(this,P)[w],U=Ie(this,N,Fe).call(this,k)?k.__staleWhileFetching:k;U!==void 0&&h.call(g,U,O(this,ae)[w],this)}}purgeStale(){let h=!1;for(let g of Ie(this,N,Bt).call(this,{allowStale:!0}))O(this,$).call(this,g)&&(Ie(this,N,Lt).call(this,O(this,ae)[g],"expire"),h=!0);return h}info(h){let g=O(this,X).get(h);if(g===void 0)return;let w=O(this,P)[g],k=Ie(this,N,Fe).call(this,w)?w.__staleWhileFetching:w;if(k===void 0)return;let U={value:k};if(O(this,fe)&&O(this,G)){let z=O(this,fe)[g],ve=O(this,G)[g];if(z&&ve){let Ee=z-(f.now()-ve);U.ttl=Ee,U.start=Date.now()}}return O(this,_e)&&(U.size=O(this,_e)[g]),U}dump(){let h=[];for(let g of Ie(this,N,xt).call(this,{allowStale:!0})){let w=O(this,ae)[g],k=O(this,P)[g],U=Ie(this,N,Fe).call(this,k)?k.__staleWhileFetching:k;if(U===void 0||w===void 0)continue;let z={value:U};if(O(this,fe)&&O(this,G)){z.ttl=O(this,fe)[g];let ve=f.now()-O(this,G)[g];z.start=Math.floor(Date.now()-ve)}O(this,_e)&&(z.size=O(this,_e)[g]),h.unshift([w,z])}return h}load(h){this.clear();for(let[g,w]of h){if(w.start){let k=Date.now()-w.start;w.start=f.now()-k}this.set(g,w.value,w)}}set(h,g,w={}){var pt,st,lt,We,Ke;if(g===void 0)return this.delete(h),this;let{ttl:k=this.ttl,start:U,noDisposeOnSet:z=this.noDisposeOnSet,sizeCalculation:ve=this.sizeCalculation,status:Ee}=w,{noUpdateTTL:Oe=this.noUpdateTTL}=w,xe=O(this,ie).call(this,h,g,w.size||0,ve);if(this.maxEntrySize&&xe>this.maxEntrySize)return Ee&&(Ee.set="miss",Ee.maxEntrySizeExceeded=!0),Ie(this,N,Lt).call(this,h,"set"),this;let Ce=O(this,B)===0?void 0:O(this,X).get(h);if(Ce===void 0)Ce=O(this,B)===0?O(this,me):O(this,de).length!==0?O(this,de).pop():O(this,B)===O(this,y)?Ie(this,N,Pr).call(this,!1):O(this,B),O(this,ae)[Ce]=h,O(this,P)[Ce]=g,O(this,X).set(h,Ce),O(this,Q)[O(this,me)]=Ce,O(this,J)[Ce]=O(this,me),Re(this,me,Ce),vr(this,B)._++,O(this,se).call(this,Ce,xe,Ee),Ee&&(Ee.set="add"),Oe=!1;else{Ie(this,N,fr).call(this,Ce);let Me=O(this,P)[Ce];if(g!==Me){if(O(this,re)&&Ie(this,N,Fe).call(this,Me)){Me.__abortController.abort(new Error("replaced"));let{__staleWhileFetching:De}=Me;De!==void 0&&!z&&(O(this,C)&&((pt=O(this,j))==null||pt.call(this,De,h,"set")),O(this,pe)&&((st=O(this,ge))==null||st.push([De,h,"set"])))}else z||(O(this,C)&&((lt=O(this,j))==null||lt.call(this,Me,h,"set")),O(this,pe)&&((We=O(this,ge))==null||We.push([Me,h,"set"])));if(O(this,H).call(this,Ce),O(this,se).call(this,Ce,xe,Ee),O(this,P)[Ce]=g,Ee){Ee.set="replace";let De=Me&&Ie(this,N,Fe).call(this,Me)?Me.__staleWhileFetching:Me;De!==void 0&&(Ee.oldValue=De)}}else Ee&&(Ee.set="update")}if(k!==0&&!O(this,fe)&&Ie(this,N,pn).call(this),O(this,fe)&&(Oe||O(this,Z).call(this,Ce,k,U),Ee&&O(this,L).call(this,Ee,Ce)),!z&&O(this,pe)&&O(this,ge)){let Me=O(this,ge),De;for(;De=Me==null?void 0:Me.shift();)(Ke=O(this,x))==null||Ke.call(this,...De)}return this}pop(){var h;try{for(;O(this,B);){let g=O(this,P)[O(this,W)];if(Ie(this,N,Pr).call(this,!0),Ie(this,N,Fe).call(this,g)){if(g.__staleWhileFetching)return g.__staleWhileFetching}else if(g!==void 0)return g}}finally{if(O(this,pe)&&O(this,ge)){let g=O(this,ge),w;for(;w=g==null?void 0:g.shift();)(h=O(this,x))==null||h.call(this,...w)}}}has(h,g={}){let{updateAgeOnHas:w=this.updateAgeOnHas,status:k}=g,U=O(this,X).get(h);if(U!==void 0){let z=O(this,P)[U];if(Ie(this,N,Fe).call(this,z)&&z.__staleWhileFetching===void 0)return!1;if(O(this,$).call(this,U))k&&(k.has="stale",O(this,L).call(this,k,U));else return w&&O(this,V).call(this,U),k&&(k.has="hit",O(this,L).call(this,k,U)),!0}else k&&(k.has="miss");return!1}peek(h,g={}){let{allowStale:w=this.allowStale}=g,k=O(this,X).get(h);if(k===void 0||!w&&O(this,$).call(this,k))return;let U=O(this,P)[k];return Ie(this,N,Fe).call(this,U)?U.__staleWhileFetching:U}async fetch(h,g={}){let{allowStale:w=this.allowStale,updateAgeOnGet:k=this.updateAgeOnGet,noDeleteOnStaleGet:U=this.noDeleteOnStaleGet,ttl:z=this.ttl,noDisposeOnSet:ve=this.noDisposeOnSet,size:Ee=0,sizeCalculation:Oe=this.sizeCalculation,noUpdateTTL:xe=this.noUpdateTTL,noDeleteOnFetchRejection:Ce=this.noDeleteOnFetchRejection,allowStaleOnFetchRejection:pt=this.allowStaleOnFetchRejection,ignoreFetchAbort:st=this.ignoreFetchAbort,allowStaleOnFetchAbort:lt=this.allowStaleOnFetchAbort,context:We,forceRefresh:Ke=!1,status:Me,signal:De}=g;if(!O(this,re))return Me&&(Me.fetch="get"),this.get(h,{allowStale:w,updateAgeOnGet:k,noDeleteOnStaleGet:U,status:Me});let Xe={allowStale:w,updateAgeOnGet:k,noDeleteOnStaleGet:U,ttl:z,noDisposeOnSet:ve,size:Ee,sizeCalculation:Oe,noUpdateTTL:xe,noDeleteOnFetchRejection:Ce,allowStaleOnFetchRejection:pt,allowStaleOnFetchAbort:lt,ignoreFetchAbort:st,status:Me,signal:De},Ge=O(this,X).get(h);if(Ge===void 0){Me&&(Me.fetch="miss");let rt=Ie(this,N,Cr).call(this,h,Ge,Xe,We);return rt.__returned=rt}else{let rt=O(this,P)[Ge];if(Ie(this,N,Fe).call(this,rt)){let we=w&&rt.__staleWhileFetching!==void 0;return Me&&(Me.fetch="inflight",we&&(Me.returnedStale=!0)),we?rt.__staleWhileFetching:rt.__returned=rt}let Pt=O(this,$).call(this,Ge);if(!Ke&&!Pt)return Me&&(Me.fetch="hit"),Ie(this,N,fr).call(this,Ge),k&&O(this,V).call(this,Ge),Me&&O(this,L).call(this,Me,Ge),rt;let S=Ie(this,N,Cr).call(this,h,Ge,Xe,We),R=S.__staleWhileFetching!==void 0&&w;return Me&&(Me.fetch=Pt?"stale":"refresh",R&&Pt&&(Me.returnedStale=!0)),R?S.__staleWhileFetching:S.__returned=S}}async forceFetch(h,g={}){let w=await this.fetch(h,g);if(w===void 0)throw new Error("fetch() returned undefined");return w}memo(h,g={}){let w=O(this,T);if(!w)throw new Error("no memoMethod provided to constructor");let{context:k,forceRefresh:U,...z}=g,ve=this.get(h,z);if(!U&&ve!==void 0)return ve;let Ee=w(h,ve,{options:z,context:k});return this.set(h,Ee,z),Ee}get(h,g={}){let{allowStale:w=this.allowStale,updateAgeOnGet:k=this.updateAgeOnGet,noDeleteOnStaleGet:U=this.noDeleteOnStaleGet,status:z}=g,ve=O(this,X).get(h);if(ve!==void 0){let Ee=O(this,P)[ve],Oe=Ie(this,N,Fe).call(this,Ee);return z&&O(this,L).call(this,z,ve),O(this,$).call(this,ve)?(z&&(z.get="stale"),Oe?(z&&w&&Ee.__staleWhileFetching!==void 0&&(z.returnedStale=!0),w?Ee.__staleWhileFetching:void 0):(U||Ie(this,N,Lt).call(this,h,"expire"),z&&w&&(z.returnedStale=!0),w?Ee:void 0)):(z&&(z.get="hit"),Oe?Ee.__staleWhileFetching:(Ie(this,N,fr).call(this,ve),k&&O(this,V).call(this,ve),Ee))}else z&&(z.get="miss")}delete(h){return Ie(this,N,Lt).call(this,h,"delete")}clear(){return Ie(this,N,bn).call(this,"delete")}},y=new WeakMap,v=new WeakMap,j=new WeakMap,x=new WeakMap,A=new WeakMap,T=new WeakMap,B=new WeakMap,Y=new WeakMap,X=new WeakMap,ae=new WeakMap,P=new WeakMap,Q=new WeakMap,J=new WeakMap,W=new WeakMap,me=new WeakMap,de=new WeakMap,ge=new WeakMap,_e=new WeakMap,G=new WeakMap,fe=new WeakMap,C=new WeakMap,re=new WeakMap,pe=new WeakMap,N=new WeakSet,pn=function(){let h=new u(O(this,y)),g=new u(O(this,y));Re(this,fe,h),Re(this,G,g),Re(this,Z,(U,z,ve=f.now())=>{if(g[U]=z!==0?ve:0,h[U]=z,z!==0&&this.ttlAutopurge){let Ee=setTimeout(()=>{O(this,$).call(this,U)&&Ie(this,N,Lt).call(this,O(this,ae)[U],"expire")},z+1);Ee.unref&&Ee.unref()}}),Re(this,V,U=>{g[U]=h[U]!==0?f.now():0}),Re(this,L,(U,z)=>{if(h[z]){let ve=h[z],Ee=g[z];if(!ve||!Ee)return;U.ttl=ve,U.start=Ee,U.now=w||k();let Oe=U.now-Ee;U.remainingTTL=ve-Oe}});let w=0,k=()=>{let U=f.now();if(this.ttlResolution>0){w=U;let z=setTimeout(()=>w=0,this.ttlResolution);z.unref&&z.unref()}return U};this.getRemainingTTL=U=>{let z=O(this,X).get(U);if(z===void 0)return 0;let ve=h[z],Ee=g[z];if(!ve||!Ee)return 1/0;let Oe=(w||k())-Ee;return ve-Oe},Re(this,$,U=>{let z=g[U],ve=h[U];return!!ve&&!!z&&(w||k())-z>ve})},V=new WeakMap,L=new WeakMap,Z=new WeakMap,$=new WeakMap,Zo=function(){let h=new u(O(this,y));Re(this,Y,0),Re(this,_e,h),Re(this,H,g=>{Re(this,Y,O(this,Y)-h[g]),h[g]=0}),Re(this,ie,(g,w,k,U)=>{if(Ie(this,N,Fe).call(this,w))return 0;if(!t(k))if(U){if(typeof U!="function")throw new TypeError("sizeCalculation must be a function");if(k=U(w,g),!t(k))throw new TypeError("sizeCalculation return invalid (expect positive integer)")}else throw new TypeError("invalid size value (must be positive integer). When maxSize or maxEntrySize is used, sizeCalculation or size must be set.");return k}),Re(this,se,(g,w,k)=>{if(h[g]=w,O(this,v)){let U=O(this,v)-h[g];for(;O(this,Y)>U;)Ie(this,N,Pr).call(this,!0)}Re(this,Y,O(this,Y)+h[g]),k&&(k.entrySize=w,k.totalCalculatedSize=O(this,Y))})},H=new WeakMap,se=new WeakMap,ie=new WeakMap,xt=function*({allowStale:h=this.allowStale}={}){if(O(this,B))for(let g=O(this,me);!(!Ie(this,N,gn).call(this,g)||((h||!O(this,$).call(this,g))&&(yield g),g===O(this,W)));)g=O(this,J)[g]},Bt=function*({allowStale:h=this.allowStale}={}){if(O(this,B))for(let g=O(this,W);!(!Ie(this,N,gn).call(this,g)||((h||!O(this,$).call(this,g))&&(yield g),g===O(this,me)));)g=O(this,Q)[g]},gn=function(h){return h!==void 0&&O(this,X).get(O(this,ae)[h])===h},Pr=function(h){var U,z;let g=O(this,W),w=O(this,ae)[g],k=O(this,P)[g];return O(this,re)&&Ie(this,N,Fe).call(this,k)?k.__abortController.abort(new Error("evicted")):(O(this,C)||O(this,pe))&&(O(this,C)&&((U=O(this,j))==null||U.call(this,k,w,"evict")),O(this,pe)&&((z=O(this,ge))==null||z.push([k,w,"evict"]))),O(this,H).call(this,g),h&&(O(this,ae)[g]=void 0,O(this,P)[g]=void 0,O(this,de).push(g)),O(this,B)===1?(Re(this,W,Re(this,me,0)),O(this,de).length=0):Re(this,W,O(this,Q)[g]),O(this,X).delete(w),vr(this,B)._--,g},Cr=function(h,g,w,k){let U=g===void 0?void 0:O(this,P)[g];if(Ie(this,N,Fe).call(this,U))return U;let z=new r,{signal:ve}=w;ve==null||ve.addEventListener("abort",()=>z.abort(ve.reason),{signal:z.signal});let Ee={signal:z.signal,options:w,context:k},Oe=(We,Ke=!1)=>{let{aborted:Me}=z.signal,De=w.ignoreFetchAbort&&We!==void 0;if(w.status&&(Me&&!Ke?(w.status.fetchAborted=!0,w.status.fetchError=z.signal.reason,De&&(w.status.fetchAbortIgnored=!0)):w.status.fetchResolved=!0),Me&&!De&&!Ke)return Ce(z.signal.reason);let Xe=st;return O(this,P)[g]===st&&(We===void 0?Xe.__staleWhileFetching?O(this,P)[g]=Xe.__staleWhileFetching:Ie(this,N,Lt).call(this,h,"fetch"):(w.status&&(w.status.fetchUpdated=!0),this.set(h,We,Ee.options))),We},xe=We=>(w.status&&(w.status.fetchRejected=!0,w.status.fetchError=We),Ce(We)),Ce=We=>{let{aborted:Ke}=z.signal,Me=Ke&&w.allowStaleOnFetchAbort,De=Me||w.allowStaleOnFetchRejection,Xe=De||w.noDeleteOnFetchRejection,Ge=st;if(O(this,P)[g]===st&&(!Xe||Ge.__staleWhileFetching===void 0?Ie(this,N,Lt).call(this,h,"fetch"):Me||(O(this,P)[g]=Ge.__staleWhileFetching)),De)return w.status&&Ge.__staleWhileFetching!==void 0&&(w.status.returnedStale=!0),Ge.__staleWhileFetching;if(Ge.__returned===Ge)throw We},pt=(We,Ke)=>{var De;let Me=(De=O(this,A))==null?void 0:De.call(this,h,U,Ee);Me&&Me instanceof Promise&&Me.then(Xe=>We(Xe===void 0?void 0:Xe),Ke),z.signal.addEventListener("abort",()=>{(!w.ignoreFetchAbort||w.allowStaleOnFetchAbort)&&(We(void 0),w.allowStaleOnFetchAbort&&(We=Xe=>Oe(Xe,!0)))})};w.status&&(w.status.fetchDispatched=!0);let st=new Promise(pt).then(Oe,xe),lt=Object.assign(st,{__abortController:z,__staleWhileFetching:U,__returned:void 0});return g===void 0?(this.set(h,lt,{...Ee.options,status:void 0}),g=O(this,X).get(h)):O(this,P)[g]=lt,lt},Fe=function(h){if(!O(this,re))return!1;let g=h;return!!g&&g instanceof Promise&&g.hasOwnProperty("__staleWhileFetching")&&g.__abortController instanceof r},mn=function(h,g){O(this,J)[g]=h,O(this,Q)[h]=g},fr=function(h){h!==O(this,me)&&(h===O(this,W)?Re(this,W,O(this,Q)[h]):Ie(this,N,mn).call(this,O(this,J)[h],O(this,Q)[h]),Ie(this,N,mn).call(this,O(this,me),h),Re(this,me,h))},Lt=function(h,g){var k,U,z,ve;let w=!1;if(O(this,B)!==0){let Ee=O(this,X).get(h);if(Ee!==void 0)if(w=!0,O(this,B)===1)Ie(this,N,bn).call(this,g);else{O(this,H).call(this,Ee);let Oe=O(this,P)[Ee];if(Ie(this,N,Fe).call(this,Oe)?Oe.__abortController.abort(new Error("deleted")):(O(this,C)||O(this,pe))&&(O(this,C)&&((k=O(this,j))==null||k.call(this,Oe,h,g)),O(this,pe)&&((U=O(this,ge))==null||U.push([Oe,h,g]))),O(this,X).delete(h),O(this,ae)[Ee]=void 0,O(this,P)[Ee]=void 0,Ee===O(this,me))Re(this,me,O(this,J)[Ee]);else if(Ee===O(this,W))Re(this,W,O(this,Q)[Ee]);else{let xe=O(this,J)[Ee];O(this,Q)[xe]=O(this,Q)[Ee];let Ce=O(this,Q)[Ee];O(this,J)[Ce]=O(this,J)[Ee]}vr(this,B)._--,O(this,de).push(Ee)}}if(O(this,pe)&&((z=O(this,ge))!=null&&z.length)){let Ee=O(this,ge),Oe;for(;Oe=Ee==null?void 0:Ee.shift();)(ve=O(this,x))==null||ve.call(this,...Oe)}return w},bn=function(h){var g,w,k;for(let U of Ie(this,N,Bt).call(this,{allowStale:!0})){let z=O(this,P)[U];if(Ie(this,N,Fe).call(this,z))z.__abortController.abort(new Error("deleted"));else{let ve=O(this,ae)[U];O(this,C)&&((g=O(this,j))==null||g.call(this,z,ve,h)),O(this,pe)&&((w=O(this,ge))==null||w.push([z,ve,h]))}}if(O(this,X).clear(),O(this,P).fill(void 0),O(this,ae).fill(void 0),O(this,fe)&&O(this,G)&&(O(this,fe).fill(0),O(this,G).fill(0)),O(this,_e)&&O(this,_e).fill(0),Re(this,W,0),Re(this,me,0),O(this,de).length=0,Re(this,Y,0),Re(this,B,0),O(this,pe)&&O(this,ge)){let U=O(this,ge),z;for(;z=U==null?void 0:U.shift();)(k=O(this,x))==null||k.call(this,...z)}},Pe);s.LRUCache=p}),Ot=be(s=>{ue(),ce(),he(),Object.defineProperty(s,"t",{value:!0}),s.ContainerIterator=s.Container=s.Base=void 0;var f=class{constructor(c=0){this.iteratorType=c}equals(c){return this.o===c.o}};s.ContainerIterator=f;var n=class{constructor(){this.i=0}get length(){return this.i}size(){return this.i}empty(){return this.i===0}};s.Base=n;var a=class extends n{};s.Container=a}),Ka=be(s=>{ue(),ce(),he(),Object.defineProperty(s,"t",{value:!0}),s.default=void 0;var f=Ot(),n=class extends f.Base{constructor(c=[]){super(),this.S=[];let r=this;c.forEach(function(e){r.push(e)})}clear(){this.i=0,this.S=[]}push(c){return this.S.push(c),this.i+=1,this.i}pop(){if(this.i!==0)return this.i-=1,this.S.pop()}top(){return this.S[this.i-1]}},a=n;s.default=a}),Ya=be(s=>{ue(),ce(),he(),Object.defineProperty(s,"t",{value:!0}),s.default=void 0;var f=Ot(),n=class extends f.Base{constructor(c=[]){super(),this.j=0,this.q=[];let r=this;c.forEach(function(e){r.push(e)})}clear(){this.q=[],this.i=this.j=0}push(c){let r=this.q.length;if(this.j/r>.5&&this.j+this.i>=r&&r>4096){let e=this.i;for(let i=0;i<e;++i)this.q[i]=this.q[this.j+i];this.j=0,this.q[this.i]=c}else this.q[this.j+this.i]=c;return++this.i}pop(){if(this.i===0)return;let c=this.q[this.j++];return this.i-=1,c}front(){if(this.i!==0)return this.q[this.j]}},a=n;s.default=a}),Ja=be(s=>{ue(),ce(),he(),Object.defineProperty(s,"t",{value:!0}),s.default=void 0;var f=Ot(),n=class extends f.Base{constructor(c=[],r=function(i,t){return i>t?-1:i<t?1:0},e=!0){if(super(),this.v=r,Array.isArray(c))this.C=e?[...c]:c;else{this.C=[];let t=this;c.forEach(function(o){t.C.push(o)})}this.i=this.C.length;let i=this.i>>1;for(let t=this.i-1>>1;t>=0;--t)this.k(t,i)}m(c){let r=this.C[c];for(;c>0;){let e=c-1>>1,i=this.C[e];if(this.v(i,r)<=0)break;this.C[c]=i,c=e}this.C[c]=r}k(c,r){let e=this.C[c];for(;c<r;){let i=c<<1|1,t=i+1,o=this.C[i];if(t<this.i&&this.v(o,this.C[t])>0&&(i=t,o=this.C[t]),this.v(o,e)>=0)break;this.C[c]=o,c=i}this.C[c]=e}clear(){this.i=0,this.C.length=0}push(c){this.C.push(c),this.m(this.i),this.i+=1}pop(){if(this.i===0)return;let c=this.C[0],r=this.C.pop();return this.i-=1,this.i&&(this.C[0]=r,this.k(0,this.i>>1)),c}top(){return this.C[0]}find(c){return this.C.indexOf(c)>=0}remove(c){let r=this.C.indexOf(c);return r<0?!1:(r===0?this.pop():r===this.i-1?(this.C.pop(),this.i-=1):(this.C.splice(r,1,this.C.pop()),this.i-=1,this.m(r),this.k(r,this.i>>1)),!0)}updateItem(c){let r=this.C.indexOf(c);return r<0?!1:(this.m(r),this.k(r,this.i>>1),!0)}toArray(){return[...this.C]}},a=n;s.default=a}),xn=be(s=>{ue(),ce(),he(),Object.defineProperty(s,"t",{value:!0}),s.default=void 0;var f=Ot(),n=class extends f.Container{},a=n;s.default=a}),Rt=be(s=>{ue(),ce(),he(),Object.defineProperty(s,"t",{value:!0}),s.throwIteratorAccessError=f;function f(){throw new RangeError("Iterator access denied!")}}),es=be(s=>{ue(),ce(),he(),Object.defineProperty(s,"t",{value:!0}),s.RandomIterator=void 0;var f=Ot(),n=Rt(),a=class extends f.ContainerIterator{constructor(c,r){super(r),this.o=c,this.iteratorType===0?(this.pre=function(){return this.o===0&&(0,n.throwIteratorAccessError)(),this.o-=1,this},this.next=function(){return this.o===this.container.size()&&(0,n.throwIteratorAccessError)(),this.o+=1,this}):(this.pre=function(){return this.o===this.container.size()-1&&(0,n.throwIteratorAccessError)(),this.o+=1,this},this.next=function(){return this.o===-1&&(0,n.throwIteratorAccessError)(),this.o-=1,this})}get pointer(){return this.container.getElementByPos(this.o)}set pointer(c){this.container.setElementByPos(this.o,c)}};s.RandomIterator=a}),Xa=be(s=>{ue(),ce(),he(),Object.defineProperty(s,"t",{value:!0}),s.default=void 0;var f=a(xn()),n=es();function a(i){return i&&i.t?i:{default:i}}var c=class ts extends n.RandomIterator{constructor(t,o,u){super(t,u),this.container=o}copy(){return new ts(this.o,this.container,this.iteratorType)}},r=class extends f.default{constructor(i=[],t=!0){if(super(),Array.isArray(i))this.J=t?[...i]:i,this.i=i.length;else{this.J=[];let o=this;i.forEach(function(u){o.pushBack(u)})}}clear(){this.i=0,this.J.length=0}begin(){return new c(0,this)}end(){return new c(this.i,this)}rBegin(){return new c(this.i-1,this,1)}rEnd(){return new c(-1,this,1)}front(){return this.J[0]}back(){return this.J[this.i-1]}getElementByPos(i){if(i<0||i>this.i-1)throw new RangeError;return this.J[i]}eraseElementByPos(i){if(i<0||i>this.i-1)throw new RangeError;return this.J.splice(i,1),this.i-=1,this.i}eraseElementByValue(i){let t=0;for(let o=0;o<this.i;++o)this.J[o]!==i&&(this.J[t++]=this.J[o]);return this.i=this.J.length=t,this.i}eraseElementByIterator(i){let t=i.o;return i=i.next(),this.eraseElementByPos(t),i}pushBack(i){return this.J.push(i),this.i+=1,this.i}popBack(){if(this.i!==0)return this.i-=1,this.J.pop()}setElementByPos(i,t){if(i<0||i>this.i-1)throw new RangeError;this.J[i]=t}insert(i,t,o=1){if(i<0||i>this.i)throw new RangeError;return this.J.splice(i,0,...new Array(o).fill(t)),this.i+=o,this.i}find(i){for(let t=0;t<this.i;++t)if(this.J[t]===i)return new c(t,this);return this.end()}reverse(){this.J.reverse()}unique(){let i=1;for(let t=1;t<this.i;++t)this.J[t]!==this.J[t-1]&&(this.J[i++]=this.J[t]);return this.i=this.J.length=i,this.i}sort(i){this.J.sort(i)}forEach(i){for(let t=0;t<this.i;++t)i(this.J[t],t,this)}[Symbol.iterator](){return(function*(){yield*this.J}).bind(this)()}},e=r;s.default=e}),Za=be(s=>{ue(),ce(),he(),Object.defineProperty(s,"t",{value:!0}),s.default=void 0;var f=c(xn()),n=Ot(),a=Rt();function c(t){return t&&t.t?t:{default:t}}var r=class rs extends n.ContainerIterator{constructor(o,u,d,p){super(p),this.o=o,this.h=u,this.container=d,this.iteratorType===0?(this.pre=function(){return this.o.L===this.h&&(0,a.throwIteratorAccessError)(),this.o=this.o.L,this},this.next=function(){return this.o===this.h&&(0,a.throwIteratorAccessError)(),this.o=this.o.B,this}):(this.pre=function(){return this.o.B===this.h&&(0,a.throwIteratorAccessError)(),this.o=this.o.B,this},this.next=function(){return this.o===this.h&&(0,a.throwIteratorAccessError)(),this.o=this.o.L,this})}get pointer(){return this.o===this.h&&(0,a.throwIteratorAccessError)(),this.o.l}set pointer(o){this.o===this.h&&(0,a.throwIteratorAccessError)(),this.o.l=o}copy(){return new rs(this.o,this.h,this.container,this.iteratorType)}},e=class extends f.default{constructor(t=[]){super(),this.h={},this.p=this._=this.h.L=this.h.B=this.h;let o=this;t.forEach(function(u){o.pushBack(u)})}V(t){let{L:o,B:u}=t;o.B=u,u.L=o,t===this.p&&(this.p=u),t===this._&&(this._=o),this.i-=1}G(t,o){let u=o.B,d={l:t,L:o,B:u};o.B=d,u.L=d,o===this.h&&(this.p=d),u===this.h&&(this._=d),this.i+=1}clear(){this.i=0,this.p=this._=this.h.L=this.h.B=this.h}begin(){return new r(this.p,this.h,this)}end(){return new r(this.h,this.h,this)}rBegin(){return new r(this._,this.h,this,1)}rEnd(){return new r(this.h,this.h,this,1)}front(){return this.p.l}back(){return this._.l}getElementByPos(t){if(t<0||t>this.i-1)throw new RangeError;let o=this.p;for(;t--;)o=o.B;return o.l}eraseElementByPos(t){if(t<0||t>this.i-1)throw new RangeError;let o=this.p;for(;t--;)o=o.B;return this.V(o),this.i}eraseElementByValue(t){let o=this.p;for(;o!==this.h;)o.l===t&&this.V(o),o=o.B;return this.i}eraseElementByIterator(t){let o=t.o;return o===this.h&&(0,a.throwIteratorAccessError)(),t=t.next(),this.V(o),t}pushBack(t){return this.G(t,this._),this.i}popBack(){if(this.i===0)return;let t=this._.l;return this.V(this._),t}pushFront(t){return this.G(t,this.h),this.i}popFront(){if(this.i===0)return;let t=this.p.l;return this.V(this.p),t}setElementByPos(t,o){if(t<0||t>this.i-1)throw new RangeError;let u=this.p;for(;t--;)u=u.B;u.l=o}insert(t,o,u=1){if(t<0||t>this.i)throw new RangeError;if(u<=0)return this.i;if(t===0)for(;u--;)this.pushFront(o);else if(t===this.i)for(;u--;)this.pushBack(o);else{let d=this.p;for(let m=1;m<t;++m)d=d.B;let p=d.B;for(this.i+=u;u--;)d.B={l:o,L:d},d.B.L=d,d=d.B;d.B=p,p.L=d}return this.i}find(t){let o=this.p;for(;o!==this.h;){if(o.l===t)return new r(o,this.h,this);o=o.B}return this.end()}reverse(){if(this.i<=1)return;let t=this.p,o=this._,u=0;for(;u<<1<this.i;){let d=t.l;t.l=o.l,o.l=d,t=t.B,o=o.L,u+=1}}unique(){if(this.i<=1)return this.i;let t=this.p;for(;t!==this.h;){let o=t;for(;o.B!==this.h&&o.l===o.B.l;)o=o.B,this.i-=1;t.B=o.B,t.B.L=t,t=t.B}return this.i}sort(t){if(this.i<=1)return;let o=[];this.forEach(function(d){o.push(d)}),o.sort(t);let u=this.p;o.forEach(function(d){u.l=d,u=u.B})}merge(t){let o=this;if(this.i===0)t.forEach(function(u){o.pushBack(u)});else{let u=this.p;t.forEach(function(d){for(;u!==o.h&&u.l<=d;)u=u.B;o.G(d,u.L)})}return this.i}forEach(t){let o=this.p,u=0;for(;o!==this.h;)t(o.l,u++,this),o=o.B}[Symbol.iterator](){return(function*(){if(this.i===0)return;let t=this.p;for(;t!==this.h;)yield t.l,t=t.B}).bind(this)()}},i=e;s.default=i}),el=be(s=>{ue(),ce(),he(),Object.defineProperty(s,"t",{value:!0}),s.default=void 0;var f=a(xn()),n=es();function a(i){return i&&i.t?i:{default:i}}var c=class is extends n.RandomIterator{constructor(t,o,u){super(t,u),this.container=o}copy(){return new is(this.o,this.container,this.iteratorType)}},r=class extends f.default{constructor(i=[],t=4096){super(),this.j=0,this.D=0,this.R=0,this.N=0,this.P=0,this.A=[];let o=(()=>{if(typeof i.length=="number")return i.length;if(typeof i.size=="number")return i.size;if(typeof i.size=="function")return i.size();throw new TypeError("Cannot get the length or size of the container")})();this.F=t,this.P=Math.max(Math.ceil(o/this.F),1);for(let p=0;p<this.P;++p)this.A.push(new Array(this.F));let u=Math.ceil(o/this.F);this.j=this.R=(this.P>>1)-(u>>1),this.D=this.N=this.F-o%this.F>>1;let d=this;i.forEach(function(p){d.pushBack(p)})}T(){let i=[],t=Math.max(this.P>>1,1);for(let o=0;o<t;++o)i[o]=new Array(this.F);for(let o=this.j;o<this.P;++o)i[i.length]=this.A[o];for(let o=0;o<this.R;++o)i[i.length]=this.A[o];i[i.length]=[...this.A[this.R]],this.j=t,this.R=i.length-1;for(let o=0;o<t;++o)i[i.length]=new Array(this.F);this.A=i,this.P=i.length}O(i){let t=this.D+i+1,o=t%this.F,u=o-1,d=this.j+(t-o)/this.F;return o===0&&(d-=1),d%=this.P,u<0&&(u+=this.F),{curNodeBucketIndex:d,curNodePointerIndex:u}}clear(){this.A=[new Array(this.F)],this.P=1,this.j=this.R=this.i=0,this.D=this.N=this.F>>1}begin(){return new c(0,this)}end(){return new c(this.i,this)}rBegin(){return new c(this.i-1,this,1)}rEnd(){return new c(-1,this,1)}front(){if(this.i!==0)return this.A[this.j][this.D]}back(){if(this.i!==0)return this.A[this.R][this.N]}pushBack(i){return this.i&&(this.N<this.F-1?this.N+=1:this.R<this.P-1?(this.R+=1,this.N=0):(this.R=0,this.N=0),this.R===this.j&&this.N===this.D&&this.T()),this.i+=1,this.A[this.R][this.N]=i,this.i}popBack(){if(this.i===0)return;let i=this.A[this.R][this.N];return this.i!==1&&(this.N>0?this.N-=1:this.R>0?(this.R-=1,this.N=this.F-1):(this.R=this.P-1,this.N=this.F-1)),this.i-=1,i}pushFront(i){return this.i&&(this.D>0?this.D-=1:this.j>0?(this.j-=1,this.D=this.F-1):(this.j=this.P-1,this.D=this.F-1),this.j===this.R&&this.D===this.N&&this.T()),this.i+=1,this.A[this.j][this.D]=i,this.i}popFront(){if(this.i===0)return;let i=this.A[this.j][this.D];return this.i!==1&&(this.D<this.F-1?this.D+=1:this.j<this.P-1?(this.j+=1,this.D=0):(this.j=0,this.D=0)),this.i-=1,i}getElementByPos(i){if(i<0||i>this.i-1)throw new RangeError;let{curNodeBucketIndex:t,curNodePointerIndex:o}=this.O(i);return this.A[t][o]}setElementByPos(i,t){if(i<0||i>this.i-1)throw new RangeError;let{curNodeBucketIndex:o,curNodePointerIndex:u}=this.O(i);this.A[o][u]=t}insert(i,t,o=1){if(i<0||i>this.i)throw new RangeError;if(i===0)for(;o--;)this.pushFront(t);else if(i===this.i)for(;o--;)this.pushBack(t);else{let u=[];for(let d=i;d<this.i;++d)u.push(this.getElementByPos(d));this.cut(i-1);for(let d=0;d<o;++d)this.pushBack(t);for(let d=0;d<u.length;++d)this.pushBack(u[d])}return this.i}cut(i){if(i<0)return this.clear(),0;let{curNodeBucketIndex:t,curNodePointerIndex:o}=this.O(i);return this.R=t,this.N=o,this.i=i+1,this.i}eraseElementByPos(i){if(i<0||i>this.i-1)throw new RangeError;if(i===0)this.popFront();else if(i===this.i-1)this.popBack();else{let t=[];for(let u=i+1;u<this.i;++u)t.push(this.getElementByPos(u));this.cut(i),this.popBack();let o=this;t.forEach(function(u){o.pushBack(u)})}return this.i}eraseElementByValue(i){if(this.i===0)return 0;let t=[];for(let u=0;u<this.i;++u){let d=this.getElementByPos(u);d!==i&&t.push(d)}let o=t.length;for(let u=0;u<o;++u)this.setElementByPos(u,t[u]);return this.cut(o-1)}eraseElementByIterator(i){let t=i.o;return this.eraseElementByPos(t),i=i.next(),i}find(i){for(let t=0;t<this.i;++t)if(this.getElementByPos(t)===i)return new c(t,this);return this.end()}reverse(){let i=0,t=this.i-1;for(;i<t;){let o=this.getElementByPos(i);this.setElementByPos(i,this.getElementByPos(t)),this.setElementByPos(t,o),i+=1,t-=1}}unique(){if(this.i<=1)return this.i;let i=1,t=this.getElementByPos(0);for(let o=1;o<this.i;++o){let u=this.getElementByPos(o);u!==t&&(t=u,this.setElementByPos(i++,u))}for(;this.i>i;)this.popBack();return this.i}sort(i){let t=[];for(let o=0;o<this.i;++o)t.push(this.getElementByPos(o));t.sort(i);for(let o=0;o<this.i;++o)this.setElementByPos(o,t[o])}shrinkToFit(){if(this.i===0)return;let i=[];this.forEach(function(t){i.push(t)}),this.P=Math.max(Math.ceil(this.i/this.F),1),this.i=this.j=this.R=this.D=this.N=0,this.A=[];for(let t=0;t<this.P;++t)this.A.push(new Array(this.F));for(let t=0;t<i.length;++t)this.pushBack(i[t])}forEach(i){for(let t=0;t<this.i;++t)i(this.getElementByPos(t),t,this)}[Symbol.iterator](){return(function*(){for(let i=0;i<this.i;++i)yield this.getElementByPos(i)}).bind(this)()}},e=r;s.default=e}),tl=be(s=>{ue(),ce(),he(),Object.defineProperty(s,"t",{value:!0}),s.TreeNodeEnableIndex=s.TreeNode=void 0;var f=class{constructor(a,c){this.ee=1,this.u=void 0,this.l=void 0,this.U=void 0,this.W=void 0,this.tt=void 0,this.u=a,this.l=c}L(){let a=this;if(a.ee===1&&a.tt.tt===a)a=a.W;else if(a.U)for(a=a.U;a.W;)a=a.W;else{let c=a.tt;for(;c.U===a;)a=c,c=a.tt;a=c}return a}B(){let a=this;if(a.W){for(a=a.W;a.U;)a=a.U;return a}else{let c=a.tt;for(;c.W===a;)a=c,c=a.tt;return a.W!==c?c:a}}te(){let a=this.tt,c=this.W,r=c.U;return a.tt===this?a.tt=c:a.U===this?a.U=c:a.W=c,c.tt=a,c.U=this,this.tt=c,this.W=r,r&&(r.tt=this),c}se(){let a=this.tt,c=this.U,r=c.W;return a.tt===this?a.tt=c:a.U===this?a.U=c:a.W=c,c.tt=a,c.W=this,this.tt=c,this.U=r,r&&(r.tt=this),c}};s.TreeNode=f;var n=class extends f{constructor(){super(...arguments),this.rt=1}te(){let a=super.te();return this.ie(),a.ie(),a}se(){let a=super.se();return this.ie(),a.ie(),a}ie(){this.rt=1,this.U&&(this.rt+=this.U.rt),this.W&&(this.rt+=this.W.rt)}};s.TreeNodeEnableIndex=n}),ns=be(s=>{ue(),ce(),he(),Object.defineProperty(s,"t",{value:!0}),s.default=void 0;var f=tl(),n=Ot(),a=Rt(),c=class extends n.Container{constructor(e=function(t,o){return t<o?-1:t>o?1:0},i=!1){super(),this.Y=void 0,this.v=e,i?(this.re=f.TreeNodeEnableIndex,this.M=function(t,o,u){let d=this.ne(t,o,u);if(d){let p=d.tt;for(;p!==this.h;)p.rt+=1,p=p.tt;let m=this.he(d);if(m){let{parentNode:b,grandParent:_,curNode:E}=m;b.ie(),_.ie(),E.ie()}}return this.i},this.V=function(t){let o=this.fe(t);for(;o!==this.h;)o.rt-=1,o=o.tt}):(this.re=f.TreeNode,this.M=function(t,o,u){let d=this.ne(t,o,u);return d&&this.he(d),this.i},this.V=this.fe),this.h=new this.re}X(e,i){let t=this.h;for(;e;){let o=this.v(e.u,i);if(o<0)e=e.W;else if(o>0)t=e,e=e.U;else return e}return t}Z(e,i){let t=this.h;for(;e;)this.v(e.u,i)<=0?e=e.W:(t=e,e=e.U);return t}$(e,i){let t=this.h;for(;e;){let o=this.v(e.u,i);if(o<0)t=e,e=e.W;else if(o>0)e=e.U;else return e}return t}rr(e,i){let t=this.h;for(;e;)this.v(e.u,i)<0?(t=e,e=e.W):e=e.U;return t}ue(e){for(;;){let i=e.tt;if(i===this.h)return;if(e.ee===1){e.ee=0;return}if(e===i.U){let t=i.W;if(t.ee===1)t.ee=0,i.ee=1,i===this.Y?this.Y=i.te():i.te();else if(t.W&&t.W.ee===1){t.ee=i.ee,i.ee=0,t.W.ee=0,i===this.Y?this.Y=i.te():i.te();return}else t.U&&t.U.ee===1?(t.ee=1,t.U.ee=0,t.se()):(t.ee=1,e=i)}else{let t=i.U;if(t.ee===1)t.ee=0,i.ee=1,i===this.Y?this.Y=i.se():i.se();else if(t.U&&t.U.ee===1){t.ee=i.ee,i.ee=0,t.U.ee=0,i===this.Y?this.Y=i.se():i.se();return}else t.W&&t.W.ee===1?(t.ee=1,t.W.ee=0,t.te()):(t.ee=1,e=i)}}}fe(e){if(this.i===1)return this.clear(),this.h;let i=e;for(;i.U||i.W;){if(i.W)for(i=i.W;i.U;)i=i.U;else i=i.U;[e.u,i.u]=[i.u,e.u],[e.l,i.l]=[i.l,e.l],e=i}this.h.U===i?this.h.U=i.tt:this.h.W===i&&(this.h.W=i.tt),this.ue(i);let t=i.tt;return i===t.U?t.U=void 0:t.W=void 0,this.i-=1,this.Y.ee=0,t}oe(e,i){return e===void 0?!1:this.oe(e.U,i)||i(e)?!0:this.oe(e.W,i)}he(e){for(;;){let i=e.tt;if(i.ee===0)return;let t=i.tt;if(i===t.U){let o=t.W;if(o&&o.ee===1){if(o.ee=i.ee=0,t===this.Y)return;t.ee=1,e=t;continue}else if(e===i.W){if(e.ee=0,e.U&&(e.U.tt=i),e.W&&(e.W.tt=t),i.W=e.U,t.U=e.W,e.U=i,e.W=t,t===this.Y)this.Y=e,this.h.tt=e;else{let u=t.tt;u.U===t?u.U=e:u.W=e}return e.tt=t.tt,i.tt=e,t.tt=e,t.ee=1,{parentNode:i,grandParent:t,curNode:e}}else i.ee=0,t===this.Y?this.Y=t.se():t.se(),t.ee=1}else{let o=t.U;if(o&&o.ee===1){if(o.ee=i.ee=0,t===this.Y)return;t.ee=1,e=t;continue}else if(e===i.U){if(e.ee=0,e.U&&(e.U.tt=t),e.W&&(e.W.tt=i),t.W=e.U,i.U=e.W,e.U=t,e.W=i,t===this.Y)this.Y=e,this.h.tt=e;else{let u=t.tt;u.U===t?u.U=e:u.W=e}return e.tt=t.tt,i.tt=e,t.tt=e,t.ee=1,{parentNode:i,grandParent:t,curNode:e}}else i.ee=0,t===this.Y?this.Y=t.te():t.te(),t.ee=1}return}}ne(e,i,t){if(this.Y===void 0){this.i+=1,this.Y=new this.re(e,i),this.Y.ee=0,this.Y.tt=this.h,this.h.tt=this.Y,this.h.U=this.Y,this.h.W=this.Y;return}let o,u=this.h.U,d=this.v(u.u,e);if(d===0){u.l=i;return}else if(d>0)u.U=new this.re(e,i),u.U.tt=u,o=u.U,this.h.U=o;else{let p=this.h.W,m=this.v(p.u,e);if(m===0){p.l=i;return}else if(m<0)p.W=new this.re(e,i),p.W.tt=p,o=p.W,this.h.W=o;else{if(t!==void 0){let b=t.o;if(b!==this.h){let _=this.v(b.u,e);if(_===0){b.l=i;return}else if(_>0){let E=b.L(),I=this.v(E.u,e);if(I===0){E.l=i;return}else I<0&&(o=new this.re(e,i),E.W===void 0?(E.W=o,o.tt=E):(b.U=o,o.tt=b))}}}if(o===void 0)for(o=this.Y;;){let b=this.v(o.u,e);if(b>0){if(o.U===void 0){o.U=new this.re(e,i),o.U.tt=o,o=o.U;break}o=o.U}else if(b<0){if(o.W===void 0){o.W=new this.re(e,i),o.W.tt=o,o=o.W;break}o=o.W}else{o.l=i;return}}}}return this.i+=1,o}I(e,i){for(;e;){let t=this.v(e.u,i);if(t<0)e=e.W;else if(t>0)e=e.U;else return e}return e||this.h}clear(){this.i=0,this.Y=void 0,this.h.tt=void 0,this.h.U=this.h.W=void 0}updateKeyByIterator(e,i){let t=e.o;if(t===this.h&&(0,a.throwIteratorAccessError)(),this.i===1)return t.u=i,!0;if(t===this.h.U)return this.v(t.B().u,i)>0?(t.u=i,!0):!1;if(t===this.h.W)return this.v(t.L().u,i)<0?(t.u=i,!0):!1;let o=t.L().u;if(this.v(o,i)>=0)return!1;let u=t.B().u;return this.v(u,i)<=0?!1:(t.u=i,!0)}eraseElementByPos(e){if(e<0||e>this.i-1)throw new RangeError;let i=0,t=this;return this.oe(this.Y,function(o){return e===i?(t.V(o),!0):(i+=1,!1)}),this.i}eraseElementByKey(e){if(this.i===0)return!1;let i=this.I(this.Y,e);return i===this.h?!1:(this.V(i),!0)}eraseElementByIterator(e){let i=e.o;i===this.h&&(0,a.throwIteratorAccessError)();let t=i.W===void 0;return e.iteratorType===0?t&&e.next():(!t||i.U===void 0)&&e.next(),this.V(i),e}forEach(e){let i=0;for(let t of this)e(t,i++,this)}getElementByPos(e){if(e<0||e>this.i-1)throw new RangeError;let i,t=0;for(let o of this){if(t===e){i=o;break}t+=1}return i}getHeight(){if(this.i===0)return 0;let e=function(i){return i?Math.max(e(i.U),e(i.W))+1:0};return e(this.Y)}},r=c;s.default=r}),os=be(s=>{ue(),ce(),he(),Object.defineProperty(s,"t",{value:!0}),s.default=void 0;var f=Ot(),n=Rt(),a=class extends f.ContainerIterator{constructor(r,e,i){super(i),this.o=r,this.h=e,this.iteratorType===0?(this.pre=function(){return this.o===this.h.U&&(0,n.throwIteratorAccessError)(),this.o=this.o.L(),this},this.next=function(){return this.o===this.h&&(0,n.throwIteratorAccessError)(),this.o=this.o.B(),this}):(this.pre=function(){return this.o===this.h.W&&(0,n.throwIteratorAccessError)(),this.o=this.o.B(),this},this.next=function(){return this.o===this.h&&(0,n.throwIteratorAccessError)(),this.o=this.o.L(),this})}get index(){let r=this.o,e=this.h.tt;if(r===this.h)return e?e.rt-1:0;let i=0;for(r.U&&(i+=r.U.rt);r!==e;){let t=r.tt;r===t.W&&(i+=1,t.U&&(i+=t.U.rt)),r=t}return i}},c=a;s.default=c}),rl=be(s=>{ue(),ce(),he(),Object.defineProperty(s,"t",{value:!0}),s.default=void 0;var f=c(ns()),n=c(os()),a=Rt();function c(t){return t&&t.t?t:{default:t}}var r=class ss extends n.default{constructor(o,u,d,p){super(o,u,p),this.container=d}get pointer(){return this.o===this.h&&(0,a.throwIteratorAccessError)(),this.o.u}copy(){return new ss(this.o,this.h,this.container,this.iteratorType)}},e=class extends f.default{constructor(t=[],o,u){super(o,u);let d=this;t.forEach(function(p){d.insert(p)})}*K(t){t!==void 0&&(yield*this.K(t.U),yield t.u,yield*this.K(t.W))}begin(){return new r(this.h.U||this.h,this.h,this)}end(){return new r(this.h,this.h,this)}rBegin(){return new r(this.h.W||this.h,this.h,this,1)}rEnd(){return new r(this.h,this.h,this,1)}front(){return this.h.U?this.h.U.u:void 0}back(){return this.h.W?this.h.W.u:void 0}insert(t,o){return this.M(t,void 0,o)}find(t){let o=this.I(this.Y,t);return new r(o,this.h,this)}lowerBound(t){let o=this.X(this.Y,t);return new r(o,this.h,this)}upperBound(t){let o=this.Z(this.Y,t);return new r(o,this.h,this)}reverseLowerBound(t){let o=this.$(this.Y,t);return new r(o,this.h,this)}reverseUpperBound(t){let o=this.rr(this.Y,t);return new r(o,this.h,this)}union(t){let o=this;return t.forEach(function(u){o.insert(u)}),this.i}[Symbol.iterator](){return this.K(this.Y)}},i=e;s.default=i}),il=be(s=>{ue(),ce(),he(),Object.defineProperty(s,"t",{value:!0}),s.default=void 0;var f=c(ns()),n=c(os()),a=Rt();function c(t){return t&&t.t?t:{default:t}}var r=class as extends n.default{constructor(o,u,d,p){super(o,u,p),this.container=d}get pointer(){this.o===this.h&&(0,a.throwIteratorAccessError)();let o=this;return new Proxy([],{get(u,d){if(d==="0")return o.o.u;if(d==="1")return o.o.l},set(u,d,p){if(d!=="1")throw new TypeError("props must be 1");return o.o.l=p,!0}})}copy(){return new as(this.o,this.h,this.container,this.iteratorType)}},e=class extends f.default{constructor(t=[],o,u){super(o,u);let d=this;t.forEach(function(p){d.setElement(p[0],p[1])})}*K(t){t!==void 0&&(yield*this.K(t.U),yield[t.u,t.l],yield*this.K(t.W))}begin(){return new r(this.h.U||this.h,this.h,this)}end(){return new r(this.h,this.h,this)}rBegin(){return new r(this.h.W||this.h,this.h,this,1)}rEnd(){return new r(this.h,this.h,this,1)}front(){if(this.i===0)return;let t=this.h.U;return[t.u,t.l]}back(){if(this.i===0)return;let t=this.h.W;return[t.u,t.l]}lowerBound(t){let o=this.X(this.Y,t);return new r(o,this.h,this)}upperBound(t){let o=this.Z(this.Y,t);return new r(o,this.h,this)}reverseLowerBound(t){let o=this.$(this.Y,t);return new r(o,this.h,this)}reverseUpperBound(t){let o=this.rr(this.Y,t);return new r(o,this.h,this)}setElement(t,o,u){return this.M(t,o,u)}find(t){let o=this.I(this.Y,t);return new r(o,this.h,this)}getElementByKey(t){return this.I(this.Y,t).l}union(t){let o=this;return t.forEach(function(u){o.setElement(u[0],u[1])}),this.i}[Symbol.iterator](){return this.K(this.Y)}},i=e;s.default=i}),ls=be(s=>{ue(),ce(),he(),Object.defineProperty(s,"t",{value:!0}),s.default=f;function f(n){let a=typeof n;return a==="object"&&n!==null||a==="function"}}),us=be(s=>{ue(),ce(),he(),Object.defineProperty(s,"t",{value:!0}),s.HashContainerIterator=s.HashContainer=void 0;var f=Ot(),n=c(ls()),a=Rt();function c(i){return i&&i.t?i:{default:i}}var r=class extends f.ContainerIterator{constructor(i,t,o){super(o),this.o=i,this.h=t,this.iteratorType===0?(this.pre=function(){return this.o.L===this.h&&(0,a.throwIteratorAccessError)(),this.o=this.o.L,this},this.next=function(){return this.o===this.h&&(0,a.throwIteratorAccessError)(),this.o=this.o.B,this}):(this.pre=function(){return this.o.B===this.h&&(0,a.throwIteratorAccessError)(),this.o=this.o.B,this},this.next=function(){return this.o===this.h&&(0,a.throwIteratorAccessError)(),this.o=this.o.L,this})}};s.HashContainerIterator=r;var e=class extends f.Container{constructor(){super(),this.H=[],this.g={},this.HASH_TAG=Symbol("@@HASH_TAG"),Object.setPrototypeOf(this.g,null),this.h={},this.h.L=this.h.B=this.p=this._=this.h}V(i){let{L:t,B:o}=i;t.B=o,o.L=t,i===this.p&&(this.p=o),i===this._&&(this._=t),this.i-=1}M(i,t,o){o===void 0&&(o=(0,n.default)(i));let u;if(o){let d=i[this.HASH_TAG];if(d!==void 0)return this.H[d].l=t,this.i;Object.defineProperty(i,this.HASH_TAG,{value:this.H.length,configurable:!0}),u={u:i,l:t,L:this._,B:this.h},this.H.push(u)}else{let d=this.g[i];if(d)return d.l=t,this.i;u={u:i,l:t,L:this._,B:this.h},this.g[i]=u}return this.i===0?(this.p=u,this.h.B=u):this._.B=u,this._=u,this.h.L=u,++this.i}I(i,t){if(t===void 0&&(t=(0,n.default)(i)),t){let o=i[this.HASH_TAG];return o===void 0?this.h:this.H[o]}else return this.g[i]||this.h}clear(){let i=this.HASH_TAG;this.H.forEach(function(t){delete t.u[i]}),this.H=[],this.g={},Object.setPrototypeOf(this.g,null),this.i=0,this.p=this._=this.h.L=this.h.B=this.h}eraseElementByKey(i,t){let o;if(t===void 0&&(t=(0,n.default)(i)),t){let u=i[this.HASH_TAG];if(u===void 0)return!1;delete i[this.HASH_TAG],o=this.H[u],delete this.H[u]}else{if(o=this.g[i],o===void 0)return!1;delete this.g[i]}return this.V(o),!0}eraseElementByIterator(i){let t=i.o;return t===this.h&&(0,a.throwIteratorAccessError)(),this.V(t),i.next()}eraseElementByPos(i){if(i<0||i>this.i-1)throw new RangeError;let t=this.p;for(;i--;)t=t.B;return this.V(t),this.i}};s.HashContainer=e}),nl=be(s=>{ue(),ce(),he(),Object.defineProperty(s,"t",{value:!0}),s.default=void 0;var f=us(),n=Rt(),a=class hs extends f.HashContainerIterator{constructor(i,t,o,u){super(i,t,u),this.container=o}get pointer(){return this.o===this.h&&(0,n.throwIteratorAccessError)(),this.o.u}copy(){return new hs(this.o,this.h,this.container,this.iteratorType)}},c=class extends f.HashContainer{constructor(e=[]){super();let i=this;e.forEach(function(t){i.insert(t)})}begin(){return new a(this.p,this.h,this)}end(){return new a(this.h,this.h,this)}rBegin(){return new a(this._,this.h,this,1)}rEnd(){return new a(this.h,this.h,this,1)}front(){return this.p.u}back(){return this._.u}insert(e,i){return this.M(e,void 0,i)}getElementByPos(e){if(e<0||e>this.i-1)throw new RangeError;let i=this.p;for(;e--;)i=i.B;return i.u}find(e,i){let t=this.I(e,i);return new a(t,this.h,this)}forEach(e){let i=0,t=this.p;for(;t!==this.h;)e(t.u,i++,this),t=t.B}[Symbol.iterator](){return(function*(){let e=this.p;for(;e!==this.h;)yield e.u,e=e.B}).bind(this)()}},r=c;s.default=r}),ol=be(s=>{ue(),ce(),he(),Object.defineProperty(s,"t",{value:!0}),s.default=void 0;var f=us(),n=c(ls()),a=Rt();function c(t){return t&&t.t?t:{default:t}}var r=class cs extends f.HashContainerIterator{constructor(o,u,d,p){super(o,u,p),this.container=d}get pointer(){this.o===this.h&&(0,a.throwIteratorAccessError)();let o=this;return new Proxy([],{get(u,d){if(d==="0")return o.o.u;if(d==="1")return o.o.l},set(u,d,p){if(d!=="1")throw new TypeError("props must be 1");return o.o.l=p,!0}})}copy(){return new cs(this.o,this.h,this.container,this.iteratorType)}},e=class extends f.HashContainer{constructor(t=[]){super();let o=this;t.forEach(function(u){o.setElement(u[0],u[1])})}begin(){return new r(this.p,this.h,this)}end(){return new r(this.h,this.h,this)}rBegin(){return new r(this._,this.h,this,1)}rEnd(){return new r(this.h,this.h,this,1)}front(){if(this.i!==0)return[this.p.u,this.p.l]}back(){if(this.i!==0)return[this._.u,this._.l]}setElement(t,o,u){return this.M(t,o,u)}getElementByKey(t,o){if(o===void 0&&(o=(0,n.default)(t)),o){let d=t[this.HASH_TAG];return d!==void 0?this.H[d].l:void 0}let u=this.g[t];return u?u.l:void 0}getElementByPos(t){if(t<0||t>this.i-1)throw new RangeError;let o=this.p;for(;t--;)o=o.B;return[o.u,o.l]}find(t,o){let u=this.I(t,o);return new r(u,this.h,this)}forEach(t){let o=0,u=this.p;for(;u!==this.h;)t([u.u,u.l],o++,this),u=u.B}[Symbol.iterator](){return(function*(){let t=this.p;for(;t!==this.h;)yield[t.u,t.l],t=t.B}).bind(this)()}},i=e;s.default=i}),sl=be(s=>{ue(),ce(),he(),Object.defineProperty(s,"t",{value:!0}),Object.defineProperty(s,"Deque",{enumerable:!0,get:function(){return e.default}}),Object.defineProperty(s,"HashMap",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(s,"HashSet",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(s,"LinkList",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(s,"OrderedMap",{enumerable:!0,get:function(){return t.default}}),Object.defineProperty(s,"OrderedSet",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(s,"PriorityQueue",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(s,"Queue",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(s,"Stack",{enumerable:!0,get:function(){return f.default}}),Object.defineProperty(s,"Vector",{enumerable:!0,get:function(){return c.default}});var f=d(Ka()),n=d(Ya()),a=d(Ja()),c=d(Xa()),r=d(Za()),e=d(el()),i=d(rl()),t=d(il()),o=d(nl()),u=d(ol());function d(p){return p&&p.t?p:{default:p}}}),al=be((s,f)=>{ue(),ce(),he();var n=sl().OrderedSet,a=kt()("number-allocator:trace"),c=kt()("number-allocator:error");function r(i,t){this.low=i,this.high=t}r.prototype.equals=function(i){return this.low===i.low&&this.high===i.high},r.prototype.compare=function(i){return this.low<i.low&&this.high<i.low?-1:i.low<this.low&&i.high<this.low?1:0};function e(i,t){if(!(this instanceof e))return new e(i,t);this.min=i,this.max=t,this.ss=new n([],(o,u)=>o.compare(u)),a("Create"),this.clear()}e.prototype.firstVacant=function(){return this.ss.size()===0?null:this.ss.front().low},e.prototype.alloc=function(){if(this.ss.size()===0)return a("alloc():empty"),null;let i=this.ss.begin(),t=i.pointer.low,o=i.pointer.high,u=t;return u+1<=o?this.ss.updateKeyByIterator(i,new r(t+1,o)):this.ss.eraseElementByPos(0),a("alloc():"+u),u},e.prototype.use=function(i){let t=new r(i,i),o=this.ss.lowerBound(t);if(!o.equals(this.ss.end())){let u=o.pointer.low,d=o.pointer.high;return o.pointer.equals(t)?(this.ss.eraseElementByIterator(o),a("use():"+i),!0):u>i?!1:u===i?(this.ss.updateKeyByIterator(o,new r(u+1,d)),a("use():"+i),!0):d===i?(this.ss.updateKeyByIterator(o,new r(u,d-1)),a("use():"+i),!0):(this.ss.updateKeyByIterator(o,new r(i+1,d)),this.ss.insert(new r(u,i-1)),a("use():"+i),!0)}return a("use():failed"),!1},e.prototype.free=function(i){if(i<this.min||i>this.max){c("free():"+i+" is out of range");return}let t=new r(i,i),o=this.ss.upperBound(t);if(o.equals(this.ss.end())){if(o.equals(this.ss.begin())){this.ss.insert(t);return}o.pre();let u=o.pointer.high;o.pointer.high+1===i?this.ss.updateKeyByIterator(o,new r(u,i)):this.ss.insert(t)}else if(o.equals(this.ss.begin()))if(i+1===o.pointer.low){let u=o.pointer.high;this.ss.updateKeyByIterator(o,new r(i,u))}else this.ss.insert(t);else{let u=o.pointer.low,d=o.pointer.high;o.pre();let p=o.pointer.low;o.pointer.high+1===i?i+1===u?(this.ss.eraseElementByIterator(o),this.ss.updateKeyByIterator(o,new r(p,d))):this.ss.updateKeyByIterator(o,new r(p,i)):i+1===u?(this.ss.eraseElementByIterator(o.next()),this.ss.insert(new r(i,d))):this.ss.insert(t)}a("free():"+i)},e.prototype.clear=function(){a("clear()"),this.ss.clear(),this.ss.insert(new r(this.min,this.max))},e.prototype.intervalCount=function(){return this.ss.size()},e.prototype.dump=function(){console.log("length:"+this.ss.size());for(let i of this.ss)console.log(i)},f.exports=e}),fs=be((s,f)=>{ue(),ce(),he();var n=al();f.exports.NumberAllocator=n}),ll=be(s=>{ue(),ce(),he(),Object.defineProperty(s,"__esModule",{value:!0});var f=Qa(),n=fs(),a=class{constructor(c){c>0&&(this.aliasToTopic=new f.LRUCache({max:c}),this.topicToAlias={},this.numberAllocator=new n.NumberAllocator(1,c),this.max=c,this.length=0)}put(c,r){if(r===0||r>this.max)return!1;let e=this.aliasToTopic.get(r);return e&&delete this.topicToAlias[e],this.aliasToTopic.set(r,c),this.topicToAlias[c]=r,this.numberAllocator.use(r),this.length=this.aliasToTopic.size,!0}getTopicByAlias(c){return this.aliasToTopic.get(c)}getAliasByTopic(c){let r=this.topicToAlias[c];return typeof r<"u"&&this.aliasToTopic.get(r),r}clear(){this.aliasToTopic.clear(),this.topicToAlias={},this.numberAllocator.clear(),this.length=0}getLruAlias(){return this.numberAllocator.firstVacant()||[...this.aliasToTopic.keys()][this.aliasToTopic.size-1]}};s.default=a}),ul=be(s=>{ue(),ce(),he();var f=s&&s.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(s,"__esModule",{value:!0});var n=$r(),a=f(ll()),c=sr(),r=(e,i)=>{e.log("_handleConnack");let{options:t}=e,o=t.protocolVersion===5?i.reasonCode:i.returnCode;if(clearTimeout(e.connackTimer),delete e.topicAliasSend,i.properties){if(i.properties.topicAliasMaximum){if(i.properties.topicAliasMaximum>65535){e.emit("error",new Error("topicAliasMaximum from broker is out of range"));return}i.properties.topicAliasMaximum>0&&(e.topicAliasSend=new a.default(i.properties.topicAliasMaximum))}i.properties.serverKeepAlive&&t.keepalive&&(t.keepalive=i.properties.serverKeepAlive),i.properties.maximumPacketSize&&(t.properties||(t.properties={}),t.properties.maximumPacketSize=i.properties.maximumPacketSize)}if(o===0)e.reconnecting=!1,e._onConnect(i);else if(o>0){let u=new c.ErrorWithReasonCode(`Connection refused: ${n.ReasonCodes[o]}`,o);e.emit("error",u),e.options.reconnectOnConnackError&&e._cleanUp(!0)}};s.default=r}),hl=be(s=>{ue(),ce(),he(),Object.defineProperty(s,"__esModule",{value:!0});var f=(n,a,c)=>{n.log("handling pubrel packet");let r=typeof c<"u"?c:n.noop,{messageId:e}=a,i={cmd:"pubcomp",messageId:e};n.incomingStore.get(a,(t,o)=>{t?n._sendPacket(i,r):(n.emit("message",o.topic,o.payload,o),n.handleMessage(o,u=>{if(u)return r(u);n.incomingStore.del(o,n.noop),n._sendPacket(i,r)}))})};s.default=f}),cl=be(s=>{ue(),ce(),he();var f=s&&s.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(s,"__esModule",{value:!0});var n=f(Va()),a=f(Ga()),c=f(ul()),r=f($r()),e=f(hl()),i=(t,o,u)=>{let{options:d}=t;if(d.protocolVersion===5&&d.properties&&d.properties.maximumPacketSize&&d.properties.maximumPacketSize<o.length)return t.emit("error",new Error(`exceeding packets size ${o.cmd}`)),t.end({reasonCode:149,properties:{reasonString:"Maximum packet size was exceeded"}}),t;switch(t.log("_handlePacket :: emitting packetreceive"),t.emit("packetreceive",o),o.cmd){case"publish":(0,n.default)(t,o,u);break;case"puback":case"pubrec":case"pubcomp":case"suback":case"unsuback":t.reschedulePing(),(0,r.default)(t,o),u();break;case"pubrel":t.reschedulePing(),(0,e.default)(t,o,u);break;case"connack":(0,c.default)(t,o),u();break;case"auth":t.reschedulePing(),(0,a.default)(t,o),u();break;case"pingresp":t.log("_handlePacket :: received pingresp"),t.reschedulePing(!0),u();break;case"disconnect":t.emit("disconnect",o),u();break;default:t.log("_handlePacket :: unknown command"),u();break}};s.default=i}),fl=be(s=>{ue(),ce(),he();var f=s&&s.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(s,"__esModule",{value:!0}),s.TypedEventEmitter=void 0;var n=f((Xt(),Ne(jt))),a=sr(),c=class{};s.TypedEventEmitter=c,(0,a.applyMixin)(c,n.default)}),qr=be(s=>{ue(),ce(),he(),Object.defineProperty(s,"__esModule",{value:!0}),s.isReactNativeBrowser=s.isWebWorker=void 0;var f=()=>{var r;return typeof window<"u"?typeof navigator<"u"&&((r=navigator.userAgent)===null||r===void 0?void 0:r.toLowerCase().indexOf(" electron/"))>-1&&Le!=null&&Le.versions?!Object.prototype.hasOwnProperty.call(Le.versions,"electron"):typeof window.document<"u":!1},n=()=>{var r,e;return!!(typeof self=="object"&&!((e=(r=self==null?void 0:self.constructor)===null||r===void 0?void 0:r.name)===null||e===void 0)&&e.includes("WorkerGlobalScope"))},a=()=>typeof navigator<"u"&&navigator.product==="ReactNative",c=f()||n()||a();s.isWebWorker=n(),s.isReactNativeBrowser=a(),s.default=c}),dl=be((s,f)=>{ue(),ce(),he(),function(n,a){typeof s=="object"&&typeof f<"u"?a(s):typeof define=="function"&&define.amd?define(["exports"],a):(n=typeof globalThis<"u"?globalThis:n||self,a(n.fastUniqueNumbers={}))}(s,function(n){var a=function(m){return function(b){var _=m(b);return b.add(_),_}},c=function(m){return function(b,_){return m.set(b,_),_}},r=Number.MAX_SAFE_INTEGER===void 0?9007199254740991:Number.MAX_SAFE_INTEGER,e=536870912,i=e*2,t=function(m,b){return function(_){var E=b.get(_),I=E===void 0?_.size:E<i?E+1:0;if(!_.has(I))return m(_,I);if(_.size<e){for(;_.has(I);)I=Math.floor(Math.random()*i);return m(_,I)}if(_.size>r)throw new Error("Congratulations, you created a collection of unique numbers which uses all available integers!");for(;_.has(I);)I=Math.floor(Math.random()*r);return m(_,I)}},o=new WeakMap,u=c(o),d=t(u,o),p=a(d);n.addUniqueNumber=p,n.generateUniqueNumber=d})}),pl=be((s,f)=>{ue(),ce(),he(),function(n,a){typeof s=="object"&&typeof f<"u"?a(s,dl()):typeof define=="function"&&define.amd?define(["exports","fast-unique-numbers"],a):(n=typeof globalThis<"u"?globalThis:n||self,a(n.workerTimersBroker={},n.fastUniqueNumbers))}(s,function(n,a){var c=function(i){return i.method!==void 0&&i.method==="call"},r=function(i){return i.error===null&&typeof i.id=="number"},e=function(i){var t=new Map([[0,function(){}]]),o=new Map([[0,function(){}]]),u=new Map,d=new Worker(i);d.addEventListener("message",function(E){var I=E.data;if(c(I)){var y=I.params,v=y.timerId,j=y.timerType;if(j==="interval"){var x=t.get(v);if(typeof x=="number"){var A=u.get(x);if(A===void 0||A.timerId!==v||A.timerType!==j)throw new Error("The timer is in an undefined state.")}else if(typeof x<"u")x();else throw new Error("The timer is in an undefined state.")}else if(j==="timeout"){var T=o.get(v);if(typeof T=="number"){var B=u.get(T);if(B===void 0||B.timerId!==v||B.timerType!==j)throw new Error("The timer is in an undefined state.")}else if(typeof T<"u")T(),o.delete(v);else throw new Error("The timer is in an undefined state.")}}else if(r(I)){var Y=I.id,X=u.get(Y);if(X===void 0)throw new Error("The timer is in an undefined state.");var ae=X.timerId,P=X.timerType;u.delete(Y),P==="interval"?t.delete(ae):o.delete(ae)}else{var Q=I.error.message;throw new Error(Q)}});var p=function(E){var I=a.generateUniqueNumber(u);u.set(I,{timerId:E,timerType:"interval"}),t.set(E,I),d.postMessage({id:I,method:"clear",params:{timerId:E,timerType:"interval"}})},m=function(E){var I=a.generateUniqueNumber(u);u.set(I,{timerId:E,timerType:"timeout"}),o.set(E,I),d.postMessage({id:I,method:"clear",params:{timerId:E,timerType:"timeout"}})},b=function(E){var I=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,y=a.generateUniqueNumber(t);return t.set(y,function(){E(),typeof t.get(y)=="function"&&d.postMessage({id:null,method:"set",params:{delay:I,now:performance.now(),timerId:y,timerType:"interval"}})}),d.postMessage({id:null,method:"set",params:{delay:I,now:performance.now(),timerId:y,timerType:"interval"}}),y},_=function(E){var I=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,y=a.generateUniqueNumber(o);return o.set(y,E),d.postMessage({id:null,method:"set",params:{delay:I,now:performance.now(),timerId:y,timerType:"timeout"}}),y};return{clearInterval:p,clearTimeout:m,setInterval:b,setTimeout:_}};n.load=e})}),gl=be((s,f)=>{ue(),ce(),he(),function(n,a){typeof s=="object"&&typeof f<"u"?a(s,pl()):typeof define=="function"&&define.amd?define(["exports","worker-timers-broker"],a):(n=typeof globalThis<"u"?globalThis:n||self,a(n.workerTimers={},n.workerTimersBroker))}(s,function(n,a){var c=function(d,p){var m=null;return function(){if(m!==null)return m;var b=new Blob([p],{type:"application/javascript; charset=utf-8"}),_=URL.createObjectURL(b);return m=d(_),setTimeout(function(){return URL.revokeObjectURL(_)}),m}},r=`(()=>{var e={472:(e,t,r)=>{var o,i;void 0===(i="function"==typeof(o=function(){"use strict";var e=new Map,t=new Map,r=function(t){var r=e.get(t);if(void 0===r)throw new Error('There is no interval scheduled with the given id "'.concat(t,'".'));clearTimeout(r),e.delete(t)},o=function(e){var r=t.get(e);if(void 0===r)throw new Error('There is no timeout scheduled with the given id "'.concat(e,'".'));clearTimeout(r),t.delete(e)},i=function(e,t){var r,o=performance.now();return{expected:o+(r=e-Math.max(0,o-t)),remainingDelay:r}},n=function e(t,r,o,i){var n=performance.now();n>o?postMessage({id:null,method:"call",params:{timerId:r,timerType:i}}):t.set(r,setTimeout(e,o-n,t,r,o,i))},a=function(t,r,o){var a=i(t,o),s=a.expected,d=a.remainingDelay;e.set(r,setTimeout(n,d,e,r,s,"interval"))},s=function(e,r,o){var a=i(e,o),s=a.expected,d=a.remainingDelay;t.set(r,setTimeout(n,d,t,r,s,"timeout"))};addEventListener("message",(function(e){var t=e.data;try{if("clear"===t.method){var i=t.id,n=t.params,d=n.timerId,c=n.timerType;if("interval"===c)r(d),postMessage({error:null,id:i});else{if("timeout"!==c)throw new Error('The given type "'.concat(c,'" is not supported'));o(d),postMessage({error:null,id:i})}}else{if("set"!==t.method)throw new Error('The given method "'.concat(t.method,'" is not supported'));var u=t.params,l=u.delay,p=u.now,m=u.timerId,v=u.timerType;if("interval"===v)a(l,m,p);else{if("timeout"!==v)throw new Error('The given type "'.concat(v,'" is not supported'));s(l,m,p)}}}catch(e){postMessage({error:{message:e.message},id:t.id,result:null})}}))})?o.call(t,r,t,e):o)||(e.exports=i)}},t={};function r(o){var i=t[o];if(void 0!==i)return i.exports;var n=t[o]={exports:{}};return e[o](n,n.exports,r),n.exports}r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var o in t)r.o(t,o)&&!r.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{"use strict";r(472)})()})();`,e=c(a.load,r),i=function(d){return e().clearInterval(d)},t=function(d){return e().clearTimeout(d)},o=function(){var d;return(d=e()).setInterval.apply(d,arguments)},u=function(){var d;return(d=e()).setTimeout.apply(d,arguments)};n.clearInterval=i,n.clearTimeout=t,n.setInterval=o,n.setTimeout=u})}),ml=be(s=>{ue(),ce(),he();var f=s&&s.__createBinding||(Object.create?function(o,u,d,p){p===void 0&&(p=d);var m=Object.getOwnPropertyDescriptor(u,d);(!m||("get"in m?!u.__esModule:m.writable||m.configurable))&&(m={enumerable:!0,get:function(){return u[d]}}),Object.defineProperty(o,p,m)}:function(o,u,d,p){p===void 0&&(p=d),o[p]=u[d]}),n=s&&s.__setModuleDefault||(Object.create?function(o,u){Object.defineProperty(o,"default",{enumerable:!0,value:u})}:function(o,u){o.default=u}),a=s&&s.__importStar||function(){var o=function(u){return o=Object.getOwnPropertyNames||function(d){var p=[];for(var m in d)Object.prototype.hasOwnProperty.call(d,m)&&(p[p.length]=m);return p},o(u)};return function(u){if(u&&u.__esModule)return u;var d={};if(u!=null)for(var p=o(u),m=0;m<p.length;m++)p[m]!=="default"&&f(d,u,p[m]);return n(d,u),d}}();Object.defineProperty(s,"__esModule",{value:!0});var c=a(qr()),r=gl(),e={set:r.setInterval,clear:r.clearInterval},i={set:(o,u)=>setInterval(o,u),clear:o=>clearInterval(o)},t=o=>{switch(o){case"native":return i;case"worker":return e;case"auto":default:return c.default&&!c.isWebWorker&&!c.isReactNativeBrowser?e:i}};s.default=t}),ds=be(s=>{ue(),ce(),he();var f=s&&s.__importDefault||function(c){return c&&c.__esModule?c:{default:c}};Object.defineProperty(s,"__esModule",{value:!0});var n=f(ml()),a=class{get keepaliveTimeoutTimestamp(){return this._keepaliveTimeoutTimestamp}get intervalEvery(){return this._intervalEvery}get keepalive(){return this._keepalive}constructor(c,r){this.destroyed=!1,this.client=c,this.timer=typeof r=="object"&&"set"in r&&"clear"in r?r:(0,n.default)(r),this.setKeepalive(c.options.keepalive)}clear(){this.timerId&&(this.timer.clear(this.timerId),this.timerId=null)}setKeepalive(c){if(c*=1e3,isNaN(c)||c<=0||c>2147483647)throw new Error(`Keepalive value must be an integer between 0 and 2147483647. Provided value is ${c}`);this._keepalive=c,this.reschedule(),this.client.log(`KeepaliveManager: set keepalive to ${c}ms`)}destroy(){this.clear(),this.destroyed=!0}reschedule(){if(this.destroyed)return;this.clear(),this.counter=0;let c=Math.ceil(this._keepalive*1.5);this._keepaliveTimeoutTimestamp=Date.now()+c,this._intervalEvery=Math.ceil(this._keepalive/2),this.timerId=this.timer.set(()=>{this.destroyed||(this.counter+=1,this.counter===2?this.client.sendPing():this.counter>2&&this.client.onKeepaliveTimeout())},this._intervalEvery)}};s.default=a}),yn=be(s=>{ue(),ce(),he();var f=s&&s.__createBinding||(Object.create?function(x,A,T,B){B===void 0&&(B=T);var Y=Object.getOwnPropertyDescriptor(A,T);(!Y||("get"in Y?!A.__esModule:Y.writable||Y.configurable))&&(Y={enumerable:!0,get:function(){return A[T]}}),Object.defineProperty(x,B,Y)}:function(x,A,T,B){B===void 0&&(B=T),x[B]=A[T]}),n=s&&s.__setModuleDefault||(Object.create?function(x,A){Object.defineProperty(x,"default",{enumerable:!0,value:A})}:function(x,A){x.default=A}),a=s&&s.__importStar||function(){var x=function(A){return x=Object.getOwnPropertyNames||function(T){var B=[];for(var Y in T)Object.prototype.hasOwnProperty.call(T,Y)&&(B[B.length]=Y);return B},x(A)};return function(A){if(A&&A.__esModule)return A;var T={};if(A!=null)for(var B=x(A),Y=0;Y<B.length;Y++)B[Y]!=="default"&&f(T,A,B[Y]);return n(T,A),T}}(),c=s&&s.__importDefault||function(x){return x&&x.__esModule?x:{default:x}};Object.defineProperty(s,"__esModule",{value:!0});var r=c(Aa()),e=c(Wa()),i=c(Ko()),t=er(),o=c(qa()),u=a(Ha()),d=c(kt()),p=c(Yo()),m=c(cl()),b=sr(),_=fl(),E=c(ds()),I=a(qr()),y=globalThis.setImmediate||((...x)=>{let A=x.shift();(0,b.nextTick)(()=>{A(...x)})}),v={keepalive:60,reschedulePings:!0,protocolId:"MQTT",protocolVersion:4,reconnectPeriod:1e3,connectTimeout:30*1e3,clean:!0,resubscribe:!0,subscribeBatchSize:null,writeCache:!0,timerVariant:"auto"},j=class wn extends _.TypedEventEmitter{static defaultId(){return`mqttjs_${Math.random().toString(16).substr(2,8)}`}constructor(A,T){super(),this.options=T||{};for(let B in v)typeof this.options[B]>"u"?this.options[B]=v[B]:this.options[B]=T[B];this.log=this.options.log||(0,d.default)("mqttjs:client"),this.noop=this._noop.bind(this),this.log("MqttClient :: version:",wn.VERSION),I.isWebWorker?this.log("MqttClient :: environment","webworker"):this.log("MqttClient :: environment",I.default?"browser":"node"),this.log("MqttClient :: options.protocol",T.protocol),this.log("MqttClient :: options.protocolVersion",T.protocolVersion),this.log("MqttClient :: options.username",T.username),this.log("MqttClient :: options.keepalive",T.keepalive),this.log("MqttClient :: options.reconnectPeriod",T.reconnectPeriod),this.log("MqttClient :: options.rejectUnauthorized",T.rejectUnauthorized),this.log("MqttClient :: options.properties.topicAliasMaximum",T.properties?T.properties.topicAliasMaximum:void 0),this.options.clientId=typeof T.clientId=="string"?T.clientId:wn.defaultId(),this.log("MqttClient :: clientId",this.options.clientId),this.options.customHandleAcks=T.protocolVersion===5&&T.customHandleAcks?T.customHandleAcks:(...B)=>{B[3](null,0)},this.options.writeCache||(e.default.writeToStream.cacheNumbers=!1),this.streamBuilder=A,this.messageIdProvider=typeof this.options.messageIdProvider>"u"?new i.default:this.options.messageIdProvider,this.outgoingStore=T.outgoingStore||new p.default,this.incomingStore=T.incomingStore||new p.default,this.queueQoSZero=T.queueQoSZero===void 0?!0:T.queueQoSZero,this._resubscribeTopics={},this.messageIdToTopic={},this.keepaliveManager=null,this.connected=!1,this.disconnecting=!1,this.reconnecting=!1,this.queue=[],this.connackTimer=null,this.reconnectTimer=null,this._storeProcessing=!1,this._packetIdsDuringStoreProcessing={},this._storeProcessingQueue=[],this.outgoing={},this._firstConnection=!0,T.properties&&T.properties.topicAliasMaximum>0&&(T.properties.topicAliasMaximum>65535?this.log("MqttClient :: options.properties.topicAliasMaximum is out of range"):this.topicAliasRecv=new r.default(T.properties.topicAliasMaximum)),this.on("connect",()=>{let{queue:B}=this,Y=()=>{let X=B.shift();this.log("deliver :: entry %o",X);let ae=null;if(!X){this._resubscribe();return}ae=X.packet,this.log("deliver :: call _sendPacket for %o",ae);let P=!0;ae.messageId&&ae.messageId!==0&&(this.messageIdProvider.register(ae.messageId)||(P=!1)),P?this._sendPacket(ae,Q=>{X.cb&&X.cb(Q),Y()}):(this.log("messageId: %d has already used. The message is skipped and removed.",ae.messageId),Y())};this.log("connect :: sending queued packets"),Y()}),this.on("close",()=>{this.log("close :: connected set to `false`"),this.connected=!1,this.log("close :: clearing connackTimer"),clearTimeout(this.connackTimer),this._destroyKeepaliveManager(),this.topicAliasRecv&&this.topicAliasRecv.clear(),this.log("close :: calling _setupReconnect"),this._setupReconnect()}),this.options.manualConnect||(this.log("MqttClient :: setting up stream"),this.connect())}handleAuth(A,T){T()}handleMessage(A,T){T()}_nextId(){return this.messageIdProvider.allocate()}getLastMessageId(){return this.messageIdProvider.getLastAllocated()}connect(){var A;let T=new t.Writable,B=e.default.parser(this.options),Y=null,X=[];this.log("connect :: calling method to clear reconnect"),this._clearReconnect(),this.disconnected&&!this.reconnecting&&(this.incomingStore=this.options.incomingStore||new p.default,this.outgoingStore=this.options.outgoingStore||new p.default,this.disconnecting=!1,this.disconnected=!1),this.log("connect :: using streamBuilder provided to client to create stream"),this.stream=this.streamBuilder(this),B.on("packet",W=>{this.log("parser :: on packet push to packets array."),X.push(W)});let ae=()=>{this.log("work :: getting next packet in queue");let W=X.shift();if(W)this.log("work :: packet pulled from queue"),(0,m.default)(this,W,P);else{this.log("work :: no packets in queue");let me=Y;Y=null,this.log("work :: done flag is %s",!!me),me&&me()}},P=()=>{if(X.length)(0,b.nextTick)(ae);else{let W=Y;Y=null,W()}};T._write=(W,me,de)=>{Y=de,this.log("writable stream :: parsing buffer"),B.parse(W),ae()};let Q=W=>{this.log("streamErrorHandler :: error",W.message),W.code?(this.log("streamErrorHandler :: emitting error"),this.emit("error",W)):this.noop(W)};this.log("connect :: pipe stream to writable stream"),this.stream.pipe(T),this.stream.on("error",Q),this.stream.on("close",()=>{this.log("(%s)stream :: on close",this.options.clientId),this._flushVolatile(),this.log("stream: emit close to MqttClient"),this.emit("close")}),this.log("connect: sending packet `connect`");let J={cmd:"connect",protocolId:this.options.protocolId,protocolVersion:this.options.protocolVersion,clean:this.options.clean,clientId:this.options.clientId,keepalive:this.options.keepalive,username:this.options.username,password:this.options.password,properties:this.options.properties};if(this.options.will&&(J.will=Object.assign(Object.assign({},this.options.will),{payload:(A=this.options.will)===null||A===void 0?void 0:A.payload})),this.topicAliasRecv&&(J.properties||(J.properties={}),this.topicAliasRecv&&(J.properties.topicAliasMaximum=this.topicAliasRecv.max)),this._writePacket(J),B.on("error",this.emit.bind(this,"error")),this.options.properties){if(!this.options.properties.authenticationMethod&&this.options.properties.authenticationData)return this.end(()=>this.emit("error",new Error("Packet has no Authentication Method"))),this;if(this.options.properties.authenticationMethod&&this.options.authPacket&&typeof this.options.authPacket=="object"){let W=Object.assign({cmd:"auth",reasonCode:0},this.options.authPacket);this._writePacket(W)}}return this.stream.setMaxListeners(1e3),clearTimeout(this.connackTimer),this.connackTimer=setTimeout(()=>{this.log("!!connectTimeout hit!! Calling _cleanUp with force `true`"),this.emit("error",new Error("connack timeout")),this._cleanUp(!0)},this.options.connectTimeout),this}publish(A,T,B,Y){this.log("publish :: message `%s` to topic `%s`",T,A);let{options:X}=this;typeof B=="function"&&(Y=B,B=null),B=B||{},B=Object.assign(Object.assign({},{qos:0,retain:!1,dup:!1}),B);let{qos:ae,retain:P,dup:Q,properties:J,cbStorePut:W}=B;if(this._checkDisconnecting(Y))return this;let me=()=>{let de=0;if((ae===1||ae===2)&&(de=this._nextId(),de===null))return this.log("No messageId left"),!1;let ge={cmd:"publish",topic:A,payload:T,qos:ae,retain:P,messageId:de,dup:Q};switch(X.protocolVersion===5&&(ge.properties=J),this.log("publish :: qos",ae),ae){case 1:case 2:this.outgoing[ge.messageId]={volatile:!1,cb:Y||this.noop},this.log("MqttClient:publish: packet cmd: %s",ge.cmd),this._sendPacket(ge,void 0,W);break;default:this.log("MqttClient:publish: packet cmd: %s",ge.cmd),this._sendPacket(ge,Y,W);break}return!0};return(this._storeProcessing||this._storeProcessingQueue.length>0||!me())&&this._storeProcessingQueue.push({invoke:me,cbStorePut:B.cbStorePut,callback:Y}),this}publishAsync(A,T,B){return new Promise((Y,X)=>{this.publish(A,T,B,(ae,P)=>{ae?X(ae):Y(P)})})}subscribe(A,T,B){let Y=this.options.protocolVersion;typeof T=="function"&&(B=T),B=B||this.noop;let X=!1,ae=[];typeof A=="string"?(A=[A],ae=A):Array.isArray(A)?ae=A:typeof A=="object"&&(X=A.resubscribe,delete A.resubscribe,ae=Object.keys(A));let P=u.validateTopics(ae);if(P!==null)return y(B,new Error(`Invalid topic ${P}`)),this;if(this._checkDisconnecting(B))return this.log("subscribe: discconecting true"),this;let Q={qos:0};Y===5&&(Q.nl=!1,Q.rap=!1,Q.rh=0),T=Object.assign(Object.assign({},Q),T);let J=T.properties,W=[],me=(_e,G)=>{if(G=G||T,!Object.prototype.hasOwnProperty.call(this._resubscribeTopics,_e)||this._resubscribeTopics[_e].qos<G.qos||X){let fe={topic:_e,qos:G.qos};Y===5&&(fe.nl=G.nl,fe.rap=G.rap,fe.rh=G.rh,fe.properties=J),this.log("subscribe: pushing topic `%s` and qos `%s` to subs list",fe.topic,fe.qos),W.push(fe)}};if(Array.isArray(A)?A.forEach(_e=>{this.log("subscribe: array topic %s",_e),me(_e)}):Object.keys(A).forEach(_e=>{this.log("subscribe: object topic %s, %o",_e,A[_e]),me(_e,A[_e])}),!W.length)return B(null,[]),this;let de=(_e,G)=>{let fe={cmd:"subscribe",subscriptions:_e,messageId:G};if(J&&(fe.properties=J),this.options.resubscribe){this.log("subscribe :: resubscribe true");let re=[];_e.forEach(pe=>{if(this.options.reconnectPeriod>0){let N={qos:pe.qos};Y===5&&(N.nl=pe.nl||!1,N.rap=pe.rap||!1,N.rh=pe.rh||0,N.properties=pe.properties),this._resubscribeTopics[pe.topic]=N,re.push(pe.topic)}}),this.messageIdToTopic[fe.messageId]=re}let C=new Promise((re,pe)=>{this.outgoing[fe.messageId]={volatile:!0,cb(N,Ae){if(!N){let{granted:V}=Ae;for(let L=0;L<V.length;L+=1)_e[L].qos=V[L]}N?pe(new b.ErrorWithSubackPacket(N.message,Ae)):re(Ae)}}});return this.log("subscribe :: call _sendPacket"),this._sendPacket(fe),C},ge=()=>{var _e;let G=(_e=this.options.subscribeBatchSize)!==null&&_e!==void 0?_e:W.length,fe=[];for(let C=0;C<W.length;C+=G){let re=W.slice(C,C+G),pe=this._nextId();if(pe===null)return this.log("No messageId left"),!1;fe.push(de(re,pe))}return Promise.all(fe).then(C=>{B(null,W,C.at(-1))}).catch(C=>{B(C,W,C.packet)}),!0};return(this._storeProcessing||this._storeProcessingQueue.length>0||!ge())&&this._storeProcessingQueue.push({invoke:ge,callback:B}),this}subscribeAsync(A,T){return new Promise((B,Y)=>{this.subscribe(A,T,(X,ae)=>{X?Y(X):B(ae)})})}unsubscribe(A,T,B){typeof A=="string"&&(A=[A]),typeof T=="function"&&(B=T),B=B||this.noop;let Y=u.validateTopics(A);if(Y!==null)return y(B,new Error(`Invalid topic ${Y}`)),this;if(this._checkDisconnecting(B))return this;let X=()=>{let ae=this._nextId();if(ae===null)return this.log("No messageId left"),!1;let P={cmd:"unsubscribe",messageId:ae,unsubscriptions:[]};return typeof A=="string"?P.unsubscriptions=[A]:Array.isArray(A)&&(P.unsubscriptions=A),this.options.resubscribe&&P.unsubscriptions.forEach(Q=>{delete this._resubscribeTopics[Q]}),typeof T=="object"&&T.properties&&(P.properties=T.properties),this.outgoing[P.messageId]={volatile:!0,cb:B},this.log("unsubscribe: call _sendPacket"),this._sendPacket(P),!0};return(this._storeProcessing||this._storeProcessingQueue.length>0||!X())&&this._storeProcessingQueue.push({invoke:X,callback:B}),this}unsubscribeAsync(A,T){return new Promise((B,Y)=>{this.unsubscribe(A,T,(X,ae)=>{X?Y(X):B(ae)})})}end(A,T,B){this.log("end :: (%s)",this.options.clientId),(A==null||typeof A!="boolean")&&(B=B||T,T=A,A=!1),typeof T!="object"&&(B=B||T,T=null),this.log("end :: cb? %s",!!B),(!B||typeof B!="function")&&(B=this.noop);let Y=()=>{this.log("end :: closeStores: closing incoming and outgoing stores"),this.disconnected=!0,this.incomingStore.close(ae=>{this.outgoingStore.close(P=>{if(this.log("end :: closeStores: emitting end"),this.emit("end"),B){let Q=ae||P;this.log("end :: closeStores: invoking callback with args"),B(Q)}})}),this._deferredReconnect?this._deferredReconnect():(this.options.reconnectPeriod===0||this.options.manualConnect)&&(this.disconnecting=!1)},X=()=>{this.log("end :: (%s) :: finish :: calling _cleanUp with force %s",this.options.clientId,A),this._cleanUp(A,()=>{this.log("end :: finish :: calling process.nextTick on closeStores"),(0,b.nextTick)(Y)},T)};return this.disconnecting?(B(),this):(this._clearReconnect(),this.disconnecting=!0,!A&&Object.keys(this.outgoing).length>0?(this.log("end :: (%s) :: calling finish in 10ms once outgoing is empty",this.options.clientId),this.once("outgoingEmpty",setTimeout.bind(null,X,10))):(this.log("end :: (%s) :: immediately calling finish",this.options.clientId),X()),this)}endAsync(A,T){return new Promise((B,Y)=>{this.end(A,T,X=>{X?Y(X):B()})})}removeOutgoingMessage(A){if(this.outgoing[A]){let{cb:T}=this.outgoing[A];this._removeOutgoingAndStoreMessage(A,()=>{T(new Error("Message removed"))})}return this}reconnect(A){this.log("client reconnect");let T=()=>{A?(this.options.incomingStore=A.incomingStore,this.options.outgoingStore=A.outgoingStore):(this.options.incomingStore=null,this.options.outgoingStore=null),this.incomingStore=this.options.incomingStore||new p.default,this.outgoingStore=this.options.outgoingStore||new p.default,this.disconnecting=!1,this.disconnected=!1,this._deferredReconnect=null,this._reconnect()};return this.disconnecting&&!this.disconnected?this._deferredReconnect=T:T(),this}_flushVolatile(){this.outgoing&&(this.log("_flushVolatile :: deleting volatile messages from the queue and setting their callbacks as error function"),Object.keys(this.outgoing).forEach(A=>{this.outgoing[A].volatile&&typeof this.outgoing[A].cb=="function"&&(this.outgoing[A].cb(new Error("Connection closed")),delete this.outgoing[A])}))}_flush(){this.outgoing&&(this.log("_flush: queue exists? %b",!!this.outgoing),Object.keys(this.outgoing).forEach(A=>{typeof this.outgoing[A].cb=="function"&&(this.outgoing[A].cb(new Error("Connection closed")),delete this.outgoing[A])}))}_removeTopicAliasAndRecoverTopicName(A){let T;A.properties&&(T=A.properties.topicAlias);let B=A.topic.toString();if(this.log("_removeTopicAliasAndRecoverTopicName :: alias %d, topic %o",T,B),B.length===0){if(typeof T>"u")return new Error("Unregistered Topic Alias");if(B=this.topicAliasSend.getTopicByAlias(T),typeof B>"u")return new Error("Unregistered Topic Alias");A.topic=B}T&&delete A.properties.topicAlias}_checkDisconnecting(A){return this.disconnecting&&(A&&A!==this.noop?A(new Error("client disconnecting")):this.emit("error",new Error("client disconnecting"))),this.disconnecting}_reconnect(){this.log("_reconnect: emitting reconnect to client"),this.emit("reconnect"),this.connected?(this.end(()=>{this.connect()}),this.log("client already connected. disconnecting first.")):(this.log("_reconnect: calling connect"),this.connect())}_setupReconnect(){!this.disconnecting&&!this.reconnectTimer&&this.options.reconnectPeriod>0?(this.reconnecting||(this.log("_setupReconnect :: emit `offline` state"),this.emit("offline"),this.log("_setupReconnect :: set `reconnecting` to `true`"),this.reconnecting=!0),this.log("_setupReconnect :: setting reconnectTimer for %d ms",this.options.reconnectPeriod),this.reconnectTimer=setInterval(()=>{this.log("reconnectTimer :: reconnect triggered!"),this._reconnect()},this.options.reconnectPeriod)):this.log("_setupReconnect :: doing nothing...")}_clearReconnect(){this.log("_clearReconnect : clearing reconnect timer"),this.reconnectTimer&&(clearInterval(this.reconnectTimer),this.reconnectTimer=null)}_cleanUp(A,T,B={}){if(T&&(this.log("_cleanUp :: done callback provided for on stream close"),this.stream.on("close",T)),this.log("_cleanUp :: forced? %s",A),A)this.options.reconnectPeriod===0&&this.options.clean&&this._flush(),this.log("_cleanUp :: (%s) :: destroying stream",this.options.clientId),this.stream.destroy();else{let Y=Object.assign({cmd:"disconnect"},B);this.log("_cleanUp :: (%s) :: call _sendPacket with disconnect packet",this.options.clientId),this._sendPacket(Y,()=>{this.log("_cleanUp :: (%s) :: destroying stream",this.options.clientId),y(()=>{this.stream.end(()=>{this.log("_cleanUp :: (%s) :: stream destroyed",this.options.clientId)})})})}!this.disconnecting&&!this.reconnecting&&(this.log("_cleanUp :: client not disconnecting/reconnecting. Clearing and resetting reconnect."),this._clearReconnect(),this._setupReconnect()),this._destroyKeepaliveManager(),T&&!this.connected&&(this.log("_cleanUp :: (%s) :: removing stream `done` callback `close` listener",this.options.clientId),this.stream.removeListener("close",T),T())}_storeAndSend(A,T,B){this.log("storeAndSend :: store packet with cmd %s to outgoingStore",A.cmd);let Y=A,X;if(Y.cmd==="publish"&&(Y=(0,o.default)(A),X=this._removeTopicAliasAndRecoverTopicName(Y),X))return T&&T(X);this.outgoingStore.put(Y,ae=>{if(ae)return T&&T(ae);B(),this._writePacket(A,T)})}_applyTopicAlias(A){if(this.options.protocolVersion===5&&A.cmd==="publish"){let T;A.properties&&(T=A.properties.topicAlias);let B=A.topic.toString();if(this.topicAliasSend)if(T){if(B.length!==0&&(this.log("applyTopicAlias :: register topic: %s - alias: %d",B,T),!this.topicAliasSend.put(B,T)))return this.log("applyTopicAlias :: error out of range. topic: %s - alias: %d",B,T),new Error("Sending Topic Alias out of range")}else B.length!==0&&(this.options.autoAssignTopicAlias?(T=this.topicAliasSend.getAliasByTopic(B),T?(A.topic="",A.properties=Object.assign(Object.assign({},A.properties),{topicAlias:T}),this.log("applyTopicAlias :: auto assign(use) topic: %s - alias: %d",B,T)):(T=this.topicAliasSend.getLruAlias(),this.topicAliasSend.put(B,T),A.properties=Object.assign(Object.assign({},A.properties),{topicAlias:T}),this.log("applyTopicAlias :: auto assign topic: %s - alias: %d",B,T))):this.options.autoUseTopicAlias&&(T=this.topicAliasSend.getAliasByTopic(B),T&&(A.topic="",A.properties=Object.assign(Object.assign({},A.properties),{topicAlias:T}),this.log("applyTopicAlias :: auto use topic: %s - alias: %d",B,T))));else if(T)return this.log("applyTopicAlias :: error out of range. topic: %s - alias: %d",B,T),new Error("Sending Topic Alias out of range")}}_noop(A){this.log("noop ::",A)}_writePacket(A,T){this.log("_writePacket :: packet: %O",A),this.log("_writePacket :: emitting `packetsend`"),this.emit("packetsend",A),this.log("_writePacket :: writing to stream");let B=e.default.writeToStream(A,this.stream,this.options);this.log("_writePacket :: writeToStream result %s",B),!B&&T&&T!==this.noop?(this.log("_writePacket :: handle events on `drain` once through callback."),this.stream.once("drain",T)):T&&(this.log("_writePacket :: invoking cb"),T())}_sendPacket(A,T,B,Y){this.log("_sendPacket :: (%s) ::  start",this.options.clientId),B=B||this.noop,T=T||this.noop;let X=this._applyTopicAlias(A);if(X){T(X);return}if(!this.connected){if(A.cmd==="auth"){this._writePacket(A,T);return}this.log("_sendPacket :: client not connected. Storing packet offline."),this._storePacket(A,T,B);return}if(Y){this._writePacket(A,T);return}switch(A.cmd){case"publish":break;case"pubrel":this._storeAndSend(A,T,B);return;default:this._writePacket(A,T);return}switch(A.qos){case 2:case 1:this._storeAndSend(A,T,B);break;case 0:default:this._writePacket(A,T);break}this.log("_sendPacket :: (%s) ::  end",this.options.clientId)}_storePacket(A,T,B){this.log("_storePacket :: packet: %o",A),this.log("_storePacket :: cb? %s",!!T),B=B||this.noop;let Y=A;if(Y.cmd==="publish"){Y=(0,o.default)(A);let ae=this._removeTopicAliasAndRecoverTopicName(Y);if(ae)return T&&T(ae)}let X=Y.qos||0;X===0&&this.queueQoSZero||Y.cmd!=="publish"?this.queue.push({packet:Y,cb:T}):X>0?(T=this.outgoing[Y.messageId]?this.outgoing[Y.messageId].cb:null,this.outgoingStore.put(Y,ae=>{if(ae)return T&&T(ae);B()})):T&&T(new Error("No connection to broker"))}_setupKeepaliveManager(){this.log("_setupKeepaliveManager :: keepalive %d (seconds)",this.options.keepalive),!this.keepaliveManager&&this.options.keepalive&&(this.keepaliveManager=new E.default(this,this.options.timerVariant))}_destroyKeepaliveManager(){this.keepaliveManager&&(this.log("_destroyKeepaliveManager :: destroying keepalive manager"),this.keepaliveManager.destroy(),this.keepaliveManager=null)}reschedulePing(A=!1){this.keepaliveManager&&this.options.keepalive&&(A||this.options.reschedulePings)&&this._reschedulePing()}_reschedulePing(){this.log("_reschedulePing :: rescheduling ping"),this.keepaliveManager.reschedule()}sendPing(){this.log("_sendPing :: sending pingreq"),this._sendPacket({cmd:"pingreq"})}onKeepaliveTimeout(){this.emit("error",new Error("Keepalive timeout")),this.log("onKeepaliveTimeout :: calling _cleanUp with force true"),this._cleanUp(!0)}_resubscribe(){this.log("_resubscribe");let A=Object.keys(this._resubscribeTopics);if(!this._firstConnection&&(this.options.clean||this.options.protocolVersion>=4&&!this.connackPacket.sessionPresent)&&A.length>0)if(this.options.resubscribe)if(this.options.protocolVersion===5){this.log("_resubscribe: protocolVersion 5");for(let T=0;T<A.length;T++){let B={};B[A[T]]=this._resubscribeTopics[A[T]],B.resubscribe=!0,this.subscribe(B,{properties:B[A[T]].properties})}}else this._resubscribeTopics.resubscribe=!0,this.subscribe(this._resubscribeTopics);else this._resubscribeTopics={};this._firstConnection=!1}_onConnect(A){if(this.disconnected){this.emit("connect",A);return}this.connackPacket=A,this.messageIdProvider.clear(),this._setupKeepaliveManager(),this.connected=!0;let T=()=>{let B=this.outgoingStore.createStream(),Y=()=>{B.destroy(),B=null,this._flushStoreProcessingQueue(),X()},X=()=>{this._storeProcessing=!1,this._packetIdsDuringStoreProcessing={}};this.once("close",Y),B.on("error",P=>{X(),this._flushStoreProcessingQueue(),this.removeListener("close",Y),this.emit("error",P)});let ae=()=>{if(!B)return;let P=B.read(1),Q;if(!P){B.once("readable",ae);return}if(this._storeProcessing=!0,this._packetIdsDuringStoreProcessing[P.messageId]){ae();return}!this.disconnecting&&!this.reconnectTimer?(Q=this.outgoing[P.messageId]?this.outgoing[P.messageId].cb:null,this.outgoing[P.messageId]={volatile:!1,cb(J,W){Q&&Q(J,W),ae()}},this._packetIdsDuringStoreProcessing[P.messageId]=!0,this.messageIdProvider.register(P.messageId)?this._sendPacket(P,void 0,void 0,!0):this.log("messageId: %d has already used.",P.messageId)):B.destroy&&B.destroy()};B.on("end",()=>{let P=!0;for(let Q in this._packetIdsDuringStoreProcessing)if(!this._packetIdsDuringStoreProcessing[Q]){P=!1;break}this.removeListener("close",Y),P?(X(),this._invokeAllStoreProcessingQueue(),this.emit("connect",A)):T()}),ae()};T()}_invokeStoreProcessingQueue(){if(!this._storeProcessing&&this._storeProcessingQueue.length>0){let A=this._storeProcessingQueue[0];if(A&&A.invoke())return this._storeProcessingQueue.shift(),!0}return!1}_invokeAllStoreProcessingQueue(){for(;this._invokeStoreProcessingQueue(););}_flushStoreProcessingQueue(){for(let A of this._storeProcessingQueue)A.cbStorePut&&A.cbStorePut(new Error("Connection closed")),A.callback&&A.callback(new Error("Connection closed"));this._storeProcessingQueue.splice(0)}_removeOutgoingAndStoreMessage(A,T){delete this.outgoing[A],this.outgoingStore.del({messageId:A},(B,Y)=>{T(B,Y),this.messageIdProvider.deallocate(A),this._invokeStoreProcessingQueue()})}};j.VERSION=b.MQTTJS_VERSION,s.default=j}),bl=be(s=>{ue(),ce(),he(),Object.defineProperty(s,"__esModule",{value:!0});var f=fs(),n=class{constructor(){this.numberAllocator=new f.NumberAllocator(1,65535)}allocate(){return this.lastId=this.numberAllocator.alloc(),this.lastId}getLastAllocated(){return this.lastId}register(a){return this.numberAllocator.use(a)}deallocate(a){this.numberAllocator.free(a)}clear(){this.numberAllocator.clear()}};s.default=n});function qt(s){throw new RangeError(gs[s])}function Yn(s,f){let n=s.split("@"),a="";n.length>1&&(a=n[0]+"@",s=n[1]);let c=function(r,e){let i=[],t=r.length;for(;t--;)i[t]=e(r[t]);return i}((s=s.replace(ps,".")).split("."),f).join(".");return a+c}function Jn(s){let f=[],n=0,a=s.length;for(;n<a;){let c=s.charCodeAt(n++);if(c>=55296&&c<=56319&&n<a){let r=s.charCodeAt(n++);(64512&r)==56320?f.push(((1023&c)<<10)+(1023&r)+65536):(f.push(c),n--)}else f.push(c)}return f}var Xn,Zn,ps,gs,ft,Er,Zr,ei,ti,ri,Ut,yl=nt(()=>{ue(),ce(),he(),Xn=/^xn--/,Zn=/[^\0-\x7E]/,ps=/[\x2E\u3002\uFF0E\uFF61]/g,gs={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},ft=Math.floor,Er=String.fromCharCode,Zr=function(s,f){return s+22+75*(s<26)-((f!=0)<<5)},ei=function(s,f,n){let a=0;for(s=n?ft(s/700):s>>1,s+=ft(s/f);s>455;a+=36)s=ft(s/35);return ft(a+36*s/(s+38))},ti=function(s){let f=[],n=s.length,a=0,c=128,r=72,e=s.lastIndexOf("-");e<0&&(e=0);for(let t=0;t<e;++t)s.charCodeAt(t)>=128&&qt("not-basic"),f.push(s.charCodeAt(t));for(let t=e>0?e+1:0;t<n;){let o=a;for(let d=1,p=36;;p+=36){t>=n&&qt("invalid-input");let m=(i=s.charCodeAt(t++))-48<10?i-22:i-65<26?i-65:i-97<26?i-97:36;(m>=36||m>ft((2147483647-a)/d))&&qt("overflow"),a+=m*d;let b=p<=r?1:p>=r+26?26:p-r;if(m<b)break;let _=36-b;d>ft(2147483647/_)&&qt("overflow"),d*=_}let u=f.length+1;r=ei(a-o,u,o==0),ft(a/u)>2147483647-c&&qt("overflow"),c+=ft(a/u),a%=u,f.splice(a++,0,c)}var i;return String.fromCodePoint(...f)},ri=function(s){let f=[],n=(s=Jn(s)).length,a=128,c=0,r=72;for(let t of s)t<128&&f.push(Er(t));let e=f.length,i=e;for(e&&f.push("-");i<n;){let t=2147483647;for(let u of s)u>=a&&u<t&&(t=u);let o=i+1;t-a>ft((2147483647-c)/o)&&qt("overflow"),c+=(t-a)*o,a=t;for(let u of s)if(u<a&&++c>2147483647&&qt("overflow"),u==a){let d=c;for(let p=36;;p+=36){let m=p<=r?1:p>=r+26?26:p-r;if(d<m)break;let b=d-m,_=36-m;f.push(Er(Zr(m+b%_,0))),d=ft(b/_)}f.push(Er(Zr(d,0))),r=ei(c,o,i==e),c=0,++i}++c,++a}return f.join("")},Ut={version:"2.1.0",ucs2:{decode:Jn,encode:s=>String.fromCodePoint(...s)},decode:ti,encode:ri,toASCII:function(s){return Yn(s,function(f){return Zn.test(f)?"xn--"+ri(f):f})},toUnicode:function(s){return Yn(s,function(f){return Xn.test(f)?ti(f.slice(4).toLowerCase()):f})}},Ut.decode,Ut.encode,Ut.toASCII,Ut.toUnicode,Ut.ucs2,Ut.version});function wl(s,f){return Object.prototype.hasOwnProperty.call(s,f)}var eo,tr,to,gt,_l=nt(()=>{ue(),ce(),he(),eo=function(s,f,n,a){f=f||"&",n=n||"=";var c={};if(typeof s!="string"||s.length===0)return c;var r=/\+/g;s=s.split(f);var e=1e3;a&&typeof a.maxKeys=="number"&&(e=a.maxKeys);var i=s.length;e>0&&i>e&&(i=e);for(var t=0;t<i;++t){var o,u,d,p,m=s[t].replace(r,"%20"),b=m.indexOf(n);b>=0?(o=m.substr(0,b),u=m.substr(b+1)):(o=m,u=""),d=decodeURIComponent(o),p=decodeURIComponent(u),wl(c,d)?Array.isArray(c[d])?c[d].push(p):c[d]=[c[d],p]:c[d]=p}return c},tr=function(s){switch(typeof s){case"string":return s;case"boolean":return s?"true":"false";case"number":return isFinite(s)?s:"";default:return""}},to=function(s,f,n,a){return f=f||"&",n=n||"=",s===null&&(s=void 0),typeof s=="object"?Object.keys(s).map(function(c){var r=encodeURIComponent(tr(c))+n;return Array.isArray(s[c])?s[c].map(function(e){return r+encodeURIComponent(tr(e))}).join(f):r+encodeURIComponent(tr(s[c]))}).join(f):a?encodeURIComponent(tr(a))+n+encodeURIComponent(tr(s)):""},gt={},gt.decode=gt.parse=eo,gt.encode=gt.stringify=to,gt.decode,gt.encode,gt.parse,gt.stringify});function _n(){throw new Error("setTimeout has not been defined")}function vn(){throw new Error("clearTimeout has not been defined")}function ms(s){if(Et===setTimeout)return setTimeout(s,0);if((Et===_n||!Et)&&setTimeout)return Et=setTimeout,setTimeout(s,0);try{return Et(s,0)}catch{try{return Et.call(null,s,0)}catch{return Et.call(this||Yt,s,0)}}}function vl(){Jt&&Qt&&(Jt=!1,Qt.length?bt=Qt.concat(bt):pr=-1,bt.length&&bs())}function bs(){if(!Jt){var s=ms(vl);Jt=!0;for(var f=bt.length;f;){for(Qt=bt,bt=[];++pr<f;)Qt&&Qt[pr].run();pr=-1,f=bt.length}Qt=null,Jt=!1,function(n){if(St===clearTimeout)return clearTimeout(n);if((St===vn||!St)&&clearTimeout)return St=clearTimeout,clearTimeout(n);try{St(n)}catch{try{return St.call(null,n)}catch{return St.call(this||Yt,n)}}}(s)}}function ro(s,f){(this||Yt).fun=s,(this||Yt).array=f}function wt(){}var io,Et,St,Yt,ze,Qt,bt,Jt,pr,He,El=nt(()=>{ue(),ce(),he(),Yt=typeof globalThis<"u"?globalThis:typeof self<"u"?self:global,ze=io={},function(){try{Et=typeof setTimeout=="function"?setTimeout:_n}catch{Et=_n}try{St=typeof clearTimeout=="function"?clearTimeout:vn}catch{St=vn}}(),bt=[],Jt=!1,pr=-1,ze.nextTick=function(s){var f=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)f[n-1]=arguments[n];bt.push(new ro(s,f)),bt.length!==1||Jt||ms(bs)},ro.prototype.run=function(){(this||Yt).fun.apply(null,(this||Yt).array)},ze.title="browser",ze.browser=!0,ze.env={},ze.argv=[],ze.version="",ze.versions={},ze.on=wt,ze.addListener=wt,ze.once=wt,ze.off=wt,ze.removeListener=wt,ze.removeAllListeners=wt,ze.emit=wt,ze.prependListener=wt,ze.prependOnceListener=wt,ze.listeners=function(s){return[]},ze.binding=function(s){throw new Error("process.binding is not supported")},ze.cwd=function(){return"/"},ze.chdir=function(s){throw new Error("process.chdir is not supported")},ze.umask=function(){return 0},He=io,He.addListener,He.argv,He.binding,He.browser,He.chdir,He.cwd,He.emit,He.env,He.listeners,He.nextTick,He.off,He.on,He.once,He.prependListener,He.prependOnceListener,He.removeAllListeners,He.removeListener,He.title,He.umask,He.version,He.versions});function Sl(){if(En)return Mr;En=!0;var s=Mr={},f,n;function a(){throw new Error("setTimeout has not been defined")}function c(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?f=setTimeout:f=a}catch{f=a}try{typeof clearTimeout=="function"?n=clearTimeout:n=c}catch{n=c}})();function r(_){if(f===setTimeout)return setTimeout(_,0);if((f===a||!f)&&setTimeout)return f=setTimeout,setTimeout(_,0);try{return f(_,0)}catch{try{return f.call(null,_,0)}catch{return f.call(this||Vt,_,0)}}}function e(_){if(n===clearTimeout)return clearTimeout(_);if((n===c||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(_);try{return n(_)}catch{try{return n.call(null,_)}catch{return n.call(this||Vt,_)}}}var i=[],t=!1,o,u=-1;function d(){!t||!o||(t=!1,o.length?i=o.concat(i):u=-1,i.length&&p())}function p(){if(!t){var _=r(d);t=!0;for(var E=i.length;E;){for(o=i,i=[];++u<E;)o&&o[u].run();u=-1,E=i.length}o=null,t=!1,e(_)}}s.nextTick=function(_){var E=new Array(arguments.length-1);if(arguments.length>1)for(var I=1;I<arguments.length;I++)E[I-1]=arguments[I];i.push(new m(_,E)),i.length===1&&!t&&r(p)};function m(_,E){(this||Vt).fun=_,(this||Vt).array=E}m.prototype.run=function(){(this||Vt).fun.apply(null,(this||Vt).array)},s.title="browser",s.browser=!0,s.env={},s.argv=[],s.version="",s.versions={};function b(){}return s.on=b,s.addListener=b,s.once=b,s.off=b,s.removeListener=b,s.removeAllListeners=b,s.emit=b,s.prependListener=b,s.prependOnceListener=b,s.listeners=function(_){return[]},s.binding=function(_){throw new Error("process.binding is not supported")},s.cwd=function(){return"/"},s.chdir=function(_){throw new Error("process.chdir is not supported")},s.umask=function(){return 0},Mr}var Mr,En,Vt,$e,ys=nt(()=>{ue(),ce(),he(),Mr={},En=!1,Vt=typeof globalThis<"u"?globalThis:typeof self<"u"?self:global,$e=Sl(),$e.platform="browser",$e.addListener,$e.argv,$e.binding,$e.browser,$e.chdir,$e.cwd,$e.emit,$e.env,$e.listeners,$e.nextTick,$e.off,$e.on,$e.once,$e.prependListener,$e.prependOnceListener,$e.removeAllListeners,$e.removeListener,$e.title,$e.umask,$e.version,$e.versions});function Al(){if(Sn)return xr;Sn=!0;var s=$e;function f(r){if(typeof r!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(r))}function n(r,e){for(var i="",t=0,o=-1,u=0,d,p=0;p<=r.length;++p){if(p<r.length)d=r.charCodeAt(p);else{if(d===47)break;d=47}if(d===47){if(!(o===p-1||u===1))if(o!==p-1&&u===2){if(i.length<2||t!==2||i.charCodeAt(i.length-1)!==46||i.charCodeAt(i.length-2)!==46){if(i.length>2){var m=i.lastIndexOf("/");if(m!==i.length-1){m===-1?(i="",t=0):(i=i.slice(0,m),t=i.length-1-i.lastIndexOf("/")),o=p,u=0;continue}}else if(i.length===2||i.length===1){i="",t=0,o=p,u=0;continue}}e&&(i.length>0?i+="/..":i="..",t=2)}else i.length>0?i+="/"+r.slice(o+1,p):i=r.slice(o+1,p),t=p-o-1;o=p,u=0}else d===46&&u!==-1?++u:u=-1}return i}function a(r,e){var i=e.dir||e.root,t=e.base||(e.name||"")+(e.ext||"");return i?i===e.root?i+t:i+r+t:t}var c={resolve:function(){for(var r="",e=!1,i,t=arguments.length-1;t>=-1&&!e;t--){var o;t>=0?o=arguments[t]:(i===void 0&&(i=s.cwd()),o=i),f(o),o.length!==0&&(r=o+"/"+r,e=o.charCodeAt(0)===47)}return r=n(r,!e),e?r.length>0?"/"+r:"/":r.length>0?r:"."},normalize:function(r){if(f(r),r.length===0)return".";var e=r.charCodeAt(0)===47,i=r.charCodeAt(r.length-1)===47;return r=n(r,!e),r.length===0&&!e&&(r="."),r.length>0&&i&&(r+="/"),e?"/"+r:r},isAbsolute:function(r){return f(r),r.length>0&&r.charCodeAt(0)===47},join:function(){if(arguments.length===0)return".";for(var r,e=0;e<arguments.length;++e){var i=arguments[e];f(i),i.length>0&&(r===void 0?r=i:r+="/"+i)}return r===void 0?".":c.normalize(r)},relative:function(r,e){if(f(r),f(e),r===e||(r=c.resolve(r),e=c.resolve(e),r===e))return"";for(var i=1;i<r.length&&r.charCodeAt(i)===47;++i);for(var t=r.length,o=t-i,u=1;u<e.length&&e.charCodeAt(u)===47;++u);for(var d=e.length,p=d-u,m=o<p?o:p,b=-1,_=0;_<=m;++_){if(_===m){if(p>m){if(e.charCodeAt(u+_)===47)return e.slice(u+_+1);if(_===0)return e.slice(u+_)}else o>m&&(r.charCodeAt(i+_)===47?b=_:_===0&&(b=0));break}var E=r.charCodeAt(i+_),I=e.charCodeAt(u+_);if(E!==I)break;E===47&&(b=_)}var y="";for(_=i+b+1;_<=t;++_)(_===t||r.charCodeAt(_)===47)&&(y.length===0?y+="..":y+="/..");return y.length>0?y+e.slice(u+b):(u+=b,e.charCodeAt(u)===47&&++u,e.slice(u))},_makeLong:function(r){return r},dirname:function(r){if(f(r),r.length===0)return".";for(var e=r.charCodeAt(0),i=e===47,t=-1,o=!0,u=r.length-1;u>=1;--u)if(e=r.charCodeAt(u),e===47){if(!o){t=u;break}}else o=!1;return t===-1?i?"/":".":i&&t===1?"//":r.slice(0,t)},basename:function(r,e){if(e!==void 0&&typeof e!="string")throw new TypeError('"ext" argument must be a string');f(r);var i=0,t=-1,o=!0,u;if(e!==void 0&&e.length>0&&e.length<=r.length){if(e.length===r.length&&e===r)return"";var d=e.length-1,p=-1;for(u=r.length-1;u>=0;--u){var m=r.charCodeAt(u);if(m===47){if(!o){i=u+1;break}}else p===-1&&(o=!1,p=u+1),d>=0&&(m===e.charCodeAt(d)?--d===-1&&(t=u):(d=-1,t=p))}return i===t?t=p:t===-1&&(t=r.length),r.slice(i,t)}else{for(u=r.length-1;u>=0;--u)if(r.charCodeAt(u)===47){if(!o){i=u+1;break}}else t===-1&&(o=!1,t=u+1);return t===-1?"":r.slice(i,t)}},extname:function(r){f(r);for(var e=-1,i=0,t=-1,o=!0,u=0,d=r.length-1;d>=0;--d){var p=r.charCodeAt(d);if(p===47){if(!o){i=d+1;break}continue}t===-1&&(o=!1,t=d+1),p===46?e===-1?e=d:u!==1&&(u=1):e!==-1&&(u=-1)}return e===-1||t===-1||u===0||u===1&&e===t-1&&e===i+1?"":r.slice(e,t)},format:function(r){if(r===null||typeof r!="object")throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof r);return a("/",r)},parse:function(r){f(r);var e={root:"",dir:"",base:"",ext:"",name:""};if(r.length===0)return e;var i=r.charCodeAt(0),t=i===47,o;t?(e.root="/",o=1):o=0;for(var u=-1,d=0,p=-1,m=!0,b=r.length-1,_=0;b>=o;--b){if(i=r.charCodeAt(b),i===47){if(!m){d=b+1;break}continue}p===-1&&(m=!1,p=b+1),i===46?u===-1?u=b:_!==1&&(_=1):u!==-1&&(_=-1)}return u===-1||p===-1||_===0||_===1&&u===p-1&&u===d+1?p!==-1&&(d===0&&t?e.base=e.name=r.slice(1,p):e.base=e.name=r.slice(d,p)):(d===0&&t?(e.name=r.slice(1,u),e.base=r.slice(1,p)):(e.name=r.slice(d,u),e.base=r.slice(d,p)),e.ext=r.slice(u,p)),d>0?e.dir=r.slice(0,d-1):t&&(e.dir="/"),e},sep:"/",delimiter:":",win32:null,posix:null};return c.posix=c,xr=c,xr}var xr,Sn,An,Il=nt(()=>{ue(),ce(),he(),ys(),xr={},Sn=!1,An=Al()}),ws={};nr(ws,{URL:()=>js,Url:()=>Ms,default:()=>Ue,fileURLToPath:()=>_s,format:()=>xs,parse:()=>Us,pathToFileURL:()=>vs,resolve:()=>Bs,resolveObject:()=>Ls});function ct(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}function lr(s,f,n){if(s&&dt.isObject(s)&&s instanceof ct)return s;var a=new ct;return a.parse(s,f,n),a}function kl(){if(In)return Br;In=!0;var s=He;function f(r){if(typeof r!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(r))}function n(r,e){for(var i="",t=0,o=-1,u=0,d,p=0;p<=r.length;++p){if(p<r.length)d=r.charCodeAt(p);else{if(d===47)break;d=47}if(d===47){if(!(o===p-1||u===1))if(o!==p-1&&u===2){if(i.length<2||t!==2||i.charCodeAt(i.length-1)!==46||i.charCodeAt(i.length-2)!==46){if(i.length>2){var m=i.lastIndexOf("/");if(m!==i.length-1){m===-1?(i="",t=0):(i=i.slice(0,m),t=i.length-1-i.lastIndexOf("/")),o=p,u=0;continue}}else if(i.length===2||i.length===1){i="",t=0,o=p,u=0;continue}}e&&(i.length>0?i+="/..":i="..",t=2)}else i.length>0?i+="/"+r.slice(o+1,p):i=r.slice(o+1,p),t=p-o-1;o=p,u=0}else d===46&&u!==-1?++u:u=-1}return i}function a(r,e){var i=e.dir||e.root,t=e.base||(e.name||"")+(e.ext||"");return i?i===e.root?i+t:i+r+t:t}var c={resolve:function(){for(var r="",e=!1,i,t=arguments.length-1;t>=-1&&!e;t--){var o;t>=0?o=arguments[t]:(i===void 0&&(i=s.cwd()),o=i),f(o),o.length!==0&&(r=o+"/"+r,e=o.charCodeAt(0)===47)}return r=n(r,!e),e?r.length>0?"/"+r:"/":r.length>0?r:"."},normalize:function(r){if(f(r),r.length===0)return".";var e=r.charCodeAt(0)===47,i=r.charCodeAt(r.length-1)===47;return r=n(r,!e),r.length===0&&!e&&(r="."),r.length>0&&i&&(r+="/"),e?"/"+r:r},isAbsolute:function(r){return f(r),r.length>0&&r.charCodeAt(0)===47},join:function(){if(arguments.length===0)return".";for(var r,e=0;e<arguments.length;++e){var i=arguments[e];f(i),i.length>0&&(r===void 0?r=i:r+="/"+i)}return r===void 0?".":c.normalize(r)},relative:function(r,e){if(f(r),f(e),r===e||(r=c.resolve(r),e=c.resolve(e),r===e))return"";for(var i=1;i<r.length&&r.charCodeAt(i)===47;++i);for(var t=r.length,o=t-i,u=1;u<e.length&&e.charCodeAt(u)===47;++u);for(var d=e.length,p=d-u,m=o<p?o:p,b=-1,_=0;_<=m;++_){if(_===m){if(p>m){if(e.charCodeAt(u+_)===47)return e.slice(u+_+1);if(_===0)return e.slice(u+_)}else o>m&&(r.charCodeAt(i+_)===47?b=_:_===0&&(b=0));break}var E=r.charCodeAt(i+_),I=e.charCodeAt(u+_);if(E!==I)break;E===47&&(b=_)}var y="";for(_=i+b+1;_<=t;++_)(_===t||r.charCodeAt(_)===47)&&(y.length===0?y+="..":y+="/..");return y.length>0?y+e.slice(u+b):(u+=b,e.charCodeAt(u)===47&&++u,e.slice(u))},_makeLong:function(r){return r},dirname:function(r){if(f(r),r.length===0)return".";for(var e=r.charCodeAt(0),i=e===47,t=-1,o=!0,u=r.length-1;u>=1;--u)if(e=r.charCodeAt(u),e===47){if(!o){t=u;break}}else o=!1;return t===-1?i?"/":".":i&&t===1?"//":r.slice(0,t)},basename:function(r,e){if(e!==void 0&&typeof e!="string")throw new TypeError('"ext" argument must be a string');f(r);var i=0,t=-1,o=!0,u;if(e!==void 0&&e.length>0&&e.length<=r.length){if(e.length===r.length&&e===r)return"";var d=e.length-1,p=-1;for(u=r.length-1;u>=0;--u){var m=r.charCodeAt(u);if(m===47){if(!o){i=u+1;break}}else p===-1&&(o=!1,p=u+1),d>=0&&(m===e.charCodeAt(d)?--d===-1&&(t=u):(d=-1,t=p))}return i===t?t=p:t===-1&&(t=r.length),r.slice(i,t)}else{for(u=r.length-1;u>=0;--u)if(r.charCodeAt(u)===47){if(!o){i=u+1;break}}else t===-1&&(o=!1,t=u+1);return t===-1?"":r.slice(i,t)}},extname:function(r){f(r);for(var e=-1,i=0,t=-1,o=!0,u=0,d=r.length-1;d>=0;--d){var p=r.charCodeAt(d);if(p===47){if(!o){i=d+1;break}continue}t===-1&&(o=!1,t=d+1),p===46?e===-1?e=d:u!==1&&(u=1):e!==-1&&(u=-1)}return e===-1||t===-1||u===0||u===1&&e===t-1&&e===i+1?"":r.slice(e,t)},format:function(r){if(r===null||typeof r!="object")throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof r);return a("/",r)},parse:function(r){f(r);var e={root:"",dir:"",base:"",ext:"",name:""};if(r.length===0)return e;var i=r.charCodeAt(0),t=i===47,o;t?(e.root="/",o=1):o=0;for(var u=-1,d=0,p=-1,m=!0,b=r.length-1,_=0;b>=o;--b){if(i=r.charCodeAt(b),i===47){if(!m){d=b+1;break}continue}p===-1&&(m=!1,p=b+1),i===46?u===-1?u=b:_!==1&&(_=1):u!==-1&&(_=-1)}return u===-1||p===-1||_===0||_===1&&u===p-1&&u===d+1?p!==-1&&(d===0&&t?e.base=e.name=r.slice(1,p):e.base=e.name=r.slice(d,p)):(d===0&&t?(e.name=r.slice(1,u),e.base=r.slice(1,p)):(e.name=r.slice(d,u),e.base=r.slice(d,p)),e.ext=r.slice(u,p)),d>0?e.dir=r.slice(0,d-1):t&&(e.dir="/"),e},sep:"/",delimiter:":",win32:null,posix:null};return c.posix=c,Br=c,Br}function Tl(s){if(typeof s=="string")s=new URL(s);else if(!(s instanceof URL))throw new Deno.errors.InvalidData("invalid argument path , must be a string or URL");if(s.protocol!=="file:")throw new Deno.errors.InvalidData("invalid url scheme");return jr?Ol(s):Rl(s)}function Ol(s){let f=s.hostname,n=s.pathname;for(let a=0;a<n.length;a++)if(n[a]==="%"){let c=n.codePointAt(a+2)||32;if(n[a+1]==="2"&&c===102||n[a+1]==="5"&&c===99)throw new Deno.errors.InvalidData("must not include encoded \\ or / characters")}if(n=n.replace(ks,"\\"),n=decodeURIComponent(n),f!=="")return`\\\\${f}${n}`;{let a=n.codePointAt(1)|32,c=n[2];if(a<As||a>Is||c!==":")throw new Deno.errors.InvalidData("file url path must be absolute");return n.slice(1)}}function Rl(s){if(s.hostname!=="")throw new Deno.errors.InvalidData("invalid file url hostname");let f=s.pathname;for(let n=0;n<f.length;n++)if(f[n]==="%"){let a=f.codePointAt(n+2)||32;if(f[n+1]==="2"&&a===102)throw new Deno.errors.InvalidData("must not include encoded / characters")}return decodeURIComponent(f)}function Pl(s){let f=kn.resolve(s),n=s.charCodeAt(s.length-1);(n===Ss||jr&&n===Es)&&f[f.length-1]!==kn.sep&&(f+="/");let a=new URL("file://");return f.includes("%")&&(f=f.replace(Ts,"%25")),!jr&&f.includes("\\")&&(f=f.replace(Os,"%5C")),f.includes(`
`)&&(f=f.replace(Rs,"%0A")),f.includes("\r")&&(f=f.replace(Ps,"%0D")),f.includes("	")&&(f=f.replace(Cs,"%09")),a.pathname=f,a}function _s(s){if(typeof s=="string")s=new URL(s);else if(!(s instanceof URL))throw new Deno.errors.InvalidData("invalid argument path , must be a string or URL");if(s.protocol!=="file:")throw new Deno.errors.InvalidData("invalid url scheme");return Nr?Cl(s):Ml(s)}function Cl(s){let f=s.hostname,n=s.pathname;for(let a=0;a<n.length;a++)if(n[a]==="%"){let c=n.codePointAt(a+2)||32;if(n[a+1]==="2"&&c===102||n[a+1]==="5"&&c===99)throw new Deno.errors.InvalidData("must not include encoded \\ or / characters")}if(n=n.replace($s,"\\"),n=decodeURIComponent(n),f!=="")return`\\\\${f}${n}`;{let a=n.codePointAt(1)|32,c=n[2];if(a<Fs||a>Ws||c!==":")throw new Deno.errors.InvalidData("file url path must be absolute");return n.slice(1)}}function Ml(s){if(s.hostname!=="")throw new Deno.errors.InvalidData("invalid file url hostname");let f=s.pathname;for(let n=0;n<f.length;n++)if(f[n]==="%"){let a=f.codePointAt(n+2)||32;if(f[n+1]==="2"&&a===102)throw new Deno.errors.InvalidData("must not include encoded / characters")}return decodeURIComponent(f)}function vs(s){let f=An.resolve(s),n=s.charCodeAt(s.length-1);(n===Ds||Nr&&n===Ns)&&f[f.length-1]!==An.sep&&(f+="/");let a=new URL("file://");return f.includes("%")&&(f=f.replace(qs,"%25")),!Nr&&f.includes("\\")&&(f=f.replace(Hs,"%5C")),f.includes(`
`)&&(f=f.replace(Vs,"%0A")),f.includes("\r")&&(f=f.replace(zs,"%0D")),f.includes("	")&&(f=f.replace(Gs,"%09")),a.pathname=f,a}var Ue,no,dt,oo,so,ao,lo,Sr,ii,ni,oi,uo,ho,Ar,Ht,Ir,Br,In,kn,co,Es,Ss,As,Is,jr,ks,Ts,Os,Rs,Ps,Cs,fo,Ms,xs,Bs,Ls,Us,js,Ns,Ds,Fs,Ws,Nr,$s,qs,Hs,Vs,zs,Gs,xl=nt(()=>{ue(),ce(),he(),yl(),_l(),El(),Il(),ys(),Ue={},no=Ut,dt={isString:function(s){return typeof s=="string"},isObject:function(s){return typeof s=="object"&&s!==null},isNull:function(s){return s===null},isNullOrUndefined:function(s){return s==null}},Ue.parse=lr,Ue.resolve=function(s,f){return lr(s,!1,!0).resolve(f)},Ue.resolveObject=function(s,f){return s?lr(s,!1,!0).resolveObject(f):f},Ue.format=function(s){return dt.isString(s)&&(s=lr(s)),s instanceof ct?s.format():ct.prototype.format.call(s)},Ue.Url=ct,oo=/^([a-z0-9.+-]+:)/i,so=/:[0-9]*$/,ao=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,lo=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r",`
`,"	"]),Sr=["'"].concat(lo),ii=["%","/","?",";","#"].concat(Sr),ni=["/","?","#"],oi=/^[+a-z0-9A-Z_-]{0,63}$/,uo=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,ho={javascript:!0,"javascript:":!0},Ar={javascript:!0,"javascript:":!0},Ht={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},Ir=gt,ct.prototype.parse=function(s,f,n){if(!dt.isString(s))throw new TypeError("Parameter 'url' must be a string, not "+typeof s);var a=s.indexOf("?"),c=a!==-1&&a<s.indexOf("#")?"?":"#",r=s.split(c);r[0]=r[0].replace(/\\/g,"/");var e=s=r.join(c);if(e=e.trim(),!n&&s.split("#").length===1){var i=ao.exec(e);if(i)return this.path=e,this.href=e,this.pathname=i[1],i[2]?(this.search=i[2],this.query=f?Ir.parse(this.search.substr(1)):this.search.substr(1)):f&&(this.search="",this.query={}),this}var t=oo.exec(e);if(t){var o=(t=t[0]).toLowerCase();this.protocol=o,e=e.substr(t.length)}if(n||t||e.match(/^\/\/[^@\/]+@[^@\/]+/)){var u=e.substr(0,2)==="//";!u||t&&Ar[t]||(e=e.substr(2),this.slashes=!0)}if(!Ar[t]&&(u||t&&!Ht[t])){for(var d,p,m=-1,b=0;b<ni.length;b++)(_=e.indexOf(ni[b]))!==-1&&(m===-1||_<m)&&(m=_);for((p=m===-1?e.lastIndexOf("@"):e.lastIndexOf("@",m))!==-1&&(d=e.slice(0,p),e=e.slice(p+1),this.auth=decodeURIComponent(d)),m=-1,b=0;b<ii.length;b++){var _;(_=e.indexOf(ii[b]))!==-1&&(m===-1||_<m)&&(m=_)}m===-1&&(m=e.length),this.host=e.slice(0,m),e=e.slice(m),this.parseHost(),this.hostname=this.hostname||"";var E=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!E)for(var I=this.hostname.split(/\./),y=(b=0,I.length);b<y;b++){var v=I[b];if(v&&!v.match(oi)){for(var j="",x=0,A=v.length;x<A;x++)v.charCodeAt(x)>127?j+="x":j+=v[x];if(!j.match(oi)){var T=I.slice(0,b),B=I.slice(b+1),Y=v.match(uo);Y&&(T.push(Y[1]),B.unshift(Y[2])),B.length&&(e="/"+B.join(".")+e),this.hostname=T.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),E||(this.hostname=no.toASCII(this.hostname));var X=this.port?":"+this.port:"",ae=this.hostname||"";this.host=ae+X,this.href+=this.host,E&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),e[0]!=="/"&&(e="/"+e))}if(!ho[o])for(b=0,y=Sr.length;b<y;b++){var P=Sr[b];if(e.indexOf(P)!==-1){var Q=encodeURIComponent(P);Q===P&&(Q=escape(P)),e=e.split(P).join(Q)}}var J=e.indexOf("#");J!==-1&&(this.hash=e.substr(J),e=e.slice(0,J));var W=e.indexOf("?");if(W!==-1?(this.search=e.substr(W),this.query=e.substr(W+1),f&&(this.query=Ir.parse(this.query)),e=e.slice(0,W)):f&&(this.search="",this.query={}),e&&(this.pathname=e),Ht[o]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){X=this.pathname||"";var me=this.search||"";this.path=X+me}return this.href=this.format(),this},ct.prototype.format=function(){var s=this.auth||"";s&&(s=(s=encodeURIComponent(s)).replace(/%3A/i,":"),s+="@");var f=this.protocol||"",n=this.pathname||"",a=this.hash||"",c=!1,r="";this.host?c=s+this.host:this.hostname&&(c=s+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]"),this.port&&(c+=":"+this.port)),this.query&&dt.isObject(this.query)&&Object.keys(this.query).length&&(r=Ir.stringify(this.query));var e=this.search||r&&"?"+r||"";return f&&f.substr(-1)!==":"&&(f+=":"),this.slashes||(!f||Ht[f])&&c!==!1?(c="//"+(c||""),n&&n.charAt(0)!=="/"&&(n="/"+n)):c||(c=""),a&&a.charAt(0)!=="#"&&(a="#"+a),e&&e.charAt(0)!=="?"&&(e="?"+e),f+c+(n=n.replace(/[?#]/g,function(i){return encodeURIComponent(i)}))+(e=e.replace("#","%23"))+a},ct.prototype.resolve=function(s){return this.resolveObject(lr(s,!1,!0)).format()},ct.prototype.resolveObject=function(s){if(dt.isString(s)){var f=new ct;f.parse(s,!1,!0),s=f}for(var n=new ct,a=Object.keys(this),c=0;c<a.length;c++){var r=a[c];n[r]=this[r]}if(n.hash=s.hash,s.href==="")return n.href=n.format(),n;if(s.slashes&&!s.protocol){for(var e=Object.keys(s),i=0;i<e.length;i++){var t=e[i];t!=="protocol"&&(n[t]=s[t])}return Ht[n.protocol]&&n.hostname&&!n.pathname&&(n.path=n.pathname="/"),n.href=n.format(),n}if(s.protocol&&s.protocol!==n.protocol){if(!Ht[s.protocol]){for(var o=Object.keys(s),u=0;u<o.length;u++){var d=o[u];n[d]=s[d]}return n.href=n.format(),n}if(n.protocol=s.protocol,s.host||Ar[s.protocol])n.pathname=s.pathname;else{for(var p=(s.pathname||"").split("/");p.length&&!(s.host=p.shift()););s.host||(s.host=""),s.hostname||(s.hostname=""),p[0]!==""&&p.unshift(""),p.length<2&&p.unshift(""),n.pathname=p.join("/")}if(n.search=s.search,n.query=s.query,n.host=s.host||"",n.auth=s.auth,n.hostname=s.hostname||s.host,n.port=s.port,n.pathname||n.search){var m=n.pathname||"",b=n.search||"";n.path=m+b}return n.slashes=n.slashes||s.slashes,n.href=n.format(),n}var _=n.pathname&&n.pathname.charAt(0)==="/",E=s.host||s.pathname&&s.pathname.charAt(0)==="/",I=E||_||n.host&&s.pathname,y=I,v=n.pathname&&n.pathname.split("/")||[],j=(p=s.pathname&&s.pathname.split("/")||[],n.protocol&&!Ht[n.protocol]);if(j&&(n.hostname="",n.port=null,n.host&&(v[0]===""?v[0]=n.host:v.unshift(n.host)),n.host="",s.protocol&&(s.hostname=null,s.port=null,s.host&&(p[0]===""?p[0]=s.host:p.unshift(s.host)),s.host=null),I=I&&(p[0]===""||v[0]==="")),E)n.host=s.host||s.host===""?s.host:n.host,n.hostname=s.hostname||s.hostname===""?s.hostname:n.hostname,n.search=s.search,n.query=s.query,v=p;else if(p.length)v||(v=[]),v.pop(),v=v.concat(p),n.search=s.search,n.query=s.query;else if(!dt.isNullOrUndefined(s.search))return j&&(n.hostname=n.host=v.shift(),(Y=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@"))&&(n.auth=Y.shift(),n.host=n.hostname=Y.shift())),n.search=s.search,n.query=s.query,dt.isNull(n.pathname)&&dt.isNull(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.href=n.format(),n;if(!v.length)return n.pathname=null,n.search?n.path="/"+n.search:n.path=null,n.href=n.format(),n;for(var x=v.slice(-1)[0],A=(n.host||s.host||v.length>1)&&(x==="."||x==="..")||x==="",T=0,B=v.length;B>=0;B--)(x=v[B])==="."?v.splice(B,1):x===".."?(v.splice(B,1),T++):T&&(v.splice(B,1),T--);if(!I&&!y)for(;T--;T)v.unshift("..");!I||v[0]===""||v[0]&&v[0].charAt(0)==="/"||v.unshift(""),A&&v.join("/").substr(-1)!=="/"&&v.push("");var Y,X=v[0]===""||v[0]&&v[0].charAt(0)==="/";return j&&(n.hostname=n.host=X?"":v.length?v.shift():"",(Y=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@"))&&(n.auth=Y.shift(),n.host=n.hostname=Y.shift())),(I=I||n.host&&v.length)&&!X&&v.unshift(""),v.length?n.pathname=v.join("/"):(n.pathname=null,n.path=null),dt.isNull(n.pathname)&&dt.isNull(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.auth=s.auth||n.auth,n.slashes=n.slashes||s.slashes,n.href=n.format(),n},ct.prototype.parseHost=function(){var s=this.host,f=so.exec(s);f&&((f=f[0])!==":"&&(this.port=f.substr(1)),s=s.substr(0,s.length-f.length)),s&&(this.hostname=s)},Ue.Url,Ue.format,Ue.resolve,Ue.resolveObject,Br={},In=!1,kn=kl(),co=typeof Deno<"u"?Deno.build.os==="windows"?"win32":Deno.build.os:void 0,Ue.URL=typeof URL<"u"?URL:null,Ue.pathToFileURL=Pl,Ue.fileURLToPath=Tl,Ue.Url,Ue.format,Ue.resolve,Ue.resolveObject,Ue.URL,Es=92,Ss=47,As=97,Is=122,jr=co==="win32",ks=/\//g,Ts=/%/g,Os=/\\/g,Rs=/\n/g,Ps=/\r/g,Cs=/\t/g,fo=typeof Deno<"u"?Deno.build.os==="windows"?"win32":Deno.build.os:void 0,Ue.URL=typeof URL<"u"?URL:null,Ue.pathToFileURL=vs,Ue.fileURLToPath=_s,Ms=Ue.Url,xs=Ue.format,Bs=Ue.resolve,Ls=Ue.resolveObject,Us=Ue.parse,js=Ue.URL,Ns=92,Ds=47,Fs=97,Ws=122,Nr=fo==="win32",$s=/\//g,qs=/%/g,Hs=/\\/g,Vs=/\n/g,zs=/\r/g,Gs=/\t/g}),Bl=be((s,f)=>{ue(),ce(),he(),f.exports=function(){throw new Error("ws does not work in the browser. Browser clients must use the native WebSocket object")}}),Bn=be(s=>{ue(),ce(),he(),Object.defineProperty(s,"__esModule",{value:!0}),s.BufferedDuplex=void 0,s.writev=a;var f=er(),n=(Je(),Ne(Ye));function a(r,e){let i=new Array(r.length);for(let t=0;t<r.length;t++)typeof r[t].chunk=="string"?i[t]=n.Buffer.from(r[t].chunk,"utf8"):i[t]=r[t].chunk;this._write(n.Buffer.concat(i),"binary",e)}var c=class extends f.Duplex{constructor(r,e,i){super({objectMode:!0}),this.proxy=e,this.socket=i,this.writeQueue=[],r.objectMode||(this._writev=a.bind(this)),this.isSocketOpen=!1,this.proxy.on("data",t=>{!this.destroyed&&this.readable&&this.push(t)})}_read(r){this.proxy.read(r)}_write(r,e,i){this.isSocketOpen?this.writeToProxy(r,e,i):this.writeQueue.push({chunk:r,encoding:e,cb:i})}_final(r){this.writeQueue=[],this.proxy.end(r)}_destroy(r,e){this.writeQueue=[],this.proxy.destroy(),e(r)}socketReady(){this.emit("connect"),this.isSocketOpen=!0,this.processWriteQueue()}writeToProxy(r,e,i){this.proxy.write(r,e)===!1?this.proxy.once("drain",i):i()}processWriteQueue(){for(;this.writeQueue.length>0;){let{chunk:r,encoding:e,cb:i}=this.writeQueue.shift();this.writeToProxy(r,e,i)}}};s.BufferedDuplex=c}),kr=be(s=>{ue(),ce(),he();var f=s&&s.__importDefault||function(I){return I&&I.__esModule?I:{default:I}};Object.defineProperty(s,"__esModule",{value:!0}),s.streamBuilder=s.browserStreamBuilder=void 0;var n=(Je(),Ne(Ye)),a=f(Bl()),c=f(kt()),r=er(),e=f(qr()),i=Bn(),t=(0,c.default)("mqttjs:ws"),o=["rejectUnauthorized","ca","cert","key","pfx","passphrase"];function u(I,y){let v=`${I.protocol}://${I.hostname}:${I.port}${I.path}`;return typeof I.transformWsUrl=="function"&&(v=I.transformWsUrl(v,I,y)),v}function d(I){let y=I;return I.port||(I.protocol==="wss"?y.port=443:y.port=80),I.path||(y.path="/"),I.wsOptions||(y.wsOptions={}),!e.default&&!I.forceNativeWebSocket&&I.protocol==="wss"&&o.forEach(v=>{Object.prototype.hasOwnProperty.call(I,v)&&!Object.prototype.hasOwnProperty.call(I.wsOptions,v)&&(y.wsOptions[v]=I[v])}),y}function p(I){let y=d(I);if(y.hostname||(y.hostname=y.host),!y.hostname){if(typeof document>"u")throw new Error("Could not determine host. Specify host manually.");let v=new URL(document.URL);y.hostname=v.hostname,y.port||(y.port=Number(v.port))}return y.objectMode===void 0&&(y.objectMode=!(y.binary===!0||y.binary===void 0)),y}function m(I,y,v){t("createWebSocket"),t(`protocol: ${v.protocolId} ${v.protocolVersion}`);let j=v.protocolId==="MQIsdp"&&v.protocolVersion===3?"mqttv3.1":"mqtt";t(`creating new Websocket for url: ${y} and protocol: ${j}`);let x;return v.createWebsocket?x=v.createWebsocket(y,[j],v):x=new a.default(y,[j],v.wsOptions),x}function b(I,y){let v=y.protocolId==="MQIsdp"&&y.protocolVersion===3?"mqttv3.1":"mqtt",j=u(y,I),x;return y.createWebsocket?x=y.createWebsocket(j,[v],y):x=new WebSocket(j,[v]),x.binaryType="arraybuffer",x}var _=(I,y)=>{t("streamBuilder");let v=d(y);v.hostname=v.hostname||v.host||"localhost";let j=u(v,I),x=m(I,j,v),A=a.default.createWebSocketStream(x,v.wsOptions);return A.url=j,x.on("close",()=>{A.destroy()}),A};s.streamBuilder=_;var E=(I,y)=>{t("browserStreamBuilder");let v,j=p(y).browserBufferSize||1024*512,x=y.browserBufferTimeout||1e3,A=!y.objectMode,T=b(I,y),B=X(y,W,me);y.objectMode||(B._writev=i.writev.bind(B)),B.on("close",()=>{T.close()});let Y=typeof T.addEventListener<"u";T.readyState===T.OPEN?(v=B,v.socket=T):(v=new i.BufferedDuplex(y,B,T),Y?T.addEventListener("open",ae):T.onopen=ae),Y?(T.addEventListener("close",P),T.addEventListener("error",Q),T.addEventListener("message",J)):(T.onclose=P,T.onerror=Q,T.onmessage=J);function X(de,ge,_e){let G=new r.Transform({objectMode:de.objectMode});return G._write=ge,G._flush=_e,G}function ae(){t("WebSocket onOpen"),v instanceof i.BufferedDuplex&&v.socketReady()}function P(de){t("WebSocket onClose",de),v.end(),v.destroy()}function Q(de){t("WebSocket onError",de);let ge=new Error("WebSocket error");ge.event=de,v.destroy(ge)}async function J(de){if(!B||B.destroyed||!B.readable)return;let{data:ge}=de;ge instanceof ArrayBuffer?ge=n.Buffer.from(ge):ge instanceof Blob?ge=n.Buffer.from(await new Response(ge).arrayBuffer()):ge=n.Buffer.from(ge,"utf8"),B.push(ge)}function W(de,ge,_e){if(T.bufferedAmount>j){setTimeout(W,x,de,ge,_e);return}A&&typeof de=="string"&&(de=n.Buffer.from(de,"utf8"));try{T.send(de)}catch(G){return _e(G)}_e()}function me(de){T.close(),de()}return v};s.browserStreamBuilder=E}),Ln={};nr(Ln,{Server:()=>qe,Socket:()=>qe,Stream:()=>qe,_createServerHandle:()=>qe,_normalizeArgs:()=>qe,_setSimultaneousAccepts:()=>qe,connect:()=>qe,createConnection:()=>qe,createServer:()=>qe,default:()=>Qs,isIP:()=>qe,isIPv4:()=>qe,isIPv6:()=>qe});function qe(){throw new Error("Node.js net module is not supported by JSPM core outside of Node.js")}var Qs,Ks=nt(()=>{ue(),ce(),he(),Qs={_createServerHandle:qe,_normalizeArgs:qe,_setSimultaneousAccepts:qe,connect:qe,createConnection:qe,createServer:qe,isIP:qe,isIPv4:qe,isIPv6:qe,Server:qe,Socket:qe,Stream:qe}}),Ys=be((s,f)=>{ue(),ce(),he(),f.exports={}}),po=be(s=>{ue(),ce(),he();var f=s&&s.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(s,"__esModule",{value:!0});var n=f((Ks(),Ne(Ln))),a=f(kt()),c=f(Ys()),r=(0,a.default)("mqttjs:tcp"),e=(i,t)=>{if(t.port=t.port||1883,t.hostname=t.hostname||t.host||"localhost",t.socksProxy)return(0,c.default)(t.hostname,t.port,t.socksProxy,{timeout:t.socksTimeout});let{port:o,path:u}=t,d=t.hostname;return r("port %d and host %s",o,d),n.default.createConnection({port:o,host:d,path:u})};s.default=e}),Js={};nr(Js,{default:()=>Xs});var Xs,Ll=nt(()=>{ue(),ce(),he(),Xs={}}),go=be(s=>{ue(),ce(),he();var f=s&&s.__rest||function(u,d){var p={};for(var m in u)Object.prototype.hasOwnProperty.call(u,m)&&d.indexOf(m)<0&&(p[m]=u[m]);if(u!=null&&typeof Object.getOwnPropertySymbols=="function")for(var b=0,m=Object.getOwnPropertySymbols(u);b<m.length;b++)d.indexOf(m[b])<0&&Object.prototype.propertyIsEnumerable.call(u,m[b])&&(p[m[b]]=u[m[b]]);return p},n=s&&s.__importDefault||function(u){return u&&u.__esModule?u:{default:u}};Object.defineProperty(s,"__esModule",{value:!0});var a=n((Ll(),Ne(Js))),c=n((Ks(),Ne(Ln))),r=n(kt()),e=n(Ys()),i=(0,r.default)("mqttjs:tls");function t(u){let{host:d,port:p,socksProxy:m}=u,b=f(u,["host","port","socksProxy"]);return a.default.connect(m?Object.assign(Object.assign({},b),{socket:(0,e.default)(d,p,m,{timeout:u.socksTimeout})}):u)}var o=(u,d)=>{d.port=d.port||8883,d.host=d.hostname||d.host||"localhost",c.default.isIP(d.host)===0&&(d.servername=d.host),d.rejectUnauthorized=d.rejectUnauthorized!==!1,delete d.path,i("port %d host %s rejectUnauthorized %b",d.port,d.host,d.rejectUnauthorized);let p=t(d);p.on("secureConnect",()=>{d.rejectUnauthorized&&!p.authorized?p.emit("error",new Error("TLS not authorized")):p.removeListener("error",m)});function m(b){d.rejectUnauthorized&&u.emit("error",b),p.end()}return p.on("error",m),p};s.default=o}),mo=be(s=>{ue(),ce(),he(),Object.defineProperty(s,"__esModule",{value:!0});var f=(Je(),Ne(Ye)),n=er(),a=Bn(),c,r,e;function i(){let p=new n.Transform;return p._write=(m,b,_)=>{c.send({data:m.buffer,success(){_()},fail(E){_(new Error(E))}})},p._flush=m=>{c.close({success(){m()}})},p}function t(p){p.hostname||(p.hostname="localhost"),p.path||(p.path="/"),p.wsOptions||(p.wsOptions={})}function o(p,m){let b=p.protocol==="wxs"?"wss":"ws",_=`${b}://${p.hostname}${p.path}`;return p.port&&p.port!==80&&p.port!==443&&(_=`${b}://${p.hostname}:${p.port}${p.path}`),typeof p.transformWsUrl=="function"&&(_=p.transformWsUrl(_,p,m)),_}function u(){c.onOpen(()=>{e.socketReady()}),c.onMessage(p=>{let{data:m}=p;m instanceof ArrayBuffer?m=f.Buffer.from(m):m=f.Buffer.from(m,"utf8"),r.push(m)}),c.onClose(()=>{e.emit("close"),e.end(),e.destroy()}),c.onError(p=>{let m=new Error(p.errMsg);e.destroy(m)})}var d=(p,m)=>{if(m.hostname=m.hostname||m.host,!m.hostname)throw new Error("Could not determine host. Specify host manually.");let b=m.protocolId==="MQIsdp"&&m.protocolVersion===3?"mqttv3.1":"mqtt";t(m);let _=o(m,p);c=wx.connectSocket({url:_,protocols:[b]}),r=i(),e=new a.BufferedDuplex(m,r,c),e._destroy=(I,y)=>{c.close({success(){y&&y(I)}})};let E=e.destroy;return e.destroy=(I,y)=>(e.destroy=E,setTimeout(()=>{c.close({fail(){e._destroy(I,y)}})},0),e),u(),e};s.default=d}),bo=be(s=>{ue(),ce(),he(),Object.defineProperty(s,"__esModule",{value:!0});var f=(Je(),Ne(Ye)),n=er(),a=Bn(),c,r,e,i=!1;function t(){let m=new n.Transform;return m._write=(b,_,E)=>{c.sendSocketMessage({data:b.buffer,success(){E()},fail(){E(new Error)}})},m._flush=b=>{c.closeSocket({success(){b()}})},m}function o(m){m.hostname||(m.hostname="localhost"),m.path||(m.path="/"),m.wsOptions||(m.wsOptions={})}function u(m,b){let _=m.protocol==="alis"?"wss":"ws",E=`${_}://${m.hostname}${m.path}`;return m.port&&m.port!==80&&m.port!==443&&(E=`${_}://${m.hostname}:${m.port}${m.path}`),typeof m.transformWsUrl=="function"&&(E=m.transformWsUrl(E,m,b)),E}function d(){i||(i=!0,c.onSocketOpen(()=>{e.socketReady()}),c.onSocketMessage(m=>{if(typeof m.data=="string"){let b=f.Buffer.from(m.data,"base64");r.push(b)}else{let b=new FileReader;b.addEventListener("load",()=>{let _=b.result;_ instanceof ArrayBuffer?_=f.Buffer.from(_):_=f.Buffer.from(_,"utf8"),r.push(_)}),b.readAsArrayBuffer(m.data)}}),c.onSocketClose(()=>{e.end(),e.destroy()}),c.onSocketError(m=>{e.destroy(m)}))}var p=(m,b)=>{if(b.hostname=b.hostname||b.host,!b.hostname)throw new Error("Could not determine host. Specify host manually.");let _=b.protocolId==="MQIsdp"&&b.protocolVersion===3?"mqttv3.1":"mqtt";o(b);let E=u(b,m);return c=b.my,c.connectSocket({url:E,protocols:_}),r=t(),e=new a.BufferedDuplex(b,r,c),d(),e};s.default=p}),Ul=be(s=>{ue(),ce(),he();var f=s&&s.__importDefault||function(d){return d&&d.__esModule?d:{default:d}};Object.defineProperty(s,"__esModule",{value:!0}),s.connectAsync=u;var n=f(kt()),a=f((xl(),Ne(ws))),c=f(yn()),r=f(qr());typeof(Le==null?void 0:Le.nextTick)!="function"&&(Le.nextTick=setImmediate);var e=(0,n.default)("mqttjs"),i=null;function t(d){let p;d.auth&&(p=d.auth.match(/^(.+):(.+)$/),p?(d.username=p[1],d.password=p[2]):d.username=d.auth)}function o(d,p){var m,b,_;if(e("connecting to an MQTT broker..."),typeof d=="object"&&!p&&(p=d,d=""),p=p||{},d&&typeof d=="string"){let y=a.default.parse(d,!0),v={};if(y.port!=null&&(v.port=Number(y.port)),v.host=y.hostname,v.query=y.query,v.auth=y.auth,v.protocol=y.protocol,v.path=y.path,p=Object.assign(Object.assign({},v),p),!p.protocol)throw new Error("Missing protocol");p.protocol=p.protocol.replace(/:$/,"")}if(p.unixSocket=p.unixSocket||((m=p.protocol)===null||m===void 0?void 0:m.includes("+unix")),p.unixSocket?p.protocol=p.protocol.replace("+unix",""):!(!((b=p.protocol)===null||b===void 0)&&b.startsWith("ws"))&&!(!((_=p.protocol)===null||_===void 0)&&_.startsWith("wx"))&&delete p.path,t(p),p.query&&typeof p.query.clientId=="string"&&(p.clientId=p.query.clientId),r.default||p.unixSocket?p.socksProxy=void 0:p.socksProxy===void 0&&typeof Le<"u"&&(p.socksProxy=Le.env.MQTTJS_SOCKS_PROXY),p.cert&&p.key)if(p.protocol){if(["mqtts","wss","wxs","alis"].indexOf(p.protocol)===-1)switch(p.protocol){case"mqtt":p.protocol="mqtts";break;case"ws":p.protocol="wss";break;case"wx":p.protocol="wxs";break;case"ali":p.protocol="alis";break;default:throw new Error(`Unknown protocol for secure connection: "${p.protocol}"!`)}}else throw new Error("Missing secure protocol key");if(i||(i={},!r.default&&!p.forceNativeWebSocket?(i.ws=kr().streamBuilder,i.wss=kr().streamBuilder,i.mqtt=po().default,i.tcp=po().default,i.ssl=go().default,i.tls=i.ssl,i.mqtts=go().default):(i.ws=kr().browserStreamBuilder,i.wss=kr().browserStreamBuilder,i.wx=mo().default,i.wxs=mo().default,i.ali=bo().default,i.alis=bo().default)),!i[p.protocol]){let y=["mqtts","wss"].indexOf(p.protocol)!==-1;p.protocol=["mqtt","mqtts","ws","wss","wx","wxs","ali","alis"].filter((v,j)=>y&&j%2===0?!1:typeof i[v]=="function")[0]}if(p.clean===!1&&!p.clientId)throw new Error("Missing clientId for unclean clients");p.protocol&&(p.defaultProtocol=p.protocol);function E(y){return p.servers&&((!y._reconnectCount||y._reconnectCount===p.servers.length)&&(y._reconnectCount=0),p.host=p.servers[y._reconnectCount].host,p.port=p.servers[y._reconnectCount].port,p.protocol=p.servers[y._reconnectCount].protocol?p.servers[y._reconnectCount].protocol:p.defaultProtocol,p.hostname=p.host,y._reconnectCount++),e("calling streambuilder for",p.protocol),i[p.protocol](y,p)}let I=new c.default(E,p);return I.on("error",()=>{}),I}function u(d,p,m=!0){return new Promise((b,_)=>{let E=o(d,p),I={connect:v=>{y(),b(E)},end:()=>{y(),b(E)},error:v=>{y(),E.end(),_(v)}};m===!1&&(I.close=()=>{I.error(new Error("Couldn't connect to server"))});function y(){Object.keys(I).forEach(v=>{E.off(v,I[v])})}Object.keys(I).forEach(v=>{E.on(v,I[v])})})}s.default=o}),yo=be(s=>{ue(),ce(),he();var f=s&&s.__createBinding||(Object.create?function(m,b,_,E){E===void 0&&(E=_);var I=Object.getOwnPropertyDescriptor(b,_);(!I||("get"in I?!b.__esModule:I.writable||I.configurable))&&(I={enumerable:!0,get:function(){return b[_]}}),Object.defineProperty(m,E,I)}:function(m,b,_,E){E===void 0&&(E=_),m[E]=b[_]}),n=s&&s.__setModuleDefault||(Object.create?function(m,b){Object.defineProperty(m,"default",{enumerable:!0,value:b})}:function(m,b){m.default=b}),a=s&&s.__importStar||function(){var m=function(b){return m=Object.getOwnPropertyNames||function(_){var E=[];for(var I in _)Object.prototype.hasOwnProperty.call(_,I)&&(E[E.length]=I);return E},m(b)};return function(b){if(b&&b.__esModule)return b;var _={};if(b!=null)for(var E=m(b),I=0;I<E.length;I++)E[I]!=="default"&&f(_,b,E[I]);return n(_,b),_}}(),c=s&&s.__exportStar||function(m,b){for(var _ in m)_!=="default"&&!Object.prototype.hasOwnProperty.call(b,_)&&f(b,m,_)},r=s&&s.__importDefault||function(m){return m&&m.__esModule?m:{default:m}};Object.defineProperty(s,"__esModule",{value:!0}),s.ReasonCodes=s.KeepaliveManager=s.UniqueMessageIdProvider=s.DefaultMessageIdProvider=s.Store=s.MqttClient=s.connectAsync=s.connect=s.Client=void 0;var e=r(yn());s.MqttClient=e.default;var i=r(Ko());s.DefaultMessageIdProvider=i.default;var t=r(bl());s.UniqueMessageIdProvider=t.default;var o=r(Yo());s.Store=o.default;var u=a(Ul());s.connect=u.default,Object.defineProperty(s,"connectAsync",{enumerable:!0,get:function(){return u.connectAsync}});var d=r(ds());s.KeepaliveManager=d.default,s.Client=e.default,c(yn(),s),c(sr(),s);var p=$r();Object.defineProperty(s,"ReasonCodes",{enumerable:!0,get:function(){return p.ReasonCodes}})}),jl=be(s=>{ue(),ce(),he();var f=s&&s.__createBinding||(Object.create?function(e,i,t,o){o===void 0&&(o=t);var u=Object.getOwnPropertyDescriptor(i,t);(!u||("get"in u?!i.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return i[t]}}),Object.defineProperty(e,o,u)}:function(e,i,t,o){o===void 0&&(o=t),e[o]=i[t]}),n=s&&s.__setModuleDefault||(Object.create?function(e,i){Object.defineProperty(e,"default",{enumerable:!0,value:i})}:function(e,i){e.default=i}),a=s&&s.__importStar||function(){var e=function(i){return e=Object.getOwnPropertyNames||function(t){var o=[];for(var u in t)Object.prototype.hasOwnProperty.call(t,u)&&(o[o.length]=u);return o},e(i)};return function(i){if(i&&i.__esModule)return i;var t={};if(i!=null)for(var o=e(i),u=0;u<o.length;u++)o[u]!=="default"&&f(t,i,o[u]);return n(t,i),t}}(),c=s&&s.__exportStar||function(e,i){for(var t in e)t!=="default"&&!Object.prototype.hasOwnProperty.call(i,t)&&f(i,e,t)};Object.defineProperty(s,"__esModule",{value:!0});var r=a(yo());s.default=r,c(yo(),s)});const Nl=jl();/*! Bundled license information:

@jspm/core/nodelibs/browser/buffer.js:
  (*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> *)

safe-buffer/index.js:
  (*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> *)
*/const Dl="wss://"+it.mqttConfig.brokerUrl+":"+it.mqttConfig.brokerPort;class Fl extends ir{constructor(){super();Te(this,"_client");Te(this,"_subscriptions",{});Te(this,"_todoSubscriptions",[]);Te(this,"_isRunning",!1);this._client=Nl.connect(Dl),this._client.on("connect",()=>{this._isRunning=!0,this._logger.LogInfo("Connected to MQTT broker"),this._todoSubscriptions.forEach(n=>{this.subscribeToTopic(n)})})}onInit(){Qe.subscribe(tt.MQTT_SubscribeToTopic,this,n=>{if(typeof n.value=="string"){var a=n.value;if(this._subscriptions[a]&&this._logger.LogWarning(`Failed to subscribe to topic: ${a}; Subscription already exists.`),this._subscriptions[a]=!0,!this._isRunning){this._todoSubscriptions.push(a);return}this.subscribeToTopic(a)}})}subscribeToTopic(n){const a=it.mqttConfig.topicBase+n;this._logger.LogDebug(`Added MQTT subscription for topic: "${n}"`),this._client.subscribe(a,(c,r)=>{c?this._logger.StringifyObject(c).PrependText("Subscribe error: "):this._logger.StringifyObject(r).PrependText(`Subscribed to topic: ${a};`)})}}class Wl extends ua{constructor(n,a){super(a);Te(this,"_htmlRenderer");Te(this,"_mqttService");this.position=new mr(0,0),this._htmlRenderer=new pa(n),this._mqttService=new Fl}onInit(){it.mode==wr.Development?this._htmlRenderer.showHomeScreen(!0):this._htmlRenderer.showConstructionScreen(!0),setTimeout(()=>{Qe.emit(tt.ShowMobileOverlay,!1,!1),Qe.emit(tt.MQTT_SubscribeToTopic,!1,"openLobbies")},1)}drawBackground(n){}drawObjects(n){this.children.forEach(a=>{a.drawLayer!==Lr.HUD&&a.draw(n,0,0)})}drawForeground(n){this.children.forEach(a=>{a.drawLayer===Lr.HUD&&a.draw(n,0,0)})}}const yr=document.querySelector("#game-canvas");if(yr==null)throw Error("canvas is null");if(!(yr instanceof HTMLCanvasElement))throw Error("canvas is not canvastype");const zt=yr.getContext("2d");if(zt==null)throw Error("ctx is null");const gr=new Wl(document),$l=s=>{gr.stepEntry(s,gr)},ql=()=>{zt.clearRect(0,0,yr.width,yr.height),gr.drawBackground(zt),zt.save(),gr.drawObjects(zt),zt.restore(),gr.drawForeground(zt)},Hl=new aa($l,ql);Hl.start();
